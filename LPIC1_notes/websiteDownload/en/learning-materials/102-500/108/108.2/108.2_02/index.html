

<!DOCTYPE html>
<html lang="en-us">
<head>


  
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-WMC4KTP');</script>
  



  <meta charset="utf-8"/>
  <title>108.2 Lesson 2</title>

  <link rel="stylesheet" href="../../../../../../scss/styles.min.css">

  
  <link rel="apple-touch-icon" sizes="152x152" href="https://learning.lpi.org/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="https://learning.lpi.org/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="https://learning.lpi.org/favicon-16x16.png">
  <link rel="manifest" href="https://learning.lpi.org/site.webmanifest">
  <link rel="mask-icon" href="https://learning.lpi.org/safari-pinned-tab.svg" color="#fbc000">
  <meta name="msapplication-TileColor" content="#ffc40d">
  <meta name="theme-color" content="#ffffff">

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body class="page">



  
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WMC4KTP"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  



  

<header class="header">
  <span class="header__nav -clone"></span>

  <a href="https://learning.lpi.org/" class="header__logo-link">
    <img class="header__logo" src="../../../../../../lpi-learning-logo.svg" alt="Linux Professional Institute Learning Logo.">
  </a>

  <nav class="header__nav nav">
    <a href="index.html#content" class="nav__skip">Skip to main content</a>

    <button class="nav__button" aria-hidden="true">
      <span></span>
      <span></span>
      <span></span>
    </button>

    <div class="nav__menus">
      <ul class="nav__menu">
        
          <li class="nav__item
              
              
              ">


            
              <a href="https://learning.lpi.org/en/" class="nav__link">Home</a>
            


            
          </li>
        
          <li class="nav__item
              -has-submenu
              -is-active
              ">


            
              <button class="nav__link" type="button">Learning Materials</button>
            


            
              <ul class="nav__menu -submenu">
                
                  <li class="nav__item
                      ">
                    <a href="https://learning.lpi.org/en/learning-materials/all-materials/" class="nav__link
                      ">All Resources</a>
                  </li>
                
                  <li class="nav__item
                      ">
                    <a href="https://learning.lpi.org/en/learning-materials/learning-materials/" class="nav__link
                      ">LPI Learning Materials</a>
                  </li>
                
                  <li class="nav__item
                      ">
                    <a href="https://learning.lpi.org/en/learning-materials/become-contributor/" class="nav__link
                      ">Become a Contributor</a>
                  </li>
                
              </ul>
            
          </li>
        
          <li class="nav__item
              -has-submenu
              
              ">


            
              <button class="nav__link" type="button">Publishing Partners</button>
            


            
              <ul class="nav__menu -submenu">
                
                  <li class="nav__item
                      ">
                    <a href="https://learning.lpi.org/en/lpi-publishing-partner/lpp-partners/" class="nav__link
                      ">Publishing Partners</a>
                  </li>
                
                  <li class="nav__item
                      ">
                    <a href="https://learning.lpi.org/en/lpi-publishing-partner/become-lpp/" class="nav__link
                      ">Become a Publishing Partner</a>
                  </li>
                
              </ul>
            
          </li>
        
          <li class="nav__item
              -has-submenu
              
              ">


            
              <button class="nav__link" type="button">About</button>
            


            
              <ul class="nav__menu -submenu">
                
                  <li class="nav__item
                      ">
                    <a href="https://learning.lpi.org/en/about/about/" class="nav__link
                      ">About</a>
                  </li>
                
                  <li class="nav__item
                      ">
                    <a href="https://learning.lpi.org/en/about/faq/" class="nav__link
                      ">FAQ</a>
                  </li>
                
                  <li class="nav__item
                      ">
                    <a href="https://learning.lpi.org/en/about/lm-contributors/" class="nav__link
                      ">Contributors</a>
                  </li>
                
                  <li class="nav__item
                      ">
                    <a href="https://learning.lpi.org/en/about/roadmap/" class="nav__link
                      ">Roadmap</a>
                  </li>
                
                  <li class="nav__item
                      ">
                    <a href="https://learning.lpi.org/en/about/contact/" class="nav__link
                      ">Contact</a>
                  </li>
                
              </ul>
            
          </li>
        
      </ul>

      <ul class="nav__menu -secondary">
        <li class="nav__item -lang-select">
        
<select name="language-picker" id="lang-select" class="lang-select" title='Language' aria-label='Language'>
  
    <option value="es"
      >Español</option>
  
    <option value="en"
      selected>English</option>
  
    <option value="pt"
      >Português</option>
  
</select>


        </li>
        <li class="nav__item -external">
        <a href="https://lpi.org/" class="nav__link" target="_blank" rel="noreferrer noopener">LPI.org</a>
        </li>
      </ul>
    </div>
  </nav>
</header>


  <table class="print-header">
    <tr class="print-header__body">
      <td class="print-header__cell">108.2 Lesson 2</td>
      <td class="print-header__cell -pagenumber"></td>
    </tr>
  </table>

  <table class="print">
    <thead><tr><td class="print__cell">
      <div class="print__space -header"></div>
    </td></tr></thead>
    <tbody><tr><td class="print__cell">
      <main id="content">




<div class="lesson page-content">
  <div class="lesson__hierarchy page-content__hierarchy">
    <nav class="hierarchy">
  

  <div class="hierarchy__container">
     
      <dl class="hierarchy__section">
        <dt class="hierarchy__heading">Topic 105: Shells and Shell Scripting
          <button class="hierarchy__toggle-button" aria-hidden="true">
            <span class="hierarchy__toggle-button__icon"></span>
          </button>
        </dt>

        
        <dd class="hierarchy__item">
          <a href="../../../105/105.1/index.html" class="hierarchy__link">105.1 Customize and use the shell environment</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../105/105.1/105.1_01/index.html" class="hierarchy__link">105.1 Lesson 1</a>
            </li>
            
            <li class="hierarchy__item">
              <a href="../../../105/105.1/105.1_02/index.html" class="hierarchy__link">105.1 Lesson 2</a>
            </li>
            
            <li class="hierarchy__item">
              <a href="../../../105/105.1/105.1_03/index.html" class="hierarchy__link">105.1 Lesson 3</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../../105/105.2/index.html" class="hierarchy__link">105.2 Customize or write simple scripts</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../105/105.2/105.2_01/index.html" class="hierarchy__link">105.2 Lesson 1</a>
            </li>
            
            <li class="hierarchy__item">
              <a href="../../../105/105.2/105.2_02/index.html" class="hierarchy__link">105.2 Lesson 2</a>
            </li>
            
          </ul>
        </dd>
        
      </dl>
      
      <dl class="hierarchy__section">
        <dt class="hierarchy__heading">Topic 106: User Interfaces and Desktops
          <button class="hierarchy__toggle-button" aria-hidden="true">
            <span class="hierarchy__toggle-button__icon"></span>
          </button>
        </dt>

        
        <dd class="hierarchy__item">
          <a href="../../../106/106.1/index.html" class="hierarchy__link">106.1 Install and configure X11</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../106/106.1/106.1_01/index.html" class="hierarchy__link">106.1 Lesson 1</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../../106/106.2/index.html" class="hierarchy__link">106.2 Graphical Desktops</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../106/106.2/106.2_01/index.html" class="hierarchy__link">106.2 Lesson 1</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../../106/106.3/index.html" class="hierarchy__link">106.3 Accessibility</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../106/106.3/106.3_01/index.html" class="hierarchy__link">106.3 Lesson 1</a>
            </li>
            
          </ul>
        </dd>
        
      </dl>
      
      <dl class="hierarchy__section">
        <dt class="hierarchy__heading">Topic 107: Administrative Tasks
          <button class="hierarchy__toggle-button" aria-hidden="true">
            <span class="hierarchy__toggle-button__icon"></span>
          </button>
        </dt>

        
        <dd class="hierarchy__item">
          <a href="../../../107/107.1/index.html" class="hierarchy__link">107.1 Manage user and group accounts and related system files</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../107/107.1/107.1_01/index.html" class="hierarchy__link">107.1 Lesson 1</a>
            </li>
            
            <li class="hierarchy__item">
              <a href="../../../107/107.1/107.1_02/index.html" class="hierarchy__link">107.1 Lesson 2</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../../107/107.2/index.html" class="hierarchy__link">107.2 Automate system administration tasks by scheduling jobs</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../107/107.2/107.2_01/index.html" class="hierarchy__link">107.2 Lesson 1</a>
            </li>
            
            <li class="hierarchy__item">
              <a href="../../../107/107.2/107.2_02/index.html" class="hierarchy__link">107.2 Lesson 2</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../../107/107.3/index.html" class="hierarchy__link">107.3 Localisation and internationalisation</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../107/107.3/107.3_01/index.html" class="hierarchy__link">107.3 Lesson 1</a>
            </li>
            
          </ul>
        </dd>
        
      </dl>
      
      <dl class="hierarchy__section -is-active">
        <dt class="hierarchy__heading">Topic 108: Essential System Services
          <button class="hierarchy__toggle-button" aria-hidden="true">
            <span class="hierarchy__toggle-button__icon"></span>
          </button>
        </dt>

        
        <dd class="hierarchy__item">
          <a href="../../108.1/index.html" class="hierarchy__link">108.1 Maintain system time</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../108.1/108.1_01/index.html" class="hierarchy__link">108.1 Lesson 1</a>
            </li>
            
            <li class="hierarchy__item">
              <a href="../../108.1/108.1_02/index.html" class="hierarchy__link">108.1 Lesson 2</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../index.html" class="hierarchy__link">108.2 System logging</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../108.2_01/index.html" class="hierarchy__link">108.2 Lesson 1</a>
            </li>
            
            <li class="hierarchy__item">
              <a href="index.html" class="hierarchy__link">108.2 Lesson 2</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../108.3/index.html" class="hierarchy__link">108.3 Mail Transfer Agent (MTA) basics</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../108.3/108.3_01/index.html" class="hierarchy__link">108.3 Lesson 1</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../108.4/index.html" class="hierarchy__link">108.4 Manage printers and printing</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../108.4/108.4_01/index.html" class="hierarchy__link">108.4 Lesson 1</a>
            </li>
            
          </ul>
        </dd>
        
      </dl>
      
      <dl class="hierarchy__section">
        <dt class="hierarchy__heading">Topic 109: Networking Fundamentals
          <button class="hierarchy__toggle-button" aria-hidden="true">
            <span class="hierarchy__toggle-button__icon"></span>
          </button>
        </dt>

        
        <dd class="hierarchy__item">
          <a href="../../../109/109.1/index.html" class="hierarchy__link">109.1 Fundamentals of internet protocols</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../109/109.1/109.1_01/index.html" class="hierarchy__link">109.1 Lesson 1</a>
            </li>
            
            <li class="hierarchy__item">
              <a href="../../../109/109.1/109.1_02/index.html" class="hierarchy__link">109.1 Lesson 2</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../../109/109.2/index.html" class="hierarchy__link">109.2 Persistent network configuration</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../109/109.2/109.2_01/index.html" class="hierarchy__link">109.2 Lesson 1</a>
            </li>
            
            <li class="hierarchy__item">
              <a href="../../../109/109.2/109.2_02/index.html" class="hierarchy__link">109.2 Lesson 2</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../../109/109.3/index.html" class="hierarchy__link">109.3 Basic network troubleshooting</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../109/109.3/109.3_01/index.html" class="hierarchy__link">109.3 Lesson 1</a>
            </li>
            
            <li class="hierarchy__item">
              <a href="../../../109/109.3/109.3_02/index.html" class="hierarchy__link">109.3 Lesson 2</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../../109/109.4/index.html" class="hierarchy__link">109.4 Configure client side DNS</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../109/109.4/109.4_01/index.html" class="hierarchy__link">109.4 Lesson 1</a>
            </li>
            
          </ul>
        </dd>
        
      </dl>
      
      <dl class="hierarchy__section">
        <dt class="hierarchy__heading">Topic 110: Security
          <button class="hierarchy__toggle-button" aria-hidden="true">
            <span class="hierarchy__toggle-button__icon"></span>
          </button>
        </dt>

        
        <dd class="hierarchy__item">
          <a href="../../../110/110.1/index.html" class="hierarchy__link">110.1 Perform security administration tasks</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../110/110.1/110.1_01/index.html" class="hierarchy__link">110.1 Lesson 1</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../../110/110.2/index.html" class="hierarchy__link">110.2 Setup host security</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../110/110.2/110.2_01/index.html" class="hierarchy__link">110.2 Lesson 1</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../../110/110.3/index.html" class="hierarchy__link">110.3 Securing data with encryption</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../110/110.3/110.3_01/index.html" class="hierarchy__link">110.3 Lesson 1</a>
            </li>
            
            <li class="hierarchy__item">
              <a href="../../../110/110.3/110.3_02/index.html" class="hierarchy__link">110.3 Lesson 2</a>
            </li>
            
          </ul>
        </dd>
        
      </dl>
      
  </div>
</nav>

  </div>



  <div class="lesson__container page-content__container">
    <div class="container">
      <nav class="lesson__breadcrumb breadcrumb">
        <ol class="breadcrumb__list">
          
          <li class="breadcrumb__item">
            <a href="../../index.html" class="breadcrumb__link">Topic 108: Essential System Services</a>
          </li>
          
          
          <li class="breadcrumb__item">
            <a href="../index.html" class="breadcrumb__link">108.2 System logging</a>
          </li>
          
          <li class="breadcrumb__item">
            <a href="index.html" class="breadcrumb__link">108.2 Lesson 2</a>
          </li>
        </ol>
      </nav>

      
      <section class="lesson__content">
        
          <h1>108.2 Lesson 2</h1>
          <div id="preamble">
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch fronttable">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Certificate:</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">LPIC-1</p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Version:</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.0</p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Topic:</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">108 Essential System Services</p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Objective:</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">108.2 System logging</p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Lesson:</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">2 of 2</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="sec.108.2_02-IN">Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>With the general adoption of <code>systemd</code> by all major distributions, the journal daemon (<code>systemd-journald</code>) has become the standard logging service. In this lesson we will discuss how it operates and how you can use it to do a number of things: query it, filter its information by different criteria, configure its storage and size, delete old data, retrieve its data from a rescue system or filesystem copy and&#8201;&#8212;&#8201;last but not least&#8201;&#8212;&#8201;understand its interaction with <code>rsyslogd</code>.</p>
</div>
<div class="sect2">
<h3 id="_basics_of_systemd">Basics of <code>systemd</code></h3>
<div class="paragraph">
<p>First introduced in Fedora, <code>systemd</code> has progressively replaced SysV Init as the <em>de facto</em> system and service manager in most major Linux distributions. Amongst its strenghts are the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Ease of configuration: unit files as opposed to SysV Init scripts.</p>
</li>
<li>
<p>Versatile management: apart from daemons and processes, it also manages devices, sockets and mount points.</p>
</li>
<li>
<p>Backward compatibility with both SysV Init and Upstart.</p>
</li>
<li>
<p>Parallel loading during boot-up: services are loaded in parallel as opposed to Sysv Init loading them sequentially.</p>
</li>
<li>
<p>It features a logging service called the <em>journal</em> that presents the following advantages:</p>
<div class="ulist">
<ul>
<li>
<p>It centralizes all logs in one place.</p>
</li>
<li>
<p>It does not require log rotation.</p>
</li>
<li>
<p>Logs can be disabled, loaded in RAM or made persistent.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_units_and_targets">Units and Targets</h4>
<div class="paragraph">
<p><code>systemd</code> operates on <em>units</em>. A unit is any resource that <code>systemd</code> can manage (e.g. network, bluetooth, etc.). Units&#8201;&#8212;&#8201;in turn&#8201;&#8212;&#8201;are governed by <em>unit files</em>. These are plain text files which live in <code>/lib/systemd/system</code> and include the configuration settings&#8201;&#8212;&#8201;in the form of <em>sections</em> and <em>directives</em>&#8201;&#8212;&#8201;for a particular resource to be managed. There are a number of unit types: <code>service</code>, <code>mount</code>, <code>automount</code>, <code>swap</code>, <code>timer</code>, <code>device</code>, <code>socket</code>,<code>path</code>, <code>timer</code>, <code>snapshot</code>, <code>slice</code>, <code>scope</code> and <code>target</code>. Thus, every unit file name follows the pattern <code>&lt;resource_name&gt;.&lt;unit_type&gt;</code> (e.g. <code>reboot.service</code>).</p>
</div>
<div class="paragraph">
<p>A <em>target</em> is a special type of unit which resembles the classic runlevels of SysV Init. This is because a <em>target unit</em> brings together various resources to represent a particular system state (e.g. <code>graphical.target</code> is similar to <code>runlevel 5</code>, etc.). To check the current target in your system, use the <code>systemctl get-default</code> command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>carol@debian:~$ <strong>systemctl get-default</strong>
graphical.target</pre>
</div>
</div>
<div class="paragraph">
<p>On the other hand, targets and runlevels differ in that the former are mutually inclusive, whereas the latter are not. Thus a target can bring up other targets&#8201;&#8212;&#8201;which is not possible with runlevels.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>An explanation of how <code>systemd</code> units work is beyond the scope of this lesson.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_the_system_journal_systemd_journald">The System Journal: <code>systemd-journald</code></h3>
<div class="paragraph">
<p><code>systemd-journald</code> is the system service which takes care of receiving logging information from a variety of sources: kernel messages, simple and structured system messages, standard output and standard error of services as well as audit records from the kernel audit subsystem (for further details see the manual page for <code>systemd-journald</code>). Its mission is that of creating and maintaining a structured and indexed journal.</p>
</div>
<div class="paragraph">
<p>Its configuration file is <code>/etc/systemd/journald.conf</code> and&#8201;&#8212;&#8201;as with any other service&#8201;&#8212;&#8201;you can use the <code>systemctl</code> command to <em>start</em> it, <em>restart</em> it, <em>stop</em> it or&#8201;&#8212;&#8201;simply&#8201;&#8212;&#8201;check its <em>status</em>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>root@debian:~# <strong>systemctl status systemd-journald</strong>
 systemd-journald.service - Journal Service
   Loaded: loaded (/lib/systemd/system/systemd-journald.service; static; vendor preset: enabled)
   Active: active (running) since Sat 2019-10-12 13:43:06 CEST; 5min ago
     Docs: man:systemd-journald.service(8)
           man:journald.conf(5)
 Main PID: 178 (systemd-journal)
   Status: "Processing requests..."
    Tasks: 1 (limit: 4915)
   CGroup: /system.slice/systemd-journald.service
           └─178 /lib/systemd/systemd-journald
(...)</pre>
</div>
</div>
<div class="paragraph">
<p>Configuration files of the type <code>journal.conf.d/*.conf</code>&#8201;&#8212;&#8201;which can include package-specific configurations&#8201;&#8212;&#8201;are also possible (consult the manual page of <code>journald.conf</code> to learn more).</p>
</div>
<div class="paragraph">
<p>If enabled, the journal can be stored either persistently on disk or in a volatile manner on a RAM-based filesystem. The journal is not a plain text file, it is binary. Thus, you cannot use text parsing tools such as <code>less</code> or <code>more</code> to read its contents; the <code>journalctl</code> command is used instead.</p>
</div>
<div class="sect3">
<h4 id="_querying_the_journal_content">Querying the Journal Content</h4>
<div class="paragraph">
<p><code>journalctl</code> is the utility that you use to query <code>systemd</code> journal. You have to either be root or use <code>sudo</code> to invoke it. If queried without options, it will print the entire journal chronologically (with the oldest entries listed first):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>root@debian:~# <strong>journalctl</strong>
-- Logs begin at Sat 2019-10-12 13:43:06 CEST, end at Sat 2019-10-12 14:19:46 CEST. --
Oct 12 13:43:06 debian kernel: Linux version 4.9.0-9-amd64 (debian-kernel@lists.debian.org) (...)
Oct 12 13:43:06 debian kernel: Command line: BOOT_IMAGE=/boot/vmlinuz-4.9.0-9-amd64 root=UUID=b6be6117-5226-4a8a-bade-2db35ccf4cf4 ro qu
(...)</pre>
</div>
</div>
<div class="paragraph">
<p>You can make more specific queries by using a number of switches:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>-r</code></dt>
<dd>
<p>The messages of the journal will be printed in reverse order:</p>
<div class="listingblock">
<div class="content">
<pre>root@debian:~# <strong>journalctl -r</strong>
-- Logs begin at Sat 2019-10-12 13:43:06 CEST, end at Sat 2019-10-12 14:30:30 CEST. --
Oct 12 14:30:30 debian sudo[1356]: pam_unix(sudo:session): session opened for user root by carol(uid=0)
Oct 12 14:30:30 debian sudo[1356]:    carol : TTY=pts/0 ; PWD=/home/carol ; USER=root ; COMMAND=/bin/journalctl -r
Oct 12 14:19:53 debian sudo[1348]: pam_unix(sudo:session): session closed for user root
(...)</pre>
</div>
</div>
</dd>
<dt class="hdlist1"><code>-f</code></dt>
<dd>
<p>It will print the most recent journal messages and keep printing new entries as they are appended to the journal&#8201;&#8212;&#8201;much like <code>tail -f</code>:</p>
<div class="listingblock">
<div class="content">
<pre>root@debian:~# <strong>journalctl -f</strong>
-- Logs begin at Sat 2019-10-12 13:43:06 CEST. --
(...)
Oct 12 14:44:42 debian sudo[1356]: pam_unix(sudo:session): session closed for user root
Oct 12 14:44:44 debian sudo[1375]:    carol : TTY=pts/0 ; PWD=/home/carol ; USER=root ; COMMAND=/bin/journalctl -f
Oct 12 14:44:44 debian sudo[1375]: pam_unix(sudo:session): session opened for user root by carol(uid=0)

(...)</pre>
</div>
</div>
</dd>
<dt class="hdlist1"><code>-e</code></dt>
<dd>
<p>It will jump to the end of the journal so that the latest entries are visible within the pager:</p>
<div class="listingblock">
<div class="content">
<pre>root@debian:~# <strong>journalctl -e</strong>
(...)
Oct 12 14:44:44 debian sudo[1375]:    carol : TTY=pts/0 ; PWD=/home/carol ; USER=root ; COMMAND=/bin/journalctl -f
Oct 12 14:44:44 debian sudo[1375]: pam_unix(sudo:session): session opened for user root by carol(uid=0)
Oct 12 14:45:57 debian sudo[1375]: pam_unix(sudo:session): session closed for user root
Oct 12 14:48:39 debian sudo[1378]:    carol : TTY=pts/0 ; PWD=/home/carol ; USER=root ; COMMAND=/bin/journalctl -e
Oct 12 14:48:39 debian sudo[1378]: pam_unix(sudo:session): session opened for user root by carol(uid=0)</pre>
</div>
</div>
</dd>
<dt class="hdlist1"><code>-n &lt;value&gt;, --lines=&lt;value&gt;</code></dt>
<dd>
<p>It will print the <em>value</em> most recent lines (if no <code>&lt;value&gt;</code> is specified, it defaults to 10):</p>
<div class="listingblock">
<div class="content">
<pre>root@debian:~# <strong>journalctl -n 5</strong>
(...)
Oct 12 14:44:44 debian sudo[1375]:    carol : TTY=pts/0 ; PWD=/home/carol ; USER=root ; COMMAND=/bin/journalctl -f
Oct 12 14:44:44 debian sudo[1375]: pam_unix(sudo:session): session opened for user root by carol(uid=0)
Oct 12 14:45:57 debian sudo[1375]: pam_unix(sudo:session): session closed for user root
Oct 12 14:48:39 debian sudo[1378]:    carol : TTY=pts/0 ; PWD=/home/carol ; USER=root ; COMMAND=/bin/journalctl -e
Oct 12 14:48:39 debian sudo[1378]: pam_unix(sudo:session): session opened for user root by carol(uid=0)</pre>
</div>
</div>
</dd>
<dt class="hdlist1"><code>-k</code>, <code>--dmesg</code></dt>
<dd>
<p>Equivalent to using the <code>dmesg</code> command:</p>
<div class="listingblock">
<div class="content">
<pre>root@debian:~# <strong>journalctl -k</strong>
-- Logs begin at Sat 2019-10-12 13:43:06 CEST, end at Sat 2019-10-12 14:53:20 CEST. --
Oct 12 13:43:06 debian kernel: Linux version 4.9.0-9-amd64 (debian-kernel@lists.debian.org) (gcc version 6.3.0 20170516 (Debian 6.3.0-18
Oct 12 13:43:06 debian kernel: Command line: BOOT_IMAGE=/boot/vmlinuz-4.9.0-9-amd64 root=UUID=b6be6117-5226-4a8a-bade-2db35ccf4cf4 ro qu
Oct 12 13:43:06 debian kernel: x86/fpu: Supporting XSAVE feature 0x001: 'x87 floating point registers'
Oct 12 13:43:06 debian kernel: x86/fpu: Supporting XSAVE feature 0x002: 'SSE registers'
(...)</pre>
</div>
</div>
</dd>
</dl>
</div>
<div class="sect4">
<h5 id="_navigating_and_searching_through_the_journal">Navigating and Searching Through the Journal</h5>
<div class="paragraph">
<p>You can navigate the journal&#8217;s outuput with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>PageUp, PageDown and arrow keys to move up, down, left and right.</p>
</li>
<li>
<p><kbd>&gt;</kbd> to go to the end of the output.</p>
</li>
<li>
<p><kbd>&lt;</kbd> to go to the beginning of the output.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can search for strings both forward and backward from your current view position:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Forward search: Press <kbd>/</kbd> and enter the string to be searched, then press Enter.</p>
</li>
<li>
<p>Backward search: Press <kbd>?</kbd> and enter the string to be searched, then press Enter.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To navigate through matches in the searches, use <kbd>N</kbd> to go to the next occurrence of the match and <span class="keyseq"><kbd>Shift</kbd>+<kbd>N</kbd></span> to go to the previous one.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_filtering_the_journal_data">Filtering the Journal Data</h4>
<div class="paragraph">
<p>The journal allows you to filter log data by different criteria:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Boot number</dt>
<dd>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>--list-boots</code></dt>
<dd>
<p>It lists all available boots. The output consists of three columns; the first one specifies the boot number (<code>0</code> refers to the current boot, <code>-1</code> is the previous one, <code>-2</code> the one prior to the previous one and so on); the second column is the boot ID; the third shows the time stamps:</p>
<div class="listingblock">
<div class="content">
<pre>root@debian:~# <strong>journalctl --list-boots</strong>
 0 83df3e8653474ea5aed19b41cdb45b78 Sat 2019-10-12 18:55:41 CEST—Sat 2019-10-12 19:02:24 CEST</pre>
</div>
</div>
</dd>
<dt class="hdlist1"><code>-b</code>, <code>--boot</code></dt>
<dd>
<p>It shows all messages from the current boot. To see log messages from previous boots, just add an offset parameter as explained above. For example, to have messages from the previous boot printed, you will type <code>journalctl -b -1</code>. Remember, though, that to recover information from previous logs, persistence of the journal must be enabled (you will learn how to do so in the next section):</p>
<div class="listingblock">
<div class="content">
<pre>root@debian:~# <strong>journalctl -b -1</strong>
Specifying boot ID has no effect, no persistent journal was found</pre>
</div>
</div>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1">Priority</dt>
<dd>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>-p</code></dt>
<dd>
<p>Interestingly enough, you can also filter by severity/priority with the <code>-p</code> option:</p>
<div class="listingblock">
<div class="content">
<pre>root@debian:~# <strong>journalctl -b -0 -p err</strong>
-- No entries --</pre>
</div>
</div>
<div class="paragraph">
<p>The journal informs us that&#8201;&#8212;&#8201;so far&#8201;&#8212;&#8201;there have not been any messages with a priority of <code>error</code> (or above) from the current boot. Note: <code>-b -0</code> can be omitted when referring to the current boot.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Refer to the previous lesson for a complete list of all <code>syslog</code> severities (aka priorities).</p>
</div>
</td>
</tr>
</table>
</div>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1">Time Interval</dt>
<dd>
<p>You can have <code>journalctl</code> print only the messages logged within a specific time frame by using the <code>--since</code> and <code>--until</code> switches. The date specification should follow the format <code>YYYY-MM-DD HH:MM:SS</code>. Midnight will be assumed if we omit the time component. By the same token, if the date is omitted, the current day is assumed. For instance, to see messages logged from 7:00pm to 7:01pm, you will type:</p>
<div class="listingblock">
<div class="content">
<pre>root@debian:~# <strong>journalctl --since "19:00:00" --until "19:01:00"</strong>
-- Logs begin at Sat 2019-10-12 18:55:41 CEST, end at Sat 2019-10-12 20:10:50 CEST. --
Oct 12 19:00:14 debian systemd[1]: Started Run anacron jobs.
Oct 12 19:00:14 debian anacron[1057]: Anacron 2.3 started on 2019-10-12
Oct 12 19:00:14 debian anacron[1057]: Normal exit (0 jobs run)
Oct 12 19:00:14 debian systemd[1]: anacron.timer: Adding 2min 47.988096s random time.</pre>
</div>
</div>
<div class="paragraph">
<p>Likewise you can use a slightly different time specification: <code>"integer time-unit ago"</code>. Thus, to see messages logged two minutes ago you will type <code>sudo journalctl --since "2 minutes ago"</code>. It is also possible to use <code>+</code> and <code>-</code> to specify times relative to the current time so <code>--since "-2 minutes"</code> and <code>--since "2 minutes ago"</code> are equivalent.</p>
</div>
<div class="paragraph">
<p>Apart from numeric expressions, you can specify a number of keywords:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>yesterday</code></dt>
<dd>
<p>As of midnight of the day before the current day.</p>
</dd>
<dt class="hdlist1"><code>today</code></dt>
<dd>
<p>As of midnight of the current day.</p>
</dd>
<dt class="hdlist1"><code>tomorrow</code></dt>
<dd>
<p>As of midnight of the day after the current day.</p>
</dd>
<dt class="hdlist1"><code>now</code></dt>
<dd>
<p>The current time.</p>
<div class="paragraph">
<p>Let us see all messages since last midnight until today at 21:00pm:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>root@debian:~# <strong>journalctl --since "today" --until "21:00:00"</strong>
-- Logs begin at Sat 2019-10-12 20:45:29 CEST, end at Sat 2019-10-12 21:06:15 CEST. --
Oct 12 20:45:29 debian sudo[1416]:    carol : TTY=pts/0 ; PWD=/home/carol ; USER=root ; COMMAND=/bin/systemctl r
Oct 12 20:45:29 debian sudo[1416]: pam_unix(sudo:session): session opened for user root by carol(uid=0)
Oct 12 20:45:29 debian systemd[1]: Stopped Flush Journal to Persistent Storage.
(...)</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>To learn more about the different syntaxes for time specifications, consult the manual page <code>systemd.time</code>.</p>
</div>
</td>
</tr>
</table>
</div>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1">Program</dt>
<dd>
<p>To see journal messages related to a specific executable the following syntax is used: <code>journalctl <em>/path/to/executable</em></code>:</p>
<div class="listingblock">
<div class="content">
<pre>root@debian:~# <strong>journalctl /usr/sbin/sshd</strong>
-- Logs begin at Sat 2019-10-12 20:45:29 CEST, end at Sat 2019-10-12 21:54:49 CEST. --
Oct 12 21:16:28 debian sshd[1569]: Accepted password for carol from 192.168.1.65 port 34050 ssh2
Oct 12 21:16:28 debian sshd[1569]: pam_unix(sshd:session): session opened for user carol by (uid=0)
Oct 12 21:16:54 debian sshd[1590]: Accepted password for carol from 192.168.1.65 port 34052 ssh2
Oct 12 21:16:54 debian sshd[1590]: pam_unix(sshd:session): session opened for user carol by (uid=0)</pre>
</div>
</div>
</dd>
<dt class="hdlist1">Unit</dt>
<dd>
<p>Remember, a unit is any resource handled by <code>systemd</code> and you can filter by them, too.</p>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>-u</code></dt>
<dd>
<p>It shows messages about a specified unit:</p>
<div class="listingblock">
<div class="content">
<pre>root@debian:~# <strong>journalctl -u ssh.service</strong>
-- Logs begin at Sun 2019-10-13 10:50:59 CEST, end at Sun 2019-10-13 12:22:59 CEST. --
Oct 13 10:51:00 debian systemd[1]: Starting OpenBSD Secure Shell server...
Oct 13 10:51:00 debian sshd[409]: Server listening on 0.0.0.0 port 22.
Oct 13 10:51:00 debian sshd[409]: Server listening on :: port 22.
(...)</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>To print all loaded and active units, use <code>systemctl list-units</code>; to see all installed unit files use <code>systemctl list-unit-files</code>.</p>
</div>
</td>
</tr>
</table>
</div>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1">Fields</dt>
<dd>
<p>The journal can also be filtered by specific <em>fields</em> through any of the following syntaxes:</p>
<div class="ulist">
<ul>
<li>
<p><code>&lt;field-name&gt;=&lt;value&gt;</code></p>
</li>
<li>
<p><code>_&lt;field-name&gt;=&lt;value&gt;_</code></p>
</li>
<li>
<p><code>__&lt;field-name&gt;=&lt;value&gt;</code></p>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>PRIORITY=</code></dt>
<dd>
<p>One of eight possible <code>syslog</code> priority values formatted as a decimal string:</p>
<div class="listingblock">
<div class="content">
<pre>root@debian:~# <strong>journalctl PRIORITY=3</strong>
-- Logs begin at Sun 2019-10-13 10:50:59 CEST, end at Sun 2019-10-13 14:30:50 CEST. --
Oct 13 10:51:00 debian avahi-daemon[314]: chroot.c: open() failed: No such file or directory</pre>
</div>
</div>
<div class="paragraph">
<p>Note how you could have achieved the same output by using the command <code>sudo journalctl -p err</code> that we saw above.</p>
</div>
</dd>
<dt class="hdlist1"><code>SYSLOG_FACILITY=</code></dt>
<dd>
<p>Any of the possible facility code numbers formatted as a decimal string. For example, to see all user-level messages:</p>
<div class="listingblock">
<div class="content">
<pre>root@debian:~# <strong>journalctl SYSLOG_FACILITY=1</strong>
-- Logs begin at Sun 2019-10-13 10:50:59 CEST, end at Sun 2019-10-13 14:42:52 CEST. --
Oct 13 10:50:59 debian mtp-probe[227]: checking bus 1, device 2: "/sys/devices/pci0000:00/0000:00:06.0/usb1/1-1"
Oct 13 10:50:59 debian mtp-probe[227]: bus: 1, device: 2 was not an MTP device
Oct 13 10:50:59 debian mtp-probe[238]: checking bus 1, device 2: "/sys/devices/pci0000:00/0000:00:06.0/usb1/1-1"
Oct 13 10:50:59 debian mtp-probe[238]: bus: 1, device: 2 was not an MTP device</pre>
</div>
</div>
</dd>
<dt class="hdlist1"><code>_PID=</code></dt>
<dd>
<p>Show messages produced by a specific process ID. To see all messages produced by <code>systemd</code>, you would type:</p>
<div class="listingblock">
<div class="content">
<pre>root@debian:~# <strong>journalctl _PID=1</strong>
-- Logs begin at Sun 2019-10-13 10:50:59 CEST, end at Sun 2019-10-13 14:50:15 CEST. --
Oct 13 10:50:59 debian systemd[1]: Mounted Debug File System.
Oct 13 10:50:59 debian systemd[1]: Mounted POSIX Message Queue File System.
Oct 13 10:50:59 debian systemd[1]: Mounted Huge Pages File System.
Oct 13 10:50:59 debian systemd[1]: Started Remount Root and Kernel File Systems.
Oct 13 10:50:59 debian systemd[1]: Starting Flush Journal to Persistent Storage...
(...)</pre>
</div>
</div>
</dd>
<dt class="hdlist1"><code>_BOOT_ID</code></dt>
<dd>
<p>Based on its boot ID you can single out the messages from a specific boot, for example: <code>sudo journalctl _BOOT_ID=83df3e8653474ea5aed19b41cdb45b78</code>.</p>
</dd>
<dt class="hdlist1"><code>_TRANSPORT</code></dt>
<dd>
<p>Show messages received from a specific transport. Possible values are: <code>audit</code> (kernel audit subsystem), <code>driver</code> (generated internally), <code>syslog</code> (syslog socket), <code>journal</code> (native journal protocol), <code>stdout</code> (services' standard output or standard error), <code>kernel</code> (kernel ring buffer&#8201;&#8212;&#8201;the same as <code>dmesg</code>, <code>journalctl -k</code> or <code>journalctl --dmesg</code>):</p>
<div class="listingblock">
<div class="content">
<pre>root@debian:~# <strong>journalctl _TRANSPORT=journal</strong>
-- Logs begin at Sun 2019-10-13 20:19:58 CEST, end at Sun 2019-10-13 20:46:36 CEST. --
Oct 13 20:19:58 debian systemd[1]: Started Create list of required static device nodes for the current kernel.
Oct 13 20:19:58 debian systemd[1]: Starting Create Static Device Nodes in /dev...
Oct 13 20:19:58 debian systemd[1]: Started Create Static Device Nodes in /dev.
Oct 13 20:19:58 debian systemd[1]: Starting udev Kernel Device Manager...
(...)</pre>
</div>
</div>
</dd>
</dl>
</div>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="sect4">
<h5 id="_combining_fields">Combining Fields</h5>
<div class="paragraph">
<p>Fields are not mutually exclusive so you can use more than one in the same query. However, only messages that match the value of both fields simultaneously will be shown:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>root@debian:~# <strong>journalctl PRIORITY=3 SYSLOG_FACILITY=0</strong>
-- No entries --
root@debian:~# <strong>journalctl PRIORITY=4 SYSLOG_FACILITY=0</strong>
-- Logs begin at Sun 2019-10-13 20:19:58 CEST, end at Sun 2019-10-13 20:21:55 CEST. --
Oct 13 20:19:58 debian kernel: acpi PNP0A03:00: fail to add MMCONFIG information, can't access extended PCI configuration (...)</pre>
</div>
</div>
<div class="paragraph">
<p>Unless you use the <code>+</code> separator to combine two expressions in the manner of a logical <em>OR</em>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>root@debian:~# <strong>journalctl PRIORITY=3 + SYSLOG_FACILITY=0</strong>
-- Logs begin at Sun 2019-10-13 20:19:58 CEST, end at Sun 2019-10-13 20:24:02 CEST. --
Oct 13 20:19:58 debian kernel: Linux version 4.9.0-9-amd64 (debian-kernel@lists.debian.org) (...9
Oct 13 20:19:58 debian kernel: Command line: BOOT_IMAGE=/boot/vmlinuz-4.9.0-9-amd64 root=UUID= (...)
(...)</pre>
</div>
</div>
<div class="paragraph">
<p>On the other hand, you can supply two values for the same field and all entries matching either value will be shown:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>root@debian:~# <strong>journalctl PRIORITY=1</strong>
-- Logs begin at Sun 2019-10-13 17:16:24 CEST, end at Sun 2019-10-13 17:30:14 CEST. --
-- No entries --
root@debian:~# <strong>journalctl PRIORITY=1 PRIORITY=3</strong>
-- Logs begin at Sun 2019-10-13 17:16:24 CEST, end at Sun 2019-10-13 17:32:12 CEST. --
Oct 13 17:16:27 debian connmand[459]: __connman_inet_get_pnp_nameservers: Cannot read /pro
Oct 13 17:16:27 debian connmand[459]: The name net.connman.vpn was not provided by any .se</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Journal fields fall in any of the following categories: &#8220;User Journal Fields&#8221;, &#8220;Trusted Journal Fields&#8221;, &#8220;Kernel Journal Fields&#8221;, &#8220;Fields on behalf of a different program&#8221; and &#8220;Address Fields&#8221;. For more information on this topic&#8201;&#8212;&#8201;including a complete list of fields&#8201;&#8212;&#8201;see the <code>man</code> page for <code>systemd.journal-fields(7)</code>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_manual_entries_in_the_system_journal_systemd_cat">Manual Entries in the System Journal: <code>systemd-cat</code></h4>
<div class="paragraph">
<p>Just like how the <code>logger</code> command is used to send messages from the command line to the system log (as we saw in the previous lesson), the <code>systemd-cat</code> command serves a similar&#8201;&#8212;&#8201;but more well-rounded&#8201;&#8212;&#8201;purpose with the system journal. It allows us to send standard input (<em>stdin</em>), output (<em>stdout</em>) and error (<em>stderr</em>) to the journal.</p>
</div>
<div class="paragraph">
<p>If invoked with no parameters, it will send everything it reads from <em>stdin</em> to the journal. Once you are done, press <span class="keyseq"><kbd>Ctrl</kbd>+<kbd>C</kbd></span>:.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>carol@debian:~$ <strong>systemd-cat</strong>
This line goes into the journal.
^C</pre>
</div>
</div>
<div class="paragraph">
<p>If it is passed the output of a piped command, this will be sent to the journal too:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>carol@debian:~$ <strong>echo "And so does this line." | systemd-cat</strong></pre>
</div>
</div>
<div class="paragraph">
<p>If followed by a command, that command&#8217;s output will also be sent to the journal&#8201;&#8212;&#8201;together with <em>stderr</em> (if any):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>carol@debian:~$ <strong>systemd-cat echo "And so does this line too."</strong></pre>
</div>
</div>
<div class="paragraph">
<p>There is also the possibility of specifiying a priority level with the <code>-p</code> option:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>carol@debian:~$ <strong>systemd-cat -p emerg echo "This is not a real emergency."</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Refer to <code>systemd-cat</code> man page to learn about its other options.</p>
</div>
<div class="paragraph">
<p>To see the last four lines in the journal:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>carol@debian:~$ <strong>journalctl -n 4</strong>
(...)
-- Logs begin at Sun 2019-10-20 13:43:54 CEST. --
Nov 13 23:14:39 debian cat[1997]: This line goes into the journal.
Nov 13 23:19:16 debian cat[2027]: And so does this line.
Nov 13 23:23:21 debian echo[2030]: And so does this line too.
Nov 13 23:26:48 debian echo[2034]: This is not a real emergency.</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Journal entries with a priority level of <em>emergency</em> will be printed in bold red on most systems.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_persistent_journal_storage">Persistent Journal Storage</h4>
<div class="paragraph">
<p>As mentioned previously, you have three options when it comes to the location of the journal:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Journaling can be turned off altogether (redirection to other facilities such as the console are still possible, though).</p>
</li>
<li>
<p>Keep it in memory&#8201;&#8212;&#8201;which makes it volatile&#8201;&#8212;&#8201;and get rid of the logs with every system reboot. In this scenario, the directory <code>/run/log/journal</code> will be created and used.</p>
</li>
<li>
<p>Make it persistent so that it writes logs to disk. In this case, log messages will go into the <code>/var/log/journal</code> directory.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The default behaviour is as follows: if <code>/var/log/journal/</code> does not exist, logs will be saved in a volatile way to a directory in <code>/run/log/journal/</code> and&#8201;&#8212;&#8201;therefore&#8201;&#8212;&#8201;lost at reboot. The name of the directory&#8201;&#8212;&#8201;the <code>/etc/machine-id</code>&#8201;&#8212;&#8201;is a newline-terminated, hexadecimal, 32-character, lowercase string:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>carol@debian:~$ <strong>ls /run/log/journal/8821e1fdf176445697223244d1dfbd73/</strong>
system.journal</pre>
</div>
</div>
<div class="paragraph">
<p>If you try to read it with less you will get a warning, so instead use the command <code>journalctl</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>root@debian:~# <strong>less /run/log/journal/9a32ba45ce44423a97d6397918de1fa5/system.journal
"/run/log/journal/9a32ba45ce44423a97d6397918de1fa5/system.journal" may be a binary file.  See it anyway?</strong>
root@debian:~# <strong>journalctl</strong>
-- Logs begin at Sat 2019-10-05 21:26:38 CEST, end at Sat 2019-10-05 21:31:27 CEST. --
(...)
Oct 05 21:26:44 debian systemd-journald[1712]: Runtime journal (/run/log/journal/9a32ba45ce44423a97d6397918de1fa5) is 4.9M, max 39.5M, 34.6M free.
Oct 05 21:26:44 debian systemd[1]: Started Journal Service.
(...)</pre>
</div>
</div>
<div class="paragraph">
<p>If <code>/var/log/journal/</code> exists, logs will be stored persistently there. Should this directory be deleted, <code>systemd-journald</code> would not recreate it but write to <code>/run/log/journal</code> instead. As soon as we create <code>/var/log/journal/</code> again and restart the daemon, persistent logging will be restablished:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>root@debian:~# <strong>mkdir /var/log/journal/</strong>
root@debian:~# <strong>systemctl restart systemd-journald</strong>
root@debian:~# <strong>journalctl</strong>
(...)
Oct 05 21:33:49 debian systemd-journald[1712]: Received SIGTERM from PID 1 (systemd).
Oct 05 21:33:49 debian systemd[1]: Stopped Journal Service.
Oct 05 21:33:49 debian systemd[1]: Starting Journal Service...
Oct 05 21:33:49 debian systemd-journald[1768]: Journal started
Oct 05 21:33:49 debian systemd-journald[1768]: System journal (/var/log/journal/9a32ba45ce44423a97d6397918de1fa5) is 8.0M, max 1.1G, 1.1G free.
Oct 05 21:33:49 debian systemd[1]: Started Journal Service.
Oct 05 21:33:49 debian systemd[1]: Starting Flush Journal to Persistent Storage...
(...)</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>By default, there will be specific journal files for every logged in user, located in <code>/var/log/journal/</code>, so&#8201;&#8212;&#8201;together with <code>system.journal</code> files&#8201;&#8212;&#8201;you will also find files of the type <code>user-1000.journal</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>On top of what we have just mentioned, the way the journal daemon deals with log storage can be changed after installation by tweaking its configuration file: <code>/etc/systemd/journald.conf</code>. The key option is <code>Storage=</code> and can have the following values:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>Storage=volatile</code></dt>
<dd>
<p>Log data will be stored exclusively in memory&#8201;&#8212;&#8201;under <code>/run/log/journal/</code>. If not present, the directory will be created.</p>
</dd>
<dt class="hdlist1"><code>Storage=persistent</code></dt>
<dd>
<p>By default log data will be stored on disk &#8201;&#8212;&#8201;under <code>/var/log/journal/</code>&#8201;&#8212;&#8201; with a fallback to memory (<code>/run/log/journal/</code>) during early boot stages and if the disk is not writable. Both directories will be created if needed.</p>
</dd>
<dt class="hdlist1"><code>Storage=auto</code></dt>
<dd>
<p><code>auto</code> is similar to <code>persistent</code>, but the directory <code>/var/log/journal</code> is not created if needed. This is the default.</p>
</dd>
<dt class="hdlist1"><code>Storage=none</code></dt>
<dd>
<p>All log data will be discarded. Forwarding to other targets such as the console, the kernel log buffer, or a syslog socket are still possible, though.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>For instance, to have <code>systemd-journald</code> create <code>/var/log/journal/</code> and switch to persistent storage, you would edit <code>/etc/systemd/journald.conf</code> and set <code>Storage=persistent</code>, save the file and restart the daemon with <code>sudo systemctl restart systemd-journald</code>. To ensure the restart went flawlessly, you can always check the daemon&#8217;s status:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>root@debian:~# <strong>systemctl status systemd-journald</strong>
 systemd-journald.service - Journal Service
   Loaded: loaded (/lib/systemd/system/systemd-journald.service; static; vendor preset: enabled)
   Active: active (running) since Wed 2019-10-09 10:03:40 CEST; 2s ago
     Docs: man:systemd-journald.service(8)
           man:journald.conf(5)
 Main PID: 1872 (systemd-journal)
   Status: "Processing requests..."
    Tasks: 1 (limit: 3558)
   Memory: 1.1M
   CGroup: /system.slice/systemd-journald.service
           └─1872 /lib/systemd/systemd-journald

Oct 09 10:03:40 debian10 systemd-journald[1872]: Journal started
Oct 09 10:03:40 debian10 systemd-journald[1872]: System journal (/var/log/journal/9a32ba45ce44423a97d6397918de1fa5) is 8.0M, max 1.2G, 1.2G free.</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The journal files in <code>/var/log/journal/&lt;machine-id&gt;/</code> or <code>/run/log/journal/&lt;machine-id&gt;/</code> have the <code>.journal</code> suffix (e.g. <code>system.journal</code>). However, if they are found to be corrupted or the daemon is stopped in an unclean fashion, they will be renamed appending <code>~</code> (e.g. <code>system.journal~</code>) and the daemon will start writing to a new, clean file.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_deleting_old_journal_data_journal_size">Deleting Old Journal Data: Journal Size</h4>
<div class="paragraph">
<p>Logs are saved in <em>journal files</em> whose file names end with <code>.journal</code> or <code>.journal~</code> and are located in the appropriate directory (<code>/run/log/journal</code> or <code>/var/log/journal</code> as configured). To check how much disk space is currently being occupied by journal files (both archived and active), use the <code>--disk-usage</code> switch:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>root@debian:~# <strong>journalctl --disk-usage</strong>
Archived and active journals take up 24.0M in the filesystem.</pre>
</div>
</div>
<div class="paragraph">
<p><code>systemd</code> logs default to a maximum of 10% of the size of the filesystem where they are stored. For instance on a 1GB filesystem they will not take up more than 100MB. Once this limit is reached, old logs will start to disappear to stay near this value.</p>
</div>
<div class="paragraph">
<p>However, size limit enforcement on stored journal files can be managed by tweaking a series of configuration options in <code>/etc/systemd/journald.conf</code>. These options fall into two categories depending on the filesystem type used: persistent (<code>/var/log/journal</code>) or in-memory (<code>/run/log/journal</code>). The former uses options that are prefixed with the word <code>System</code> and will only apply if persistent logging is properly enabled and once the system is fully booted up. The option names in the latter start with the word <code>Runtime</code> and will apply in the following scenarios:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>SystemMaxUse=</code>, <code>RuntimeMaxUse=</code></dt>
<dd>
<p>They control the amount of disk space that can be taken up by the journal. It defaults to 10% of the filesystem size but can be modified (e.g. <code>SystemMaxUse=500M</code>) as long as it does not surpass a maximum of 4GiB.</p>
</dd>
<dt class="hdlist1"><code>SystemKeepFree=</code>, <code>RuntimeKeepFree=</code></dt>
<dd>
<p>They control the amount of disk space that should be left free for other users. It defaults to 15% of the filesystem size but can be modified (e.g. <code>SystemKeepFree=500M</code>) as long as it does not surpass a maximum of 4GiB.</p>
<div class="paragraph">
<p>Regarding precedence of <code>*MaxUse</code> and <code>*KeepFree</code>, <code>systemd-journald</code> will satisfy both by using the smaller of the two values. Likewise, bear in mind that only archived (as opposed to active) journal files are deleted.</p>
</div>
</dd>
<dt class="hdlist1"><code>SystemMaxFileSize=</code>, <code>RuntimeMaxFileSize=</code></dt>
<dd>
<p>They control the maximum size to which individual journal files can grow. The default is 1/8 of <code>*MaxUse</code>. Size reduction is carried out in a synchronous way and values can be specified in bytes or using <code>K</code>, <code>M</code>, <code>G</code>, <code>T</code>, <code>P</code>, <code>E</code> for Kibibytes, Mebibytes, Gibibyte, Tebibytes, Pebibytes and Exbibytes, respectively.</p>
</dd>
<dt class="hdlist1"><code>SystemMaxFiles=</code>, <code>RuntimeMaxFiles=</code></dt>
<dd>
<p>They establish the maximum number of individual and archived journal files to store (active journal files are not affected). It defaults to 100.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Apart from size-based deletion and rotation of log messages, <code>systemd-journald</code> also allows for time-based criteria by using the following two options: <code>MaxRetentionSec=</code> and <code>MaxFileSec=</code>. Refer to the manual page of <code>journald.conf</code> for more information about these and other options.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Whenever you modify the default behaviour of <code>systemd-journald</code> by uncommenting and editing options in <code>/etc/systemd/journald.conf</code>, you must restart the daemon for the changes to take effect.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_vacuuming_the_journal">Vacuuming the Journal</h5>
<div class="paragraph">
<p>You can manually clean archived journal files at any time with any of the following three options:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>--vacuum-time=</code></dt>
<dd>
<p>This time-based option will eliminate all messages in journal files with a timestamp older than the specified timeframe. Values must be written with any of the following suffixes: <code>s</code>, <code>m</code>, <code>h</code>, <code>days</code> (or <code>d</code>), <code>months</code>, <code>weeks</code> (or <code>w</code>) and <code>years</code> (or <code>y</code>). For instance, to get rid of all messages in archived journal files that are older than 1 month:</p>
<div class="listingblock">
<div class="content">
<pre>root@debian:~# <strong>journalctl --vacuum-time=1months</strong>
Deleted archived journal /var/log/journal/7203088f20394d9c8b252b64a0171e08/system@27dd08376f71405a91794e632ede97ed-0000000000000001-00059475764d46d6.journal (16.0M).
Deleted archived journal /var/log/journal/7203088f20394d9c8b252b64a0171e08/user-1000@e7020d80d3af42f0bc31592b39647e9c-000000000000008e-00059479df9677c8.journal (8.0M).</pre>
</div>
</div>
</dd>
<dt class="hdlist1"><code>--vacuum-size=</code></dt>
<dd>
<p>This size-based option will delete archived journal files until they occupy a value below the specified size. Values must be written with any of the following suffixes: <code>K</code>, <code>M</code>, <code>G</code> or <code>T</code>. For instance, to eliminate archived journal files until they are below 100 Mebibits:</p>
<div class="listingblock">
<div class="content">
<pre>root@debian:~# <strong>journalctl --vacuum-size=100M</strong>
Vacuuming done, freed 0B of archived journals from /run/log/journal/9a32ba45ce44423a97d6397918de1fa5.</pre>
</div>
</div>
</dd>
<dt class="hdlist1"><code>--vacuum-files=</code></dt>
<dd>
<p>This option will take care that no more archived journal files than the specified number remain. The value is an integer. For instance, to limit the number of archived journal files to 10:</p>
<div class="listingblock">
<div class="content">
<pre>root@debian:~# <strong>journalctl --vacuum-files=10</strong>
Vacuuming done, freed 0B of archived journals from /run/log/journal/9a32ba45ce44423a97d6397918de1fa5.</pre>
</div>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Vacuuming only removes archived journal files. If you want to get rid of everything (including active journal files), you need to use a signal (<code>SIGUSR2</code>) that requests immediate rotation of the journal files with the <code>--rotate</code> option. Other important signals can be invoked with the following options:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>--flush</code> (<code>SIGUSR1)</code></dt>
<dd>
<p>It requests flushing of journal files from <code>/run/</code> to <code>/var/</code> to make the journal persistent. It requires that persistent logging is enabled and <code>/var/</code> is mounted.</p>
</dd>
<dt class="hdlist1"><code>--sync</code> (<code>SIGRTMIN+1</code>)</dt>
<dd>
<p>It is used to request that all unwritten log data be written to disk.</p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>To check the internal consistency of the journal file, use <code>journalctl</code> with the <code>--verify</code> option. You will see a progress bar as the check is done and any possible issues will be shown.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_retrieving_journal_data_from_a_rescue_system">Retrieving Journal Data from a Rescue System</h4>
<div class="paragraph">
<p>As a system administrator, you may find yourself in a situation where you need to access journal files on the hard drive of a faulty machine through a rescue system (a bootable CD or USB key containing a live Linux distribution).</p>
</div>
<div class="paragraph">
<p><code>journalctl</code> looks for the journal files in <code>/var/log/journal/&lt;machine-id&gt;/</code>. Because the machine IDs on the rescue and faulty systems will be different, you must use the following option:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>-D &lt;/path/to/dir&gt;</code>, <code>--directory=&lt;/path/to/dir&gt;</code></dt>
<dd>
<p>With this option, we specify a directory path where <code>journalctl</code> will search for journal files instead of the default runtime and system locations.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Thus, it is necessary that you mount the faulty system&#8217;s <code>rootfs</code> (<code>/dev/sda1</code>) on the rescue system&#8217;s filesystem and proceed to read the journal files like so:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>root@debian:~# <strong>journalctl -D /media/carol/faulty.system/var/log/journal/</strong>
-- Logs begin at Sun 2019-10-20 12:30:45 CEST, end at Sun 2019-10-20 12:32:57 CEST. --
oct 20 12:30:45 suse-server kernel: Linux version 4.12.14-lp151.28.16-default (geeko@buildhost) (...)
oct 20 12:30:45 suse-server kernel: Command line: BOOT_IMAGE=/boot/vmlinuz-4.12.14-lp151.28.16-default root=UUID=7570f67f-4a08-448e-aa09-168769cb9289 splash=>
oct 20 12:30:45 suse-server kernel: x86/fpu: Supporting XSAVE feature 0x001: 'x87 floating point registers'
oct 20 12:30:45 suse-server kernel: x86/fpu: Supporting XSAVE feature 0x002: 'SSE registers'
(...)</pre>
</div>
</div>
<div class="paragraph">
<p>Other options that can be useful in this scenario are:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>-m</code>, <code>--merge</code></dt>
<dd>
<p>It merges entries from all available journals under <code>/var/log/journal</code>, including remote ones.</p>
</dd>
<dt class="hdlist1"><code>--file</code></dt>
<dd>
<p>It will show the entries in a specific file, for example: <code>journalctl --file /var/log/journal/64319965bda04dfa81d3bc4e7919814a/user-1000.journal</code>.</p>
</dd>
<dt class="hdlist1"><code>--root</code></dt>
<dd>
<p>A directory path meaning the root directory is passed as an argument. <code>journalctl</code> will search there for journal files (e.g. <code>journalctl --root /faulty.system/</code>).</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>See <code>journalctl</code> man page for more information.</p>
</div>
</div>
<div class="sect3">
<h4 id="_forwarding_log_data_to_a_traditional_syslog_daemon">Forwarding Log Data to a Traditional <code>syslog</code> Daemon</h4>
<div class="paragraph">
<p>Log data from the journal can be made available to a traditional <code>syslog</code> daemon by:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Forwarding messages to the socket file <code>/run/systemd/journal/syslog</code> for <code>syslogd</code> to read. This facility is enabled with the <code>ForwardToSyslog=yes</code> option.</p>
</li>
<li>
<p>Having a <code>syslog</code> daemon behaving like <code>journalctl</code>, therefore reading log messages directly from the journal files. In this case, the relevant option is that of <code>Storage</code>; it must have a value other than <code>none</code>.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Likewise, you can forward log messages to other destinations with the following options: <code>ForwardToKMsg</code> (kernel log buffer&#8201;&#8212;&#8201;<code>kmsg</code>), <code>ForwardToConsole</code> (the system console) or <code>ForwardToWall</code> (all logged-in users via <code>wall</code>). For more information, consult the man page for <code>journald.conf</code>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec.108.2_02-GE">Guided Exercises</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Assuming you are <code>root</code>, complete the table with the appropriate <code>journalctl</code> command:</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Purpose</th>
<th class="tableblock halign-left valign-top">Command</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Print kernel entries</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Print messages from the second boot starting at beginning of journal</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Print messages from the second boot starting at end of journal</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Print most recent log messages and keep watching for new ones</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Print only new messages since now, and update the output continuously</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Print messages from the previous boot with a priority of <code>warning</code> and in reverse order</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>The behaviour of the journal daemon concerning storage is mostly controlled by the value of the <code>Storage</code> option in <code>/etc/systemd/journald.conf</code>. Indicate what behaviour is related to what value in the following table:</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Behaviour</th>
<th class="tableblock halign-left valign-top"><code>Storage=auto</code></th>
<th class="tableblock halign-left valign-top"><code>Storage=none</code></th>
<th class="tableblock halign-left valign-top"><code>Storage=persistent</code></th>
<th class="tableblock halign-left valign-top"><code>Storage=volatile</code></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Log data is thrown away but forwarding is possible.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Once the system has booted up, log data will be stored under <code>/var/log/journal</code>. If not already present, the directory will be created.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Once the system has booted up, log data will be stored under <code>/var/log/journal</code>. If not already present, the directory will not be created.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Log data will be stored under <code>/var/run/journal</code> but will not survive reboots.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>As you learned, the journal can be manually vacuumed based on time, size and number of files. Complete the following tasks using <code>journalctl</code> and the appropriate options:</p>
<div class="ulist">
<ul>
<li>
<p>Check how much disk space is taken up by journal files:</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Cut down on the quantity of space reserved for archived journal files and set it to 200MiB:</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Check on disk space again and explain the results:</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec.108.2_02-EE">Explorational Exercises</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>What options should you modify in <code>/etc/systemd/journald.conf</code> so that messages are forwarded to <code>/dev/tty5</code>? What values should the options have?</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Provide the correct <code>journalctl</code> filter to print the following:</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Purpose</th>
<th class="tableblock halign-left valign-top">Filter + Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Print messages belonging to a specific user</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Print messages from a host named <code>debian</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Print messages belonging to a specific group</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Print messages belongin to <code>root</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Based on the executable path, print <code>sudo</code> messages</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Based on the command name, print <code>sudo</code> messages</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>When filtering by priority, logs with a higher priority than indicated will also be included in the listing; for instance <code>journalctl -p err</code> will print <em>error</em>, <em>critical</em>, <em>alert</em> and <em>emergency</em> messages. However, you can have <code>journalctl</code> show only a specific range. What command would you use to have <code>journalctl</code> print only messages in the <em>warning</em>, <em>error</em> and <em>critical</em> priority levels?</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Priority levels can also be specified numerically. Rewrite the command in the previous exercise using the numeric representation of priority levels:</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec.108.2_02-SU">Summary</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this lesson you learned:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The advantages of using <code>systemd</code> as a system and service manager.</p>
</li>
<li>
<p>The basics of <code>systemd</code> units and targets.</p>
</li>
<li>
<p>Where <code>systemd-journald</code> gets logging data from.</p>
</li>
<li>
<p>The options you can pass <code>systemctl</code> to control <code>systemd-journald</code>: <code>start</code>, <code>status</code>, <code>restart</code> and <code>stop</code>.</p>
</li>
<li>
<p>Where the journal&#8217;s configuration file is located&#8201;&#8212;&#8201;<code>/etc/systemd/journald.conf</code>&#8201;&#8212;&#8201;and its main options.</p>
</li>
<li>
<p>How to query the journal in a general way and for specific data by using filters.</p>
</li>
<li>
<p>How to navigate and search through the journal.</p>
</li>
<li>
<p>How to deal with storage of journal files: in memory vs. on disk.</p>
</li>
<li>
<p>How to disable journaling altogether.</p>
</li>
<li>
<p>How to check the disk space taken up by the journal, enforce size limits on stored journal files and clean archived journal files manually (<em>vacumming</em>).</p>
</li>
<li>
<p>How to retrieve journal data from a rescue system.</p>
</li>
<li>
<p>How to forward log data to a traditional <code>syslog</code> daemon.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Commands used in this lesson:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>systemctl</code></dt>
<dd>
<p>Control the <code>systemd</code> system and service manager.</p>
</dd>
<dt class="hdlist1"><code>journalctl</code></dt>
<dd>
<p>Query the <code>systemd</code> journal.</p>
</dd>
<dt class="hdlist1"><code>ls</code></dt>
<dd>
<p>List directory contents.</p>
</dd>
<dt class="hdlist1"><code>less</code></dt>
<dd>
<p>View file contents.</p>
</dd>
<dt class="hdlist1"><code>mkdir</code></dt>
<dd>
<p>Make directories.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec.108.2_02-AGE">Answers to Guided Exercises</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Assuming you are <code>root</code>, complete the table with the appropriate <code>journalctl</code> command:</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Purpose</th>
<th class="tableblock halign-left valign-top">Command</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Print kernel entries</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>journalctl -k</code> or <code>journalctl --dmesg</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Print messages from the second boot starting at beginning of journal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>journalctl -b 2</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Print messages from the second boot starting at end of journal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>journalctl -b -2 -r</code> or <code>journalctl -r -b -2</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Print most recent log messages and keep watching for new ones</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>journalctl -f</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Print only new messages since now, and update the output continuously</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>journalctl --since "now" -f</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Print messages from the previous boot with a priority of <code>warning</code> and in reverse order</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>journalctl -b -1 -p warning -r</code></p></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>The behaviour of the journal daemon concerning storage is mostly controlled by the value of the <code>Storage</code> option in <code>/etc/systemd/journald.conf</code>. Indicate what behaviour is related to what value in the following table:</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Behaviour</th>
<th class="tableblock halign-left valign-top"><code>Storage=auto</code></th>
<th class="tableblock halign-left valign-top"><code>Storage=none</code></th>
<th class="tableblock halign-left valign-top"><code>Storage=persistent</code></th>
<th class="tableblock halign-left valign-top"><code>Storage=volatile</code></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Log data is thrown away but forwarding is possible</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Once the system has booted up, log data will be stored under <code>/var/log/journal</code>. If not already present, the directory will be created</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Once the system has booted up, log data will be stored under <code>/var/log/journal</code>. If not already present, the directory will not be created</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Log data will be stored under <code>/var/run/journal</code> but will not survive reboots</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>As you learned, the journal can be manually vacuumed based on time, size and number of files. Complete the following tasks using <code>journalctl</code> and the appropriate options:</p>
<div class="ulist">
<ul>
<li>
<p>Check how much disk space is taken up by journal files:</p>
<div class="listingblock">
<div class="content">
<pre>journalctl --disk-usage</pre>
</div>
</div>
</li>
<li>
<p>Cut down on the quantity of space reserved for archived journal files and set it to 200MiB:</p>
<div class="listingblock">
<div class="content">
<pre>journalctl --vacuum-size=200M</pre>
</div>
</div>
</li>
<li>
<p>Check on disk space again and explain the results:</p>
<div class="listingblock">
<div class="content">
<pre>journalctl --disk-usage</pre>
</div>
</div>
<div class="paragraph">
<p>There is no correlation because <code>--disk-usage</code> shows space occupied by both active and archived journal files whereas <code>--vacuum-size</code> only applies to archived files.</p>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec.108.2_02-AEE">Answers to Explorational Exercises</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>What options should you modify in <code>/etc/systemd/journald.conf</code> so that messages are forwarded to <code>/dev/tty5</code>? What values should the options have?</p>
<div class="listingblock">
<div class="content">
<pre>ForwardToConsole=yes
TTYPath=/dev/tty5</pre>
</div>
</div>
</li>
<li>
<p>Provide the correct <code>journalctl</code> filter to print the following:</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Purpose</th>
<th class="tableblock halign-left valign-top">Filter + Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Print messages belonging to a specific user</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>_ID=&lt;user-id&gt;</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Print messages from a host named <code>debian</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>_HOSTNAME=debian</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Print messages belonging to a specific group</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>_UID=&lt;group-id&gt;</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Print messages belongin to <code>root</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>_UID=0</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Based on the executable path, print <code>sudo</code> messages</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>_EXE=/usr/bin/sudo</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Based on the command name, print <code>sudo</code> messages</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>_COMM=sudo</code></p></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>When filtering by priority, logs with a higher priority than indicated will also be included in the listing; for instance <code>journalctl -p err</code> will print <em>error</em>, <em>critical</em>, <em>alert</em> and <em>emergency</em> messages. However, you can have <code>journalctl</code> show only a specific range. What command would you use to have <code>journalctl</code> print only messages in the <em>warning</em>, <em>error</em> and <em>critical</em> priority levels?</p>
<div class="listingblock">
<div class="content">
<pre>journalctl -p warning..crit</pre>
</div>
</div>
</li>
<li>
<p>Priority levels can also be specified numerically. Rewrite the command in the previous exercise using the numeric representation of priority levels:</p>
<div class="listingblock">
<div class="content">
<pre>journalctl -p 4..2</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>

        
      </section>
    </div>

    <aside class="lesson__license smallprint">
  <div class="container">
    
    <p>© 2020 Linux Professional Insitute Inc. All rights reserved. Visit the Learning Materials website: https://learning.lpi.org<br />
       This work is licensed under the Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License.</p>
  </div>
</aside>


    
    
    <aside class="lesson__teaser teaser">
      <div class="container teaser__container">
        <h2 class="label">Next Lesson</h2>
        <p class="headline teaser__headline">108.3 Mail Transfer Agent (MTA) basics (108.3 Lesson 1)</p>

        <div class="button-group">
            <a href="../../108.3/108.3_01/index.html" class="button -primary">Read next lesson</a>
        </div>
      </div>
    </aside>
    
  </div>
</div>

<div class="lesson-progress">
  <div class="lesson-progress__current"></div>
</div>

      </main>
    </td></tr></tbody>
    <tfoot><tr><td class="print__cell">
      <div class="print__space -footer"></div>
    </td></tr></tfoot>
  </table>

  <table class="print-footer">
  <tr class="print-footer__body">
    <td class="print-footer__cell -image">
      <img src="index.html" alt="" class="print-footer__image">
    </td>
    <td class="print-footer__cell -center">
      <p>© 2020 Linux Professional Insitute Inc. All rights reserved. Visit the Learning Materials website: https://learning.lpi.org<br />
         This work is licensed under the Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License.</p>
    </td>
    <td class="print-footer__cell -image">
      <img src="index.html" alt="" class="print-footer__license">
    </td>
  </tr>
</table>

<footer class="footer">
  <div class="container footer__container columns">
    <div class="column">
      <h2>LPI is a non-profit organization.</h2>
      <p>Linux Professional Institute (LPI) is the global certification standard and career support organization for open source professionals. With more than 200,000 certification holders, it&#39;s the world’s first and largest vendor-neutral Linux and open source certification body. LPI has certified professionals in over 180 countries, delivers exams in multiple languages, and has hundreds of training partners.</p>
      <p>Our purpose is to enable economic and creative opportunities for everybody by making open source knowledge and skills certification universally accessible.</p>
    </div>

    <div class="column">
      <ul class="footer__social social">
        <li class="social__item -linkedin">
          <a class="social__link" href="https://www.linkedin.com/company/35136" target="_blank" rel="noreferrer">
            <svg version="1.1"  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 viewBox="0 0 42.3 36" enable-background="new 0 0 42.3 36" xml:space="preserve">
<g>
	<g>
		<g>
			<path fill="#010202" d="M33.3,0H2.7C1.2,0,0,1.2,0,2.6v30.8C0,34.8,1.2,36,2.7,36h30.7c1.5,0,2.7-1.2,2.7-2.6V2.6
				C36,1.2,34.8,0,33.3,0z M10.7,30.7H5.3V13.5h5.3V30.7z M8,11.1c-1.7,0-3.1-1.4-3.1-3.1C4.9,6.3,6.3,5,8,5c1.7,0,3.1,1.4,3.1,3.1
				C11.1,9.8,9.7,11.1,8,11.1z M30.7,30.7h-5.3v-8.4c0-2,0-4.6-2.8-4.6c-2.8,0-3.2,2.2-3.2,4.4v8.5H14V13.5h5.1v2.3h0.1
				c0.7-1.4,2.5-2.8,5.1-2.8c5.4,0,6.4,3.6,6.4,8.2V30.7z"/>
		</g>
	</g>
	<g>
		<polygon fill="#010202" points="37.5,28.5 38.2,28.5 38.2,30.7 38.6,30.7 38.6,28.5 39.3,28.5 39.3,28.1 37.5,28.1 		"/>
		<polygon fill="#010202" points="41.7,28.1 41,30 40.3,28.1 39.7,28.1 39.7,30.7 40.1,30.7 40.1,28.8 40.9,30.7 41.1,30.7
			41.9,28.8 41.9,30.7 42.3,30.7 42.3,28.1 		"/>
	</g>
</g>
</svg>

            <span class="social__link__text">LinkedIn</span>
          </a>
        </li>
        <li class="social__item -facebook">
          <a class="social__link" href="https://www.facebook.com/LPIConnect" target="_blank" rel="noreferrer">
            <svg version="1.1"  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 viewBox="0 0 36 36" enable-background="new 0 0 36 36" xml:space="preserve">
<title>flogo-RGB-HEX-Blk-58</title>
<path d="M34,0H2C0.9,0,0,0.9,0,2v32c0,1.1,0.9,2,2,2h17.3V22.1h-4.7v-5.4h4.7v-4c0-4.6,2.8-7.2,7-7.2c0,0,0,0,0,0c0,0,0,0,0,0
	c0.4,0,0.9,0,1.3,0c0.3,0,0.5,0,0.8,0c0.7,0,1.4,0.1,2.1,0.2v4.9v0h-2.9c-0.3,0-0.5,0-0.8,0c-1.6,0.2-1.9,1.2-1.9,2.6v3.5h5.4
	l-0.7,5.4h0l0,0h-4.7V36H34c1.1,0,2-0.9,2-2V2C36,0.9,35.1,0,34,0z"/>
</svg>

            <span class="social__link__text">Facebook</span>
          </a>
        </li>
        <li class="social__item -twitter">
          <a class="social__link" href="https://twitter.com/lpiconnect" target="_blank" rel="noreferrer">
            <svg version="1.1" id="Logo_FIXED" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 viewBox="0 0 36 36" enable-background="new 0 0 36 36" xml:space="preserve">
<path d="M11.3,32.6c13.6,0,21-11.3,21-21c0-0.3,0-0.6,0-1c1.4-1,2.7-2.3,3.7-3.8c-1.3,0.6-2.8,1-4.2,1.2c1.5-0.9,2.7-2.4,3.2-4.1
	c-1.4,0.9-3,1.5-4.7,1.8c-2.8-3-7.5-3.1-10.5-0.3c-1.9,1.8-2.7,4.5-2.1,7.1C11.8,12.1,6.3,9.3,2.5,4.7c-2,3.4-1,7.7,2.3,9.9
	c-1.2,0-2.3-0.4-3.4-0.9c0,0,0,0.1,0,0.1c0,3.5,2.5,6.5,5.9,7.2c-1.1,0.3-2.2,0.3-3.3,0.1c1,3,3.7,5.1,6.9,5.1
	c-2.6,2.1-5.8,3.2-9.2,3.2c-0.6,0-1.2,0-1.8-0.1C3.4,31.5,7.3,32.6,11.3,32.6"/>
</svg>

            <span class="social__link__text">Twitter</span>
          </a>
        </li>
      </ul>
    </div>
  </div>

  <div class="container footer__secondary">
    <ul class="footer__links">
      <li><a href="https://www.lpi.org/about-lpi/contact-us" class="footer__link" target="_blank" rel="noreferrer">Contact Us</a></li>
      <li><a href="https://www.lpi.org/privacy-and-cookie-policy" class="footer__link" target="_blank" rel="noreferrer">Privacy and Cookie Policy</a></li>
    </ul>

    <p><strong>Spot a mistake or want to help improve this page? Please <a href="https://www.lpi.org/about-lpi/contact-us" target="_blank" rel="noreferrer">let us know</a>.</strong></p>
    <p>© Copyright 1999-2020 The Linux Professional Institute Inc. All rights reserved.</p>
  </div>
</footer>


  
  
  

  <script src="https://unpkg.com/swiper/swiper-bundle.min.js" type="application/javascript"></script>
  <script src="../../../../../../js/bundle.js"></script>
</body>
</html>
