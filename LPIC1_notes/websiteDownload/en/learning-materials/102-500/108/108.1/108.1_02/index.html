

<!DOCTYPE html>
<html lang="en-us">
<head>


  
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-WMC4KTP');</script>
  



  <meta charset="utf-8"/>
  <title>108.1 Lesson 2</title>

  <link rel="stylesheet" href="../../../../../../scss/styles.min.css">

  
  <link rel="apple-touch-icon" sizes="152x152" href="https://learning.lpi.org/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="https://learning.lpi.org/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="https://learning.lpi.org/favicon-16x16.png">
  <link rel="manifest" href="https://learning.lpi.org/site.webmanifest">
  <link rel="mask-icon" href="https://learning.lpi.org/safari-pinned-tab.svg" color="#fbc000">
  <meta name="msapplication-TileColor" content="#ffc40d">
  <meta name="theme-color" content="#ffffff">

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body class="page">



  
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WMC4KTP"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  



  

<header class="header">
  <span class="header__nav -clone"></span>

  <a href="https://learning.lpi.org/" class="header__logo-link">
    <img class="header__logo" src="../../../../../../lpi-learning-logo.svg" alt="Linux Professional Institute Learning Logo.">
  </a>

  <nav class="header__nav nav">
    <a href="index.html#content" class="nav__skip">Skip to main content</a>

    <button class="nav__button" aria-hidden="true">
      <span></span>
      <span></span>
      <span></span>
    </button>

    <div class="nav__menus">
      <ul class="nav__menu">
        
          <li class="nav__item
              
              
              ">


            
              <a href="https://learning.lpi.org/en/" class="nav__link">Home</a>
            


            
          </li>
        
          <li class="nav__item
              -has-submenu
              -is-active
              ">


            
              <button class="nav__link" type="button">Learning Materials</button>
            


            
              <ul class="nav__menu -submenu">
                
                  <li class="nav__item
                      ">
                    <a href="https://learning.lpi.org/en/learning-materials/all-materials/" class="nav__link
                      ">All Resources</a>
                  </li>
                
                  <li class="nav__item
                      ">
                    <a href="https://learning.lpi.org/en/learning-materials/learning-materials/" class="nav__link
                      ">LPI Learning Materials</a>
                  </li>
                
                  <li class="nav__item
                      ">
                    <a href="https://learning.lpi.org/en/learning-materials/become-contributor/" class="nav__link
                      ">Become a Contributor</a>
                  </li>
                
              </ul>
            
          </li>
        
          <li class="nav__item
              -has-submenu
              
              ">


            
              <button class="nav__link" type="button">Publishing Partners</button>
            


            
              <ul class="nav__menu -submenu">
                
                  <li class="nav__item
                      ">
                    <a href="https://learning.lpi.org/en/lpi-publishing-partner/lpp-partners/" class="nav__link
                      ">Publishing Partners</a>
                  </li>
                
                  <li class="nav__item
                      ">
                    <a href="https://learning.lpi.org/en/lpi-publishing-partner/become-lpp/" class="nav__link
                      ">Become a Publishing Partner</a>
                  </li>
                
              </ul>
            
          </li>
        
          <li class="nav__item
              -has-submenu
              
              ">


            
              <button class="nav__link" type="button">About</button>
            


            
              <ul class="nav__menu -submenu">
                
                  <li class="nav__item
                      ">
                    <a href="https://learning.lpi.org/en/about/about/" class="nav__link
                      ">About</a>
                  </li>
                
                  <li class="nav__item
                      ">
                    <a href="https://learning.lpi.org/en/about/faq/" class="nav__link
                      ">FAQ</a>
                  </li>
                
                  <li class="nav__item
                      ">
                    <a href="https://learning.lpi.org/en/about/lm-contributors/" class="nav__link
                      ">Contributors</a>
                  </li>
                
                  <li class="nav__item
                      ">
                    <a href="https://learning.lpi.org/en/about/roadmap/" class="nav__link
                      ">Roadmap</a>
                  </li>
                
                  <li class="nav__item
                      ">
                    <a href="https://learning.lpi.org/en/about/contact/" class="nav__link
                      ">Contact</a>
                  </li>
                
              </ul>
            
          </li>
        
      </ul>

      <ul class="nav__menu -secondary">
        <li class="nav__item -lang-select">
        
<select name="language-picker" id="lang-select" class="lang-select" title='Language' aria-label='Language'>
  
    <option value="es"
      >Español</option>
  
    <option value="en"
      selected>English</option>
  
    <option value="pt"
      >Português</option>
  
</select>


        </li>
        <li class="nav__item -external">
        <a href="https://lpi.org/" class="nav__link" target="_blank" rel="noreferrer noopener">LPI.org</a>
        </li>
      </ul>
    </div>
  </nav>
</header>


  <table class="print-header">
    <tr class="print-header__body">
      <td class="print-header__cell">108.1 Lesson 2</td>
      <td class="print-header__cell -pagenumber"></td>
    </tr>
  </table>

  <table class="print">
    <thead><tr><td class="print__cell">
      <div class="print__space -header"></div>
    </td></tr></thead>
    <tbody><tr><td class="print__cell">
      <main id="content">




<div class="lesson page-content">
  <div class="lesson__hierarchy page-content__hierarchy">
    <nav class="hierarchy">
  

  <div class="hierarchy__container">
     
      <dl class="hierarchy__section">
        <dt class="hierarchy__heading">Topic 105: Shells and Shell Scripting
          <button class="hierarchy__toggle-button" aria-hidden="true">
            <span class="hierarchy__toggle-button__icon"></span>
          </button>
        </dt>

        
        <dd class="hierarchy__item">
          <a href="../../../105/105.1/index.html" class="hierarchy__link">105.1 Customize and use the shell environment</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../105/105.1/105.1_01/index.html" class="hierarchy__link">105.1 Lesson 1</a>
            </li>
            
            <li class="hierarchy__item">
              <a href="../../../105/105.1/105.1_02/index.html" class="hierarchy__link">105.1 Lesson 2</a>
            </li>
            
            <li class="hierarchy__item">
              <a href="../../../105/105.1/105.1_03/index.html" class="hierarchy__link">105.1 Lesson 3</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../../105/105.2/index.html" class="hierarchy__link">105.2 Customize or write simple scripts</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../105/105.2/105.2_01/index.html" class="hierarchy__link">105.2 Lesson 1</a>
            </li>
            
            <li class="hierarchy__item">
              <a href="../../../105/105.2/105.2_02/index.html" class="hierarchy__link">105.2 Lesson 2</a>
            </li>
            
          </ul>
        </dd>
        
      </dl>
      
      <dl class="hierarchy__section">
        <dt class="hierarchy__heading">Topic 106: User Interfaces and Desktops
          <button class="hierarchy__toggle-button" aria-hidden="true">
            <span class="hierarchy__toggle-button__icon"></span>
          </button>
        </dt>

        
        <dd class="hierarchy__item">
          <a href="../../../106/106.1/index.html" class="hierarchy__link">106.1 Install and configure X11</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../106/106.1/106.1_01/index.html" class="hierarchy__link">106.1 Lesson 1</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../../106/106.2/index.html" class="hierarchy__link">106.2 Graphical Desktops</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../106/106.2/106.2_01/index.html" class="hierarchy__link">106.2 Lesson 1</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../../106/106.3/index.html" class="hierarchy__link">106.3 Accessibility</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../106/106.3/106.3_01/index.html" class="hierarchy__link">106.3 Lesson 1</a>
            </li>
            
          </ul>
        </dd>
        
      </dl>
      
      <dl class="hierarchy__section">
        <dt class="hierarchy__heading">Topic 107: Administrative Tasks
          <button class="hierarchy__toggle-button" aria-hidden="true">
            <span class="hierarchy__toggle-button__icon"></span>
          </button>
        </dt>

        
        <dd class="hierarchy__item">
          <a href="../../../107/107.1/index.html" class="hierarchy__link">107.1 Manage user and group accounts and related system files</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../107/107.1/107.1_01/index.html" class="hierarchy__link">107.1 Lesson 1</a>
            </li>
            
            <li class="hierarchy__item">
              <a href="../../../107/107.1/107.1_02/index.html" class="hierarchy__link">107.1 Lesson 2</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../../107/107.2/index.html" class="hierarchy__link">107.2 Automate system administration tasks by scheduling jobs</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../107/107.2/107.2_01/index.html" class="hierarchy__link">107.2 Lesson 1</a>
            </li>
            
            <li class="hierarchy__item">
              <a href="../../../107/107.2/107.2_02/index.html" class="hierarchy__link">107.2 Lesson 2</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../../107/107.3/index.html" class="hierarchy__link">107.3 Localisation and internationalisation</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../107/107.3/107.3_01/index.html" class="hierarchy__link">107.3 Lesson 1</a>
            </li>
            
          </ul>
        </dd>
        
      </dl>
      
      <dl class="hierarchy__section -is-active">
        <dt class="hierarchy__heading">Topic 108: Essential System Services
          <button class="hierarchy__toggle-button" aria-hidden="true">
            <span class="hierarchy__toggle-button__icon"></span>
          </button>
        </dt>

        
        <dd class="hierarchy__item">
          <a href="../index.html" class="hierarchy__link">108.1 Maintain system time</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../108.1_01/index.html" class="hierarchy__link">108.1 Lesson 1</a>
            </li>
            
            <li class="hierarchy__item">
              <a href="index.html" class="hierarchy__link">108.1 Lesson 2</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../108.2/index.html" class="hierarchy__link">108.2 System logging</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../108.2/108.2_01/index.html" class="hierarchy__link">108.2 Lesson 1</a>
            </li>
            
            <li class="hierarchy__item">
              <a href="../../108.2/108.2_02/index.html" class="hierarchy__link">108.2 Lesson 2</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../108.3/index.html" class="hierarchy__link">108.3 Mail Transfer Agent (MTA) basics</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../108.3/108.3_01/index.html" class="hierarchy__link">108.3 Lesson 1</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../108.4/index.html" class="hierarchy__link">108.4 Manage printers and printing</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../108.4/108.4_01/index.html" class="hierarchy__link">108.4 Lesson 1</a>
            </li>
            
          </ul>
        </dd>
        
      </dl>
      
      <dl class="hierarchy__section">
        <dt class="hierarchy__heading">Topic 109: Networking Fundamentals
          <button class="hierarchy__toggle-button" aria-hidden="true">
            <span class="hierarchy__toggle-button__icon"></span>
          </button>
        </dt>

        
        <dd class="hierarchy__item">
          <a href="../../../109/109.1/index.html" class="hierarchy__link">109.1 Fundamentals of internet protocols</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../109/109.1/109.1_01/index.html" class="hierarchy__link">109.1 Lesson 1</a>
            </li>
            
            <li class="hierarchy__item">
              <a href="../../../109/109.1/109.1_02/index.html" class="hierarchy__link">109.1 Lesson 2</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../../109/109.2/index.html" class="hierarchy__link">109.2 Persistent network configuration</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../109/109.2/109.2_01/index.html" class="hierarchy__link">109.2 Lesson 1</a>
            </li>
            
            <li class="hierarchy__item">
              <a href="../../../109/109.2/109.2_02/index.html" class="hierarchy__link">109.2 Lesson 2</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../../109/109.3/index.html" class="hierarchy__link">109.3 Basic network troubleshooting</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../109/109.3/109.3_01/index.html" class="hierarchy__link">109.3 Lesson 1</a>
            </li>
            
            <li class="hierarchy__item">
              <a href="../../../109/109.3/109.3_02/index.html" class="hierarchy__link">109.3 Lesson 2</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../../109/109.4/index.html" class="hierarchy__link">109.4 Configure client side DNS</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../109/109.4/109.4_01/index.html" class="hierarchy__link">109.4 Lesson 1</a>
            </li>
            
          </ul>
        </dd>
        
      </dl>
      
      <dl class="hierarchy__section">
        <dt class="hierarchy__heading">Topic 110: Security
          <button class="hierarchy__toggle-button" aria-hidden="true">
            <span class="hierarchy__toggle-button__icon"></span>
          </button>
        </dt>

        
        <dd class="hierarchy__item">
          <a href="../../../110/110.1/index.html" class="hierarchy__link">110.1 Perform security administration tasks</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../110/110.1/110.1_01/index.html" class="hierarchy__link">110.1 Lesson 1</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../../110/110.2/index.html" class="hierarchy__link">110.2 Setup host security</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../110/110.2/110.2_01/index.html" class="hierarchy__link">110.2 Lesson 1</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../../110/110.3/index.html" class="hierarchy__link">110.3 Securing data with encryption</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../110/110.3/110.3_01/index.html" class="hierarchy__link">110.3 Lesson 1</a>
            </li>
            
            <li class="hierarchy__item">
              <a href="../../../110/110.3/110.3_02/index.html" class="hierarchy__link">110.3 Lesson 2</a>
            </li>
            
          </ul>
        </dd>
        
      </dl>
      
  </div>
</nav>

  </div>



  <div class="lesson__container page-content__container">
    <div class="container">
      <nav class="lesson__breadcrumb breadcrumb">
        <ol class="breadcrumb__list">
          
          <li class="breadcrumb__item">
            <a href="../../index.html" class="breadcrumb__link">Topic 108: Essential System Services</a>
          </li>
          
          
          <li class="breadcrumb__item">
            <a href="../index.html" class="breadcrumb__link">108.1 Maintain system time</a>
          </li>
          
          <li class="breadcrumb__item">
            <a href="index.html" class="breadcrumb__link">108.1 Lesson 2</a>
          </li>
        </ol>
      </nav>

      
      <section class="lesson__content">
        
          <h1>108.1 Lesson 2</h1>
          <div id="preamble">
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch fronttable">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Certificate:</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">LPIC-1 (102)</p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Version:</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.0</p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Topic:</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">108 Essential System Services</p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Objective:</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">108.1 Maintain system time</p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Lesson:</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">2 of 2</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="sec.108.1_02-IN">Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>While personal computers are able to keep reasonably accurate time on their own, production computing and network environments requires that very precise time be kept. The most accurate time is measured by <em>reference clocks</em>, which are typically atomic clocks. The modern world has devised a system where all internet-connected computer systems can be synchronised to these reference clocks using what is known as the <em>Network Time Protocol</em> (NTP). A computer system with NTP will be able to synchronise their system clocks to the time provided by reference clocks. If system time and the time as measured on these servers are different, then the computer will speed up or slow down its internal system time incrementally until system time matches network time.</p>
</div>
<div class="paragraph">
<p>NTP uses a hierarchical structure to disseminate time. Reference clocks are connected to servers at the top of the hierarchy. These servers are <em>Stratum 1</em> machines and typically are not accessible to the public. Stratum 1 machines are however accessible to <em>Stratum 2</em> machines, which are accessible to <em>Stratum 3</em> machines and so on. Stratum 2 servers are accessible to the public, as are any machines lower in the hierarchy. When setting up NTP for a large network, it is good practice to have a small number of computers connect to Stratum 2+ servers, and then have those machines provide NTP to all other machines. In this way, demands on Stratum 2 machines can be minimized.</p>
</div>
<div class="paragraph">
<p>There are some important terms that come up when discussing NTP. Some of these terms are used in the commands we will use to track the status of NTP on our machines:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Offset</dt>
<dd>
<p>This refers to the absolute difference between system time and NTP time. For example, if the system clock reads 12:00:02 and NTP time reads 11:59:58, then the offset between the two clocks is four seconds.</p>
</dd>
<dt class="hdlist1">Step</dt>
<dd>
<p>If the time offset between the NTP provider and a consumer is greater than 128ms, then NTP will perform a single significant change to system time, as opposed to slowing or speeding the system time. This is called <em>stepping</em>.</p>
</dd>
<dt class="hdlist1">Slew</dt>
<dd>
<p>Slewing refers to the changes made to system time when the offset between system time and NTP is less than 128ms. If this is the case, then changes will be made gradually. This is referred to as <em>slewing</em>.</p>
</dd>
<dt class="hdlist1">Insane Time</dt>
<dd>
<p>If the offset between system time and NTP time is greater than 17 minutes, then the system time is considered <em>insane</em> and the NTP daemon will not introduce any changes to system time. Special steps will have to be taken to bring system time within 17 minutes of proper time.</p>
</dd>
<dt class="hdlist1">Drift</dt>
<dd>
<p>Drift refers to the phenomenon where two clocks become out of sync over time. Essentially if two clocks are initially synchronised but then become out of sync over time, then clock drift is occurring.</p>
</dd>
<dt class="hdlist1">Jitter</dt>
<dd>
<p>Jitter refers to the amount of drift since the last time a clock was queried. So if the last NTP sync occurred 17 minutes ago, and the offset between the NTP provider and consumer is 3 milliseconds, then 3 milliseconds is the jitter.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Now we will discuss some of the specific ways that Linux implements NTP.</p>
</div>
<div class="sect2">
<h3 id="_timedatectl">timedatectl</h3>
<div class="paragraph">
<p>If your Linux distribution uses <code>timedatectl</code>, then by default it implements an <em>SNTP</em> client rather than a full NTP implementation. This is a less complex implementation of network time and means that your machine will not serve NTP to other connected computers.</p>
</div>
<div class="paragraph">
<p>In this case, SNTP will not work unless the <code>timesyncd</code> service is running. As with all systemd services, we can verify that it is running with:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>systemctl status systemd-timesyncd</strong>
● systemd-timesyncd.service - Network Time Synchronization
   Loaded: loaded (/lib/systemd/system/systemd-timesyncd.service; enabled; vendor preset: enabled)
  Drop-In: /lib/systemd/system/systemd-timesyncd.service.d
           └─disable-with-time-daemon.conf
   Active: active (running) since Thu 2020-01-09 21:01:50 EST; 2 weeks 1 days ago
     Docs: man:systemd-timesyncd.service(8)
 Main PID: 1032 (systemd-timesyn)
   Status: "Synchronized to time server for the first time 91.189.89.198:123 (ntp.ubuntu.com)."
    Tasks: 2 (limit: 4915)
   Memory: 3.0M
   CGroup: /system.slice/systemd-timesyncd.service
           └─1032 /lib/systemd/systemd-timesyncd

Jan 11 13:06:18 NeoMex systemd-timesyncd[1032]: Synchronized to time server for the first time 91.189.91.157:123 (ntp.ubuntu.com).
...</pre>
</div>
</div>
<div class="paragraph">
<p>The status of <code>timedatectl</code> SNTP synchronisation can be verified using <code>show-timesync</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>timedatectl show-timesync --all</strong>
LinkNTPServers=
SystemNTPServers=
FallbackNTPServers=ntp.ubuntu.com
ServerName=ntp.ubuntu.com
ServerAddress=91.189.89.198
RootDistanceMaxUSec=5s
PollIntervalMinUSec=32s
PollIntervalMaxUSec=34min 8s
PollIntervalUSec=34min 8s
NTPMessage={ Leap=0, Version=4, Mode=4, Stratum=2, Precision=-23, RootDelay=8.270ms, RootDispersion=18.432ms, Reference=91EECB0E, OriginateTimestamp=Sat 2020-01-25 18:35:49 EST, ReceiveTimestamp=Sat 2020-01-25 18:35:49 EST, TransmitTimestamp=Sat 2020-01-25 18:35:49 EST, DestinationTimestamp=Sat 2020-01-25 18:35:49 EST, Ignored=no PacketCount=263, Jitter=2.751ms }
Frequency=-211336</pre>
</div>
</div>
<div class="paragraph">
<p>This configuration might be adequate for most situations, but as noted before it will be insufficient if one is hoping to synchronise several clients in a network. In this case it is recommended to install a full NTP client.</p>
</div>
</div>
<div class="sect2">
<h3 id="_ntp_daemon">NTP Daemon</h3>
<div class="paragraph">
<p>The system time is compared to network time on a regular schedule. For this to work we must have a <em>daemon</em> running in the background. For many Linux systems, the name of this daemon is <code>ntpd</code>. <code>ntpd</code> will allow a machine to not only be a <em>time consumer</em> (that is, able to sync its own clock from an outside source), but also to <em>provide</em> time to other machines.</p>
</div>
<div class="paragraph">
<p>Let us assume that our computer is systemd-based and it uses <code>systemctl</code> to control daemons. We will install <code>ntp</code> packages using the appropriate package manager and then ensure that our <code>ntpd</code> daemon is running by checking its status:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>systemctl status ntpd</strong>

●  ntpd.service - Network Time Service
   Loaded: loaded (/usr/lib/systemd/system/ntpd.service; enabled; vendor preset: disabled)
   Active: active (running) since Fri 2019-12-06 03:27:21 EST; 7h ago
  Process: 856 ExecStart=/usr/sbin/ntpd -u ntp:ntp $OPTIONS (code=exited, status=0/SUCCESS)
 Main PID: 867 (ntpd)
   CGroup: /system.slice/ntpd.service
           `-867 /usr/sbin/ntpd -u ntp:ntp -g</pre>
</div>
</div>
<div class="paragraph">
<p>In some cases it might be required to both start and enable <code>ntpd</code>. On most Linux machines this is accomplished with:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># <strong>systemctl enable ntpd &amp;&amp; systemctl start ntpd</strong></pre>
</div>
</div>
<div class="paragraph">
<p>NTP queries happen on TCP Port 123. If NTP fails, ensure that this port is open and listening.</p>
</div>
</div>
<div class="sect2">
<h3 id="_ntp_configuration">NTP Configuration</h3>
<div class="paragraph">
<p>NTP is able to poll several sources and to select the best candidates to use for setting system time. If a network connection is lost, NTP uses previous adjustments from its history to estimate future adjustments.</p>
</div>
<div class="paragraph">
<p>Depending on your distribution of Linux, the list of network time servers will be stored in different places. Let us assume that <code>ntp</code> is installed on your machine.</p>
</div>
<div class="paragraph">
<p>The file <code>/etc/ntp.conf</code> contains configuration information about how your system synchronises with network time. This file can be read and modified using <code>vi</code> or <code>nano</code>.</p>
</div>
<div class="paragraph">
<p>By default, the NTP servers used will be specified in a section like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># Use public servers from the pool.ntp.org project.
# Please consider joining the pool (http://www.pool.ntp.org/join.html).
server 0.centos.pool.ntp.org iburst
server 1.centos.pool.ntp.org iburst
server 2.centos.pool.ntp.org iburst
server 3.centos.pool.ntp.org iburst</pre>
</div>
</div>
<div class="paragraph">
<p>The syntax for adding NTP servers looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>server (IP Address)
server server.url.localhost</pre>
</div>
</div>
<div class="paragraph">
<p>Server addresses can be IP addresses or URLs if DNS has been properly configured. In this case, the server will always be queried.</p>
</div>
<div class="paragraph">
<p>A network administrator might also consider using (or setting up) a <em>pool</em>. In this case, we assume that there are several NTP providers, all running NTP daemons and with the same time. When a client queries a pool, a provider is selected at random. This helps to distribute network load among many machines so that no one machine in the pool is handling all NTP queries.</p>
</div>
<div class="paragraph">
<p>Commonly, <code>/etc/ntp.conf</code> will be populated with a server pool called <code>pool.ntp.org</code>. So for example, <code>server 0.centos.pool.ntp.org</code> is a default NTP pool provided to CentOS machines.</p>
</div>
</div>
<div class="sect2">
<h3 id="_pool_ntp_org">pool.ntp.org</h3>
<div class="paragraph">
<p>The NTP servers used by default are an open source project. More information can be found at <a href="https://www.ntppool.org/en/">ntppool.org</a>.</p>
</div>
<div class="quoteblock">
<blockquote>
Consider if the NTP Pool is appropriate for your use. If business, organization or human life depends on having correct time or can be harmed by it being wrong, you shouldn&#8217;t &#8220;just get it off the internet&#8221;. The NTP Pool is generally very high quality, but it is a service run by volunteers in their spare time. Please talk to your equipment and service vendors about getting local and reliable service setup for you. See also our terms of service. We recommend time servers from Meinberg, but you can also find time servers from End Run, Spectracom and many others.
</blockquote>
<div class="attribution">
&#8212; ntppool.org
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ntpdate">ntpdate</h3>
<div class="paragraph">
<p>During initial setup, system time and NTP might be seriously de-synchronised. If the <em>offset</em> between system and NTP time is greater than 17 minutes, then the NTP daemon will not make changes to system time. In this scenario manual intervention will be required.</p>
</div>
<div class="paragraph">
<p>Firstly, if <code>ntpd</code> is running it will be necessary to <em>stop</em> the service. Use <code>systemctl stop ntpd</code> to do so.</p>
</div>
<div class="paragraph">
<p>Next, use <code>ntpdate pool.ntp.org</code> to perform an initial one-time synchronisation, where <code>pool.ntp.org</code> refers to the IP address or URL of an NTP server. More than one sync may be required.</p>
</div>
</div>
<div class="sect2">
<h3 id="_ntpq">ntpq</h3>
<div class="paragraph">
<p><code>ntpq</code> is a utility for monitoring the status of NTP. Once the NTP daemon has been started and configured, <code>ntpq</code> can be used to check on its status:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>ntpq -p</strong>
     remote           refid      st t when poll reach   delay   offset  jitter
==============================================================================
+37.44.185.42    91.189.94.4      3 u   86  128  377  126.509  -20.398   6.838
+ntp2.0x00.lv    193.204.114.233  2 u   82  128  377  143.885   -8.105   8.478
*inspektor-vlan1 121.131.112.137  2 u   17  128  377  112.878  -23.619   7.959
 b1-66er.matrix. 18.26.4.105      2 u  484  128   10   34.907   -0.811  16.123</pre>
</div>
</div>
<div class="paragraph">
<p>In this case <code>-p</code> is for <em>print</em> and it will print a summary of peers. Host addresses can also be returned as IP addresses using <code>-n</code>.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>remote</code></dt>
<dd>
<p>hostname of the NTP provider.</p>
</dd>
<dt class="hdlist1"><code>refid</code></dt>
<dd>
<p>Reference ID of the NTP provider.</p>
</dd>
<dt class="hdlist1"><code>st</code></dt>
<dd>
<p>Stratum of the provider.</p>
</dd>
<dt class="hdlist1"><code>when</code></dt>
<dd>
<p>Number of seconds since the last query.</p>
</dd>
<dt class="hdlist1"><code>poll</code></dt>
<dd>
<p>Number of seconds between queries.</p>
</dd>
<dt class="hdlist1"><code>reach</code></dt>
<dd>
<p>Status ID to indicate whether a server was reached. Successful connections will increase this number by 1.</p>
</dd>
<dt class="hdlist1"><code>delay</code></dt>
<dd>
<p>Time in ms between query and response by the server.</p>
</dd>
<dt class="hdlist1"><code>offset</code></dt>
<dd>
<p>Time in ms between system time and NTP time.</p>
</dd>
<dt class="hdlist1"><code>jitter</code></dt>
<dd>
<p>Offset in ms between system time and NTP in the last query.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><code>ntpq</code> also has an interactive mode, which is accessed when it is run without options or argument. The <code>?</code> option will return a list of commands that <code>ntpq</code> will recognize.</p>
</div>
</div>
<div class="sect2">
<h3 id="_chrony">chrony</h3>
<div class="paragraph">
<p><code>chrony</code> is yet another way to implement NTP. It is installed by default on some Linux systems, but is available to download on all major distributions. <code>chronyd</code> is the chrony daemon, and <code>chronyc</code> is the command line interface. It may be required to start and enable <code>chronyd</code> before interacting with <code>chronyc</code>.</p>
</div>
<div class="paragraph">
<p>If the chrony installation has a default configuration then using the command <code>chronyc tracking</code> will provide information about NTP and system time:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>chronyc tracking</strong>
Reference ID    : 3265FB3D (bras-vprn-toroon2638w-lp130-11-50-101-251-61.dsl.)
Stratum         : 3
Ref time (UTC)  : Thu Jan 09 19:18:35 2020
System time     : 0.000134029 seconds fast of NTP time
Last offset     : +0.000166506 seconds
RMS offset      : 0.000470712 seconds
Frequency       : 919.818 ppm slow
Residual freq   : +0.078 ppm
Skew            : 0.555 ppm
Root delay      : 0.006151616 seconds
Root dispersion : 0.010947504 seconds
Update interval : 129.8 seconds
Leap status     : Normal</pre>
</div>
</div>
<div class="paragraph">
<p>This output contains a lot of information, more than what is available from other implementations.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>Reference ID</code></dt>
<dd>
<p>The reference ID and name to which the computer is currently synced.</p>
</dd>
<dt class="hdlist1"><code>Stratum</code></dt>
<dd>
<p>Number of hops to a computer with an attached reference clock.</p>
</dd>
<dt class="hdlist1"><code>Ref time</code></dt>
<dd>
<p>This is the UTC time at which the last measurement from the reference source was made.</p>
</dd>
<dt class="hdlist1"><code>System time</code></dt>
<dd>
<p>Delay of system clock from synchronized server.</p>
</dd>
<dt class="hdlist1"><code>Last offset</code></dt>
<dd>
<p>Estimated offset of the last clock update.</p>
</dd>
<dt class="hdlist1"><code>RMS offset</code></dt>
<dd>
<p>Long term average of the offset value.</p>
</dd>
<dt class="hdlist1"><code>Frequency</code></dt>
<dd>
<p>This is the rate by which the system’s clock would be wrong if chronyd is not correcting it. It is provided in ppm (parts per million).</p>
</dd>
<dt class="hdlist1"><code>Residual freq</code></dt>
<dd>
<p>Residual frequency indicating the difference between the measurements from reference source and the frequency currently being used.</p>
</dd>
<dt class="hdlist1"><code>Skew</code></dt>
<dd>
<p>Estimated error bound of the frequency.</p>
</dd>
<dt class="hdlist1"><code>Root delay</code></dt>
<dd>
<p>Total of the network path delays to the stratum computer, from which the computer is being synced.</p>
</dd>
<dt class="hdlist1"><code>Leap status</code></dt>
<dd>
<p>This is the leap status which can have one of the following values – normal, insert second, delete second or not synchronized.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>We can also look at detailed information about the last valid NTP update:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># <strong>chrony ntpdata</strong>
Remote address  : 172.105.97.111 (AC69616F)
Remote port     : 123
Local address   : 192.168.122.81 (C0A87A51)
Leap status     : Normal
Version         : 4
Mode            : Server
Stratum         : 2
Poll interval   : 6 (64 seconds)
Precision       : -25 (0.000000030 seconds)
Root delay      : 0.000381 seconds
Root dispersion : 0.000092 seconds
Reference ID    : 61B7CE58 ()
Reference time  : Mon Jan 13 21:50:03 2020
Offset          : +0.000491960 seconds
Peer delay      : 0.004312567 seconds
Peer dispersion : 0.000000068 seconds
Response time   : 0.000037078 seconds
Jitter asymmetry: +0.00
NTP tests       : 111 111 1111
Interleaved     : No
Authenticated   : No
TX timestamping : Daemon
RX timestamping : Kernel
Total TX        : 15
Total RX        : 15
Total valid RX  : 15</pre>
</div>
</div>
<div class="paragraph">
<p>Finally, <code>chronyc sources</code> will return information about the NTP servers that are used to synchronise time:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>chronyc sources</strong>
210 Number of sources = 0
MS Name/IP address         Stratum Poll Reach LastRx Last sample
===============================================================================</pre>
</div>
</div>
<div class="paragraph">
<p>At the moment, this machine has no sources configured. We can add sources from <code>pool.ntp.org</code> by opening the chrony configuration file. This will usually be located at <code>/etc/chrony.conf</code>. When we open this file, we should see that some servers are listed by default:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>210 Number of sources = 0
MS Name/IP address         Stratum Poll Reach LastRx Last sample
===============================================================================
# Most computers using chrony will send measurement requests to one or
# more 'NTP servers'.  You will probably find that your Internet Service
# Provider or company have one or more NTP servers that you can specify.
# Failing that, there are a lot of public NTP servers.  There is a list
# you can access at http://support.ntp.org/bin/view/Servers/WebHome or
# you can use servers from the 3.arch.pool.ntp.org project.

! server 0.arch.pool.ntp.org iburst iburst
! server 1.arch.pool.ntp.org iburst iburst
! server 2.arch.pool.ntp.org iburst iburst

! pool 3.arch.pool.ntp.org iburst</pre>
</div>
</div>
<div class="paragraph">
<p>These servers will also serve as a syntax guide when entering our own servers. However, in this case we will simply remove the <code>!</code> s at the beginning of each line, thus uncommenting out these lines and using the default servers from the <code>pool.ntp.org</code> project.</p>
</div>
<div class="paragraph">
<p>In addition, in this file we can choose to change the default configuration regarding skew and drift as well as the location of the driftfile and keyfile.</p>
</div>
<div class="paragraph">
<p>On this machine, we need to make a large initial clock correction. We will choose to uncomment the following line:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>! makestep 1.0 3</pre>
</div>
</div>
<div class="paragraph">
<p>After making changes to the configuration file, restart the <code>chronyd</code> service and then use <code>chronyc makestep</code> to manually step the system clock:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># <strong>chronyc makestep</strong>
200 OK</pre>
</div>
</div>
<div class="paragraph">
<p>And then use <code>chronyc tracking</code> as before to verify that the changes have taken place.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec.108.1_02-GE">Guided Exercise</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Enter the appropriate term for each definition:</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Definition</th>
<th class="tableblock halign-left valign-top">Term</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">A computer that will share network time with you</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Distance from a reference clock, in hops or steps</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Difference between system time and network time</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Difference between system time and network time since the last NTP poll</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Group of servers that provide network time and share the load between them</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Specify which of the commands you would use to output the following values:</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top"><code>chronyc tracking</code></th>
<th class="tableblock halign-left valign-top"><code>timedatectl show-timesync --all</code></th>
<th class="tableblock halign-left valign-top"><code>ntpq -pn</code></th>
<th class="tableblock halign-left valign-top"><code>chrony ntpdata</code></th>
<th class="tableblock halign-left valign-top"><code>chronyc sources</code></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jitter</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Drift</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Interval of Poll</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Offset</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stratum</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IP Address of Provider</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Root Delay</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>You are setting up an enterprise network consisting of a Linux server and several Linux desktops. The server has a static IP address of 192.168.0.101. You decide that the server will connect to <code>pool.ntp.org</code> and then provide NTP time to the desktops. Describe the configuration of the server and of the desktops.</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>A Linux machine has the incorrect time. Describe the steps you would take to troubleshoot NTP.</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec.108.1_02-EE">Explorational Exercise</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Research the differences between SNTP and NTP.</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">SNTP</th>
<th class="tableblock halign-left valign-top">NTP</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Why might a system administrator choose <em>not</em> to use <code>pool.ntp.org</code>?</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>How would a system administrator choose to join or otherwise contribute to the  <code>pool.ntp.org</code> project?</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec.108.1_02-SU">Summary</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this lesson you learned:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>What NTP is and why it is important.</p>
</li>
<li>
<p>Configuring the NTP daemon from the <code>pool.ntp.org</code> project.</p>
</li>
<li>
<p>Using <code>ntpq</code> to verify NTP configuration.</p>
</li>
<li>
<p>Using <code>chrony</code> as an alternative NTP service.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Commands used in this lesson:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>timedatectl show-timesync --all</code></dt>
<dd>
<p>Display SNTP information if using <code>timedatectl</code>.</p>
</dd>
<dt class="hdlist1"><code>ntpdate &lt;address&gt;</code></dt>
<dd>
<p>Perform a manual one-time NTP step update.</p>
</dd>
<dt class="hdlist1"><code>ntpq -p</code></dt>
<dd>
<p>Print a history of NTP recent polls. <code>-n</code> will replace URLs with IP addresses.</p>
</dd>
<dt class="hdlist1"><code>chronyc tracking</code></dt>
<dd>
<p>Displays NTP status if using chrony.</p>
</dd>
<dt class="hdlist1"><code>chronyc ntpdata</code></dt>
<dd>
<p>Displays NTP information about the last poll.</p>
</dd>
<dt class="hdlist1"><code>chronyc sources</code></dt>
<dd>
<p>Displays informations about NTP providers.</p>
</dd>
<dt class="hdlist1"><code>chronyc makestep</code></dt>
<dd>
<p>Perform a manual one-time NTP step update if using chrony.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec.108.1_02-AGE">Answers Guided Exercise</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Enter the appropriate term for each definition:</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Definition</th>
<th class="tableblock halign-left valign-top">Term</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">A computer that will share network time with you</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provider</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Distance from a reference clock, in hops or steps</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stratum</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Difference between system time and network time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Offset</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Difference between system time and network time since the last NTP poll</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jitter</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Group of servers that provide network time and share the load between them</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pool</p></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Specify which of the commands you would use to output the following values:</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top"><code>chronyc tracking</code></th>
<th class="tableblock halign-left valign-top"><code>timedatectl show-timesync --all</code></th>
<th class="tableblock halign-left valign-top"><code>ntpq -pn</code></th>
<th class="tableblock halign-left valign-top"><code>chrony ntpdata</code></th>
<th class="tableblock halign-left valign-top"><code>chronyc sources</code></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jitter</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Drift</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Interval of Poll</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X (<code>when</code> column)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Offset</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stratum</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IP Address of Provider</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Root Delay</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>You are setting up an enterprise network consisting of a Linux server and several Linux desktops. The server has a static IP address of 192.168.0.101. You decide that the server will connect to <code>pool.ntp.org</code> and then provide NTP time to the desktops. Describe the configuration of the server and of the desktops.</p>
<div class="paragraph">
<p>Ensure that the server has an ntpd service running, rather than SNTP. Use <code>pool.ntp.org</code> pools in the <code>/etc/ntp.conf</code> or <code>/etc/chrony.conf</code> file. For each client, specify <code>192.168.0.101</code> in each <code>/etc/ntp.conf</code> or <code>/etc/chrony.conf</code> file.</p>
</div>
</li>
<li>
<p>A Linux machine has the incorrect time. Describe the steps you would take to troubleshoot NTP.</p>
<div class="paragraph">
<p>First, ensure that the machine is connected to the Internet. Use <code>ping</code> for this. Check that an ntpd or SNTP service is running using <code>systemctl status ntpd</code> or <code>systemctl status systemd-timesyncd</code>. You may see error messages that provide useful information. Finally, use a command such as <code>ntpq -p</code> or <code>chrony tracking</code> to verify if any requests have been made. If the system time is drastically different from network time, it may be that system time is considered &#8220;insane&#8221; and will not be changed without manual intervention. In this case, use a command from the previous lesson or a command such as <code>ntpdate pool.ntp.org</code> to perform a one-time ntp synchronisation.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec.108.1_02-AEE">Answers to Explorational Exercises</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Research the differences between SNTP and NTP.</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">SNTP</th>
<th class="tableblock halign-left valign-top">NTP</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">less accurate</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">more accurate</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">requires fewer resources</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">requires more resources</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cannot act as a time provider</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">can act as a time provider</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">steps time only</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">steps or slews time</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">requests time from a single source</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">can monitor multiple NTP servers and use the optimal provider</p></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Why might a system administrator choose <em>not</em> to use <code>pool.ntp.org</code>?</p>
<div class="paragraph">
<p>From ntppool.org: If it is absolutely crucial to have correct time, you should consider an alternative. Similarly, if your Internet provider has a time server, it is recommended to use that instead.</p>
</div>
</li>
<li>
<p>How would a system administrator choose to join or otherwise contribute to the  <code>pool.ntp.org</code> project?</p>
<div class="paragraph">
<p>From www.ntppool.org: Your server must have a static IP address and a permanent internet connection. The static IP address must not change at all or at least less than once a year. Beyond that, the bandwidth requirements are modest: 384 - 512 Kbit bandwidth. Stratum 3 or 4 servers are welcome to join.</p>
</div>
</li>
</ol>
</div>
</div>
</div>

        
      </section>
    </div>

    <aside class="lesson__license smallprint">
  <div class="container">
    
    <p>© 2020 Linux Professional Insitute Inc. All rights reserved. Visit the Learning Materials website: https://learning.lpi.org<br />
       This work is licensed under the Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License.</p>
  </div>
</aside>


    
    
    <aside class="lesson__teaser teaser">
      <div class="container teaser__container">
        <h2 class="label">Next Lesson</h2>
        <p class="headline teaser__headline">108.2 System logging (108.2 Lesson 1)</p>

        <div class="button-group">
            <a href="../../108.2/108.2_01/index.html" class="button -primary">Read next lesson</a>
        </div>
      </div>
    </aside>
    
  </div>
</div>

<div class="lesson-progress">
  <div class="lesson-progress__current"></div>
</div>

      </main>
    </td></tr></tbody>
    <tfoot><tr><td class="print__cell">
      <div class="print__space -footer"></div>
    </td></tr></tfoot>
  </table>

  <table class="print-footer">
  <tr class="print-footer__body">
    <td class="print-footer__cell -image">
      <img src="index.html" alt="" class="print-footer__image">
    </td>
    <td class="print-footer__cell -center">
      <p>© 2020 Linux Professional Insitute Inc. All rights reserved. Visit the Learning Materials website: https://learning.lpi.org<br />
         This work is licensed under the Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License.</p>
    </td>
    <td class="print-footer__cell -image">
      <img src="index.html" alt="" class="print-footer__license">
    </td>
  </tr>
</table>

<footer class="footer">
  <div class="container footer__container columns">
    <div class="column">
      <h2>LPI is a non-profit organization.</h2>
      <p>Linux Professional Institute (LPI) is the global certification standard and career support organization for open source professionals. With more than 200,000 certification holders, it&#39;s the world’s first and largest vendor-neutral Linux and open source certification body. LPI has certified professionals in over 180 countries, delivers exams in multiple languages, and has hundreds of training partners.</p>
      <p>Our purpose is to enable economic and creative opportunities for everybody by making open source knowledge and skills certification universally accessible.</p>
    </div>

    <div class="column">
      <ul class="footer__social social">
        <li class="social__item -linkedin">
          <a class="social__link" href="https://www.linkedin.com/company/35136" target="_blank" rel="noreferrer">
            <svg version="1.1"  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 viewBox="0 0 42.3 36" enable-background="new 0 0 42.3 36" xml:space="preserve">
<g>
	<g>
		<g>
			<path fill="#010202" d="M33.3,0H2.7C1.2,0,0,1.2,0,2.6v30.8C0,34.8,1.2,36,2.7,36h30.7c1.5,0,2.7-1.2,2.7-2.6V2.6
				C36,1.2,34.8,0,33.3,0z M10.7,30.7H5.3V13.5h5.3V30.7z M8,11.1c-1.7,0-3.1-1.4-3.1-3.1C4.9,6.3,6.3,5,8,5c1.7,0,3.1,1.4,3.1,3.1
				C11.1,9.8,9.7,11.1,8,11.1z M30.7,30.7h-5.3v-8.4c0-2,0-4.6-2.8-4.6c-2.8,0-3.2,2.2-3.2,4.4v8.5H14V13.5h5.1v2.3h0.1
				c0.7-1.4,2.5-2.8,5.1-2.8c5.4,0,6.4,3.6,6.4,8.2V30.7z"/>
		</g>
	</g>
	<g>
		<polygon fill="#010202" points="37.5,28.5 38.2,28.5 38.2,30.7 38.6,30.7 38.6,28.5 39.3,28.5 39.3,28.1 37.5,28.1 		"/>
		<polygon fill="#010202" points="41.7,28.1 41,30 40.3,28.1 39.7,28.1 39.7,30.7 40.1,30.7 40.1,28.8 40.9,30.7 41.1,30.7
			41.9,28.8 41.9,30.7 42.3,30.7 42.3,28.1 		"/>
	</g>
</g>
</svg>

            <span class="social__link__text">LinkedIn</span>
          </a>
        </li>
        <li class="social__item -facebook">
          <a class="social__link" href="https://www.facebook.com/LPIConnect" target="_blank" rel="noreferrer">
            <svg version="1.1"  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 viewBox="0 0 36 36" enable-background="new 0 0 36 36" xml:space="preserve">
<title>flogo-RGB-HEX-Blk-58</title>
<path d="M34,0H2C0.9,0,0,0.9,0,2v32c0,1.1,0.9,2,2,2h17.3V22.1h-4.7v-5.4h4.7v-4c0-4.6,2.8-7.2,7-7.2c0,0,0,0,0,0c0,0,0,0,0,0
	c0.4,0,0.9,0,1.3,0c0.3,0,0.5,0,0.8,0c0.7,0,1.4,0.1,2.1,0.2v4.9v0h-2.9c-0.3,0-0.5,0-0.8,0c-1.6,0.2-1.9,1.2-1.9,2.6v3.5h5.4
	l-0.7,5.4h0l0,0h-4.7V36H34c1.1,0,2-0.9,2-2V2C36,0.9,35.1,0,34,0z"/>
</svg>

            <span class="social__link__text">Facebook</span>
          </a>
        </li>
        <li class="social__item -twitter">
          <a class="social__link" href="https://twitter.com/lpiconnect" target="_blank" rel="noreferrer">
            <svg version="1.1" id="Logo_FIXED" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 viewBox="0 0 36 36" enable-background="new 0 0 36 36" xml:space="preserve">
<path d="M11.3,32.6c13.6,0,21-11.3,21-21c0-0.3,0-0.6,0-1c1.4-1,2.7-2.3,3.7-3.8c-1.3,0.6-2.8,1-4.2,1.2c1.5-0.9,2.7-2.4,3.2-4.1
	c-1.4,0.9-3,1.5-4.7,1.8c-2.8-3-7.5-3.1-10.5-0.3c-1.9,1.8-2.7,4.5-2.1,7.1C11.8,12.1,6.3,9.3,2.5,4.7c-2,3.4-1,7.7,2.3,9.9
	c-1.2,0-2.3-0.4-3.4-0.9c0,0,0,0.1,0,0.1c0,3.5,2.5,6.5,5.9,7.2c-1.1,0.3-2.2,0.3-3.3,0.1c1,3,3.7,5.1,6.9,5.1
	c-2.6,2.1-5.8,3.2-9.2,3.2c-0.6,0-1.2,0-1.8-0.1C3.4,31.5,7.3,32.6,11.3,32.6"/>
</svg>

            <span class="social__link__text">Twitter</span>
          </a>
        </li>
      </ul>
    </div>
  </div>

  <div class="container footer__secondary">
    <ul class="footer__links">
      <li><a href="https://www.lpi.org/about-lpi/contact-us" class="footer__link" target="_blank" rel="noreferrer">Contact Us</a></li>
      <li><a href="https://www.lpi.org/privacy-and-cookie-policy" class="footer__link" target="_blank" rel="noreferrer">Privacy and Cookie Policy</a></li>
    </ul>

    <p><strong>Spot a mistake or want to help improve this page? Please <a href="https://www.lpi.org/about-lpi/contact-us" target="_blank" rel="noreferrer">let us know</a>.</strong></p>
    <p>© Copyright 1999-2020 The Linux Professional Institute Inc. All rights reserved.</p>
  </div>
</footer>


  
  
  

  <script src="https://unpkg.com/swiper/swiper-bundle.min.js" type="application/javascript"></script>
  <script src="../../../../../../js/bundle.js"></script>
</body>
</html>
