

<!DOCTYPE html>
<html lang="en-us">
<head>


  
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-WMC4KTP');</script>
  



  <meta charset="utf-8"/>
  <title>104.1 Lesson 1</title>

  <link rel="stylesheet" href="../../../../../../scss/styles.min.css">

  
  <link rel="apple-touch-icon" sizes="152x152" href="https://learning.lpi.org/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="https://learning.lpi.org/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="https://learning.lpi.org/favicon-16x16.png">
  <link rel="manifest" href="https://learning.lpi.org/site.webmanifest">
  <link rel="mask-icon" href="https://learning.lpi.org/safari-pinned-tab.svg" color="#fbc000">
  <meta name="msapplication-TileColor" content="#ffc40d">
  <meta name="theme-color" content="#ffffff">

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body class="page">



  
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WMC4KTP"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  



  

<header class="header">
  <span class="header__nav -clone"></span>

  <a href="https://learning.lpi.org/" class="header__logo-link">
    <img class="header__logo" src="../../../../../../lpi-learning-logo.svg" alt="Linux Professional Institute Learning Logo.">
  </a>

  <nav class="header__nav nav">
    <a href="index.html#content" class="nav__skip">Skip to main content</a>

    <button class="nav__button" aria-hidden="true">
      <span></span>
      <span></span>
      <span></span>
    </button>

    <div class="nav__menus">
      <ul class="nav__menu">
        
          <li class="nav__item
              
              
              ">


            
              <a href="https://learning.lpi.org/en/" class="nav__link">Home</a>
            


            
          </li>
        
          <li class="nav__item
              -has-submenu
              -is-active
              ">


            
              <button class="nav__link" type="button">Learning Materials</button>
            


            
              <ul class="nav__menu -submenu">
                
                  <li class="nav__item
                      ">
                    <a href="https://learning.lpi.org/en/learning-materials/all-materials/" class="nav__link
                      ">All Resources</a>
                  </li>
                
                  <li class="nav__item
                      ">
                    <a href="https://learning.lpi.org/en/learning-materials/learning-materials/" class="nav__link
                      ">LPI Learning Materials</a>
                  </li>
                
                  <li class="nav__item
                      ">
                    <a href="https://learning.lpi.org/en/learning-materials/become-contributor/" class="nav__link
                      ">Become a Contributor</a>
                  </li>
                
              </ul>
            
          </li>
        
          <li class="nav__item
              -has-submenu
              
              ">


            
              <button class="nav__link" type="button">Publishing Partners</button>
            


            
              <ul class="nav__menu -submenu">
                
                  <li class="nav__item
                      ">
                    <a href="https://learning.lpi.org/en/lpi-publishing-partner/lpp-partners/" class="nav__link
                      ">Publishing Partners</a>
                  </li>
                
                  <li class="nav__item
                      ">
                    <a href="https://learning.lpi.org/en/lpi-publishing-partner/become-lpp/" class="nav__link
                      ">Become a Publishing Partner</a>
                  </li>
                
              </ul>
            
          </li>
        
          <li class="nav__item
              -has-submenu
              
              ">


            
              <button class="nav__link" type="button">About</button>
            


            
              <ul class="nav__menu -submenu">
                
                  <li class="nav__item
                      ">
                    <a href="https://learning.lpi.org/en/about/about/" class="nav__link
                      ">About</a>
                  </li>
                
                  <li class="nav__item
                      ">
                    <a href="https://learning.lpi.org/en/about/faq/" class="nav__link
                      ">FAQ</a>
                  </li>
                
                  <li class="nav__item
                      ">
                    <a href="https://learning.lpi.org/en/about/lm-contributors/" class="nav__link
                      ">Contributors</a>
                  </li>
                
                  <li class="nav__item
                      ">
                    <a href="https://learning.lpi.org/en/about/roadmap/" class="nav__link
                      ">Roadmap</a>
                  </li>
                
                  <li class="nav__item
                      ">
                    <a href="https://learning.lpi.org/en/about/contact/" class="nav__link
                      ">Contact</a>
                  </li>
                
              </ul>
            
          </li>
        
      </ul>

      <ul class="nav__menu -secondary">
        <li class="nav__item -lang-select">
        
<select name="language-picker" id="lang-select" class="lang-select" title='Language' aria-label='Language'>
  
    <option value="es"
      >Español</option>
  
    <option value="de"
      >Deutsch</option>
  
    <option value="en"
      selected>English</option>
  
    <option value="it"
      >Italiano</option>
  
    <option value="pt"
      >Português</option>
  
</select>


        </li>
        <li class="nav__item -external">
        <a href="https://lpi.org/" class="nav__link" target="_blank" rel="noreferrer noopener">LPI.org</a>
        </li>
      </ul>
    </div>
  </nav>
</header>


  <table class="print-header">
    <tr class="print-header__body">
      <td class="print-header__cell">104.1 Lesson 1</td>
      <td class="print-header__cell -pagenumber"></td>
    </tr>
  </table>

  <table class="print">
    <thead><tr><td class="print__cell">
      <div class="print__space -header"></div>
    </td></tr></thead>
    <tbody><tr><td class="print__cell">
      <main id="content">




<div class="lesson page-content">
  <div class="lesson__hierarchy page-content__hierarchy">
    <nav class="hierarchy">
  

  <div class="hierarchy__container">
     
      <dl class="hierarchy__section">
        <dt class="hierarchy__heading">Topic 101: System Architecture
          <button class="hierarchy__toggle-button" aria-hidden="true">
            <span class="hierarchy__toggle-button__icon"></span>
          </button>
        </dt>

        
        <dd class="hierarchy__item">
          <a href="../../../101/101.1/index.html" class="hierarchy__link">101.1 Determine and configure hardware settings</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../101/101.1/101.1_01/index.html" class="hierarchy__link">101.1 Lesson 1</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../../101/101.2/index.html" class="hierarchy__link">101.2 Boot the system</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../101/101.2/101.2_01/index.html" class="hierarchy__link">101.2 Lesson 1</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../../101/101.3/index.html" class="hierarchy__link">101.3 Change runlevels / boot targets and shutdown or reboot system</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../101/101.3/101.3_01/index.html" class="hierarchy__link">101.3 Lesson 1</a>
            </li>
            
          </ul>
        </dd>
        
      </dl>
      
      <dl class="hierarchy__section">
        <dt class="hierarchy__heading">Topic 102: Linux Installation and Package Management
          <button class="hierarchy__toggle-button" aria-hidden="true">
            <span class="hierarchy__toggle-button__icon"></span>
          </button>
        </dt>

        
        <dd class="hierarchy__item">
          <a href="../../../102/102.1/index.html" class="hierarchy__link">102.1 Design hard disk layout</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../102/102.1/102.1_01/index.html" class="hierarchy__link">102.1 Lesson 1</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../../102/102.2/index.html" class="hierarchy__link">102.2 Install a boot manager</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../102/102.2/102.2_01/index.html" class="hierarchy__link">102.2 Lesson 1</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../../102/102.3/index.html" class="hierarchy__link">102.3 Manage shared libraries</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../102/102.3/102.3_01/index.html" class="hierarchy__link">102.3 Lesson 1</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../../102/102.4/index.html" class="hierarchy__link">102.4 Use Debian package management</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../102/102.4/102.4_01/index.html" class="hierarchy__link">102.4 Lesson 1</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../../102/102.5/index.html" class="hierarchy__link">102.5 Use RPM and YUM package management</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../102/102.5/102.5_01/index.html" class="hierarchy__link">102.5 Lesson 1</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../../102/102.6/index.html" class="hierarchy__link">102.6 Linux as a virtualization guest</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../102/102.6/102.6_01/index.html" class="hierarchy__link">102.6 Lesson 1</a>
            </li>
            
          </ul>
        </dd>
        
      </dl>
      
      <dl class="hierarchy__section">
        <dt class="hierarchy__heading">Topic 103: GNU and Unix Commands
          <button class="hierarchy__toggle-button" aria-hidden="true">
            <span class="hierarchy__toggle-button__icon"></span>
          </button>
        </dt>

        
        <dd class="hierarchy__item">
          <a href="../../../103/103.1/index.html" class="hierarchy__link">103.1 Work on the command line</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../103/103.1/103.1_01/index.html" class="hierarchy__link">103.1 Lesson 1</a>
            </li>
            
            <li class="hierarchy__item">
              <a href="../../../103/103.1/103.1_02/index.html" class="hierarchy__link">103.1 Lesson 2</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../../103/103.2/index.html" class="hierarchy__link">103.2 Process text streams using filters</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../103/103.2/103.2_01/index.html" class="hierarchy__link">103.2 Lesson 1</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../../103/103.3/index.html" class="hierarchy__link">103.3 Perform basic file management</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../103/103.3/103.3_01/index.html" class="hierarchy__link">103.3 Lesson 1</a>
            </li>
            
            <li class="hierarchy__item">
              <a href="../../../103/103.3/103.3_02/index.html" class="hierarchy__link">103.3 Lesson 2</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../../103/103.4/index.html" class="hierarchy__link">103.4 Use streams, pipes and redirects</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../103/103.4/103.4_01/index.html" class="hierarchy__link">103.4 Lesson 1</a>
            </li>
            
            <li class="hierarchy__item">
              <a href="../../../103/103.4/103.4_02/index.html" class="hierarchy__link">103.4 Lesson 2</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../../103/103.5/index.html" class="hierarchy__link">103.5 Create, monitor and kill processes</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../103/103.5/103.5_01/index.html" class="hierarchy__link">103.5 Lesson 1</a>
            </li>
            
            <li class="hierarchy__item">
              <a href="../../../103/103.5/103.5_02/index.html" class="hierarchy__link">103.5 Lesson 2</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../../103/103.6/index.html" class="hierarchy__link">103.6 Modify process execution priorities</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../103/103.6/103.6_01/index.html" class="hierarchy__link">103.6 Lesson 1</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../../103/103.7/index.html" class="hierarchy__link">103.7 Search text files using regular expressions</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../103/103.7/103.7_01/index.html" class="hierarchy__link">103.7 Lesson 1</a>
            </li>
            
            <li class="hierarchy__item">
              <a href="../../../103/103.7/103.7_02/index.html" class="hierarchy__link">103.7 Lesson 2</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../../103/103.8/index.html" class="hierarchy__link">103.8 Basic file editing</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../103/103.8/103.8_01/index.html" class="hierarchy__link">103.8 Lesson 1</a>
            </li>
            
          </ul>
        </dd>
        
      </dl>
      
      <dl class="hierarchy__section -is-active">
        <dt class="hierarchy__heading">Topic 104: Devices, Linux Filesystems, Filesystem Hierarchy Standard
          <button class="hierarchy__toggle-button" aria-hidden="true">
            <span class="hierarchy__toggle-button__icon"></span>
          </button>
        </dt>

        
        <dd class="hierarchy__item">
          <a href="../index.html" class="hierarchy__link">104.1 Create partitions and filesystems</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="index.html" class="hierarchy__link">104.1 Lesson 1</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../104.2/index.html" class="hierarchy__link">104.2 Maintain the integrity of filesystems</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../104.2/104.2_01/index.html" class="hierarchy__link">104.2 Lesson 1</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../104.3/index.html" class="hierarchy__link">104.3 Control mounting and unmounting of filesystems</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../104.3/104.3_01/index.html" class="hierarchy__link">104.3 Lesson 1</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../104.5/index.html" class="hierarchy__link">104.5 Manage file permissions and ownership</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../104.5/104.5_01/index.html" class="hierarchy__link">104.5 Lesson 1</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../104.6/index.html" class="hierarchy__link">104.6 Create and change hard and symbolic links</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../104.6/104.6_01/index.html" class="hierarchy__link">104.6 Lesson 1</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../104.7/index.html" class="hierarchy__link">104.7 Find system files and place files in the correct location</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../104.7/104.7_01/index.html" class="hierarchy__link">104.7 Lesson 1</a>
            </li>
            
          </ul>
        </dd>
        
      </dl>
      
  </div>
</nav>

  </div>



  <div class="lesson__container page-content__container">
    <div class="container">
      <nav class="lesson__breadcrumb breadcrumb">
        <ol class="breadcrumb__list">
          
          <li class="breadcrumb__item">
            <a href="../../index.html" class="breadcrumb__link">Topic 104: Devices, Linux Filesystems, Filesystem Hierarchy Standard</a>
          </li>
          
          
          <li class="breadcrumb__item">
            <a href="../index.html" class="breadcrumb__link">104.1 Create partitions and filesystems</a>
          </li>
          
          <li class="breadcrumb__item">
            <a href="index.html" class="breadcrumb__link">104.1 Lesson 1</a>
          </li>
        </ol>
      </nav>

      
      <section class="lesson__content">
        
          <h1>104.1 Lesson 1</h1>
          <div id="preamble">
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch fronttable">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Certificate:</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">LPIC-1</p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Version:</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.0</p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Topic:</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">104 Devices, Linux Filesystems, Filesystem Hierarchy Standard</p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Objective:</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">104.1 Create partitions and filesystems</p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Lesson:</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 of 1</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="sec.104.1_01-IN">Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>On any operating system, a disk needs to be partitioned before it can be used. A partition is a logical subset of the physical disk, and information about partitions are stored in a partition table.  This table includes information about the first and last sectors of the partition and its type, and further details on each partition.</p>
</div>
<div class="paragraph">
<p>Usually each partition is seen by an operating system as a separate &#8220;disk&#8221;, even if they all reside in the same physical media. On Windows systems they are assigned letters like <code>C:</code> (historically the main disk), <code>D:</code> and so on. On Linux each partition is assigned to a directory under <code>/dev</code>, like <code>/dev/sda1</code> or <code>/dev/sda2</code>.</p>
</div>
<div class="paragraph">
<p>In this lesson, you will learn how to create, delete, restore and resize partitions using the three most common utilities (<code>fdisk</code>, <code>gdisk</code> and <code>parted</code>), how to create a filesystem on them and how to create and set up a <em>swap partition</em> or <em>swap file</em> to be used as virtual memory.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>For historical reasons, through this lesson we will refer to storage media as &#8220;disks&#8221;, even though modern storage systems, like SSDs and Flash Storage, do not contain any &#8220;disks&#8221; at all.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_understanding_mbr_and_gpt">Understanding MBR and GPT</h3>
<div class="paragraph">
<p>There are two main ways of storing partition information on hard disks. The first one is MBR (<em>Master Boot Record</em>), and the second one is GPT (<em>GUID Partition Table</em>).</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">MBR</dt>
<dd>
<p>This is a remnant from the early days of MS-DOS (more specifically, PC-DOS 2.0 from 1983) and for decades was the standard partitioning scheme on PCs. The partition table is stored on the first sector of a disk, called the <em>Boot Sector</em>, along with a boot loader, which on Linux systems is usually the <em>GRUB</em> bootloader. But MBR has a series of limitations that hinder its use on modern systems, like the inability to address disks of more than 2 TB in size, and the limit of only 4 primary partitions per disk.</p>
</dd>
<dt class="hdlist1">GUID</dt>
<dd>
<p>A partitioning system that addresses many of the limitations of MBR. There is no practical limit on disk size, and the maximum number of partitions are limited only by the operating system itself. It is more commonly found on more modern machines that use UEFI instead of the old PC BIOS.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>During system administration tasks it is highly possible that you will find both schemes in use, so it is important to know how to use the tools associated with each one to create, delete or modify partitions.</p>
</div>
<div class="sect3">
<h4 id="_managing_mbr_partitions_with_fdisk">Managing MBR Partitions with FDISK</h4>
<div class="paragraph">
<p>The standard utility for managing MBR partitions on Linux is <code>fdisk</code>. This is an interactive, menu-driven utility. To use it, type <code>fdisk</code> followed by the device name corresponding to the disk you want to edit. For example, the command</p>
</div>
<div class="listingblock">
<div class="content">
<pre># <strong>fdisk /dev/sda</strong></pre>
</div>
</div>
<div class="paragraph">
<p>would edit the partition table of the first SATA-connected device (<code>sda</code>) on the system. Keep in mind that you need to specify the device corresponding to the physical disk, not one of its partitions (like <code>/dev/sda1</code>).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>All disk-related operations in this lesson need to be done as the user <code>root</code> (the system administrator), or with root privileges using <code>sudo</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When invoked, <code>fdisk</code> will show a greeting, then a warning and it will wait for your commands.</p>
</div>
<div class="listingblock">
<div class="content">
<pre># <strong>fdisk /dev/sda</strong>
Welcome to fdisk (util-linux 2.33.1).
Changes will remain in memory only, until you decide to write them.
Be careful before using the write command.

Command (m for help):</pre>
</div>
</div>
<div class="paragraph">
<p>The warning is important. You can create, edit or delete partitions at will, but <em>nothing</em> will be written to disk unless you use the write (<code>w</code>) command. So you can &#8220;practice&#8221; without risk of losing data, as long as you stay clear of the <code>w</code> key. To exit <code>fdisk</code> without saving changes, use the <code>q</code> command.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>That being said, you should never practice on an important disk, as there are always risks. Use a spare external disk, or a USB flash drive instead.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_printing_the_current_partition_table">Printing the Current Partition Table</h5>
<div class="paragraph">
<p>The command <code>p</code> is used to print the current partition table. The output is something like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Command (m for help): <strong>p</strong>
Disk /dev/sda: 111.8 GiB, 120034123776 bytes, 234441648 sectors
Disk model: CT120BX500SSD1
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disklabel type: dos
Disk identifier: 0x97f8fef5

Device     Boot     Start       End   Sectors   Size Id Type
/dev/sda1            4096 226048942 226044847 107.8G 83 Linux
/dev/sda2       226048944 234437550   8388607     4G 82 Linux swap / Solaris</pre>
</div>
</div>
<div class="paragraph">
<p>Here is the meaning of each column:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>Device</code></dt>
<dd>
<p>The device assigned to the partition.</p>
</dd>
<dt class="hdlist1"><code>Boot</code></dt>
<dd>
<p>Shows whether the partition is &#8220;bootable&#8221; or not.</p>
</dd>
<dt class="hdlist1"><code>Start</code></dt>
<dd>
<p>The sector where the partition starts.</p>
</dd>
<dt class="hdlist1"><code>End</code></dt>
<dd>
<p>The sector where the partition ends.</p>
</dd>
<dt class="hdlist1"><code>Sectors</code></dt>
<dd>
<p>The total number of sectors in the partition. Multiply it by the sector size to get the partition size in bytes.</p>
</dd>
<dt class="hdlist1"><code>Size</code></dt>
<dd>
<p>The size of the partition in &#8220;human readable&#8221; format. In the example above, values are in gigabytes.</p>
</dd>
<dt class="hdlist1"><code>Id</code></dt>
<dd>
<p>The numerical value representing the partition type.</p>
</dd>
<dt class="hdlist1"><code>Type</code></dt>
<dd>
<p>The description for the partition type.</p>
</dd>
</dl>
</div>
</div>
<div class="sect4">
<h5 id="_primary_vs_extended_partitions">Primary vs Extended Partitions</h5>
<div class="paragraph">
<p>On an MBR disk, you can have 2 main types of partitions, <em>primary</em> and <em>extended</em>. Like we said before, you can have only 4 primary partitions on the disk, and if you want to make the disk &#8220;bootable&#8221;, the first partition must be a primary one.</p>
</div>
<div class="paragraph">
<p>One way to work around this limitation is to create an extended partition that acts as a container for <em>logical</em> partitions. You could have, for example, a primary partition, an extended partition occupying the remainder of the disk space and five logical partitions inside it.</p>
</div>
<div class="paragraph">
<p>For an operating system like Linux, primary and extended partitions are treated exactly in the same way, so there are no &#8220;advantages&#8221; of using one over the other.</p>
</div>
</div>
<div class="sect4">
<h5 id="_creating_a_partition">Creating a Partition</h5>
<div class="paragraph">
<p>To create a partition, use the <code>n</code> command. By default, partitions will be created at the start of unallocated space on the disk. You will be asked for the partition type (primary or extended), first sector and last sector.</p>
</div>
<div class="paragraph">
<p>For the first sector, you can usually accept the default value suggested by <code>fdisk</code>, unless you need a partition to start at a specific sector. Instead of specifying the last sector, you can specify a size followed by the letters <code>K</code>, <code>M</code>, <code>G</code>, <code>T</code> or <code>P</code> (Kilo, Mega, Giga, Tera or Peta). So, if you want to create a 1 GB partition, you could specify <code>+1G</code> as the <code>Last sector</code>, and <code>fdisk</code> will size the partition accordingly. See this example for the creation of a primary partition:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Command (m for help): <strong>n</strong>
Partition type
   p   primary (0 primary, 0 extended, 4 free)
   e   extended (container for logical partitions)
Select (default p): <strong>p</strong>
Partition number (1-4, default 1): <strong>1</strong>
First sector (2048-3903577, default 2048): <strong>2048</strong>
Last sector, +/-sectors or +/-size{K,M,G,T,P} (2048-3903577, default 3903577): <strong>+1G</strong></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_checking_for_unallocated_space">Checking for Unallocated Space</h5>
<div class="paragraph">
<p>If you do not know how much free space there is on the disk, you can use the <code>F</code> command to show the unallocated space, like so:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Command (m for help): <strong>F</strong>
Unpartitioned space /dev/sdd: 881 MiB, 923841536 bytes, 1804378 sectors
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes

  Start     End Sectors  Size
2099200 3903577 1804378  881M</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_deleting_partitions">Deleting Partitions</h5>
<div class="paragraph">
<p>To delete a partition, use the <code>d</code> command. <code>fdisk</code> will ask you for the number of the partition you want to delete, <em>unless</em> there is <em>only one</em> partition on the disk. In this case, this partition will be <em>selected and deleted immediately</em>.</p>
</div>
<div class="paragraph">
<p>Be aware that if you delete an extended partition, all the logical partitions inside it will also be deleted.</p>
</div>
</div>
<div class="sect4">
<h5 id="_mind_the_gap">Mind the Gap!</h5>
<div class="paragraph">
<p>Keep in mind that when creating a new partition with <code>fdisk</code>, the maximum size will be limited to the maximum amount of <em>contiguous</em> unallocated space on the disk. Say, for example, that you have the following partition map:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Device     Boot   Start     End Sectors  Size Id Type
/dev/sdd1          2048 1050623 1048576  512M 83 Linux
/dev/sdd2       1050624 2099199 1048576  512M 83 Linux
/dev/sdd3       2099200 3147775 1048576  512M 83 Linux</pre>
</div>
</div>
<div class="paragraph">
<p>Then you delete partition 2 and check for free space:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Command (m for help): <strong>F</strong>
Unpartitioned space /dev/sdd: 881 MiB, 923841536 bytes, 1804378 sectors
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes

  Start     End Sectors  Size
1050624 2099199 1048576  512M
3147776 3903577  755802  369M</pre>
</div>
</div>
<div class="paragraph">
<p>Adding up the size of the unallocated space, in theory we have 881 MB available. But see what happens when we try to create a 700 MB partition:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Command (m for help): <strong>n</strong>
Partition type
   p   primary (2 primary, 0 extended, 2 free)
   e   extended (container for logical partitions)
Select (default p): <strong>p</strong>
Partition number (2,4, default 2): <strong>2</strong>
First sector (1050624-3903577, default 1050624):
Last sector, +/-sectors or +/-size{K,M,G,T,P} (1050624-2099199, default 2099199): <strong>+700M</strong>
Value out of range.</pre>
</div>
</div>
<div class="paragraph">
<p>That happens because the largest contiguous unallocated space on the disk is the 512 MB block that belonged to partition 2. Your new partition cannot &#8220;reach over&#8221; partition 3 to use some of the unallocated space after it.</p>
</div>
</div>
<div class="sect4">
<h5 id="_changing_the_partition_type">Changing the Partition Type</h5>
<div class="paragraph">
<p>Occasionally, you may need to change the partition type, especially when dealing with disks that will be used on other operating systems and platforms. This is done with the command <code>t</code>, followed by the number of the partition you wish to change.</p>
</div>
<div class="paragraph">
<p>The partition type must be specified by its corresponding hexadecimal code, and you can see a list of all the valid codes by using the command <code>l</code>.</p>
</div>
<div class="paragraph">
<p>Do not confuse the partition type with the filesystem used on it. Although at first there was a relation between them, today you cannot assume this to be true. A Linux partition, for example, can contain any Linux-native filesystem, like <em>ext4</em> or <em>ReiserFS</em>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph">
<p>Linux partitions are type <code>83</code> (Linux). Swap partitions are type <code>82</code> (Linux Swap).</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_managing_guid_partitions_with_gdisk">Managing GUID Partitions with GDISK</h4>
<div class="paragraph">
<p>The utility <code>gdisk</code> is the equivalent of <code>fdisk</code> when dealing with GPT partitioned disks. In fact, the interface is modeled after <code>fdisk</code>, with an interactive prompt and the same (or very similar) commands.</p>
</div>
<div class="sect4">
<h5 id="_printing_the_current_partition_table_2">Printing the Current Partition Table</h5>
<div class="paragraph">
<p>The command <code>p</code> is used to print the current partition table. The output is something like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Command (? for help): <strong>p</strong>
Disk /dev/sdb: 3903578 sectors, 1.9 GiB
Model: DataTraveler 2.0
Sector size (logical/physical): 512/512 bytes
Disk identifier (GUID): AB41B5AA-A217-4D1E-8200-E062C54285BE
Partition table holds up to 128 entries
Main partition table begins at sector 2 and ends at sector 33
First usable sector is 34, last usable sector is 3903544
Partitions will be aligned on 2048-sector boundaries
Total free space is 1282071 sectors (626.0 MiB)

Number  Start (sector)    End (sector)  Size       Code  Name
   1            2048         2099199   1024.0 MiB  8300  Linux filesystem
   2         2623488         3147775   256.0 MiB   8300  Linux filesystem</pre>
</div>
</div>
<div class="paragraph">
<p>Right from the start, we notice a few different things:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Each disk has a unique Disk Identifier (GUID). This is a 128 bit hexadecimal number, assigned randomly when the partition table is created. Since there are 3.4 × 10<sup>38</sup> possible values to this number, the chances that 2 random disks have the same GUID are pretty slim. The GUID can be used to identify which filesystems to mount at boot time (and where), eliminating the need to use the device path to do so (like <code>/dev/sdb</code>).</p>
</li>
<li>
<p>See the phrase <code>Partition table holds up to 128 entries</code>? That&#8217;s right, you can have up to 128 partitions on a GPT disk. Because of this, there is no need for <em>primary</em> and <em>extended</em> partitions.</p>
</li>
<li>
<p>The free space is listed on the last line, so there is no need for an equivalent of the <code>F</code> command from fdisk.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_creating_a_partition_2">Creating a Partition</h5>
<div class="paragraph">
<p>The command to create a partition is <code>n</code>, just as in <code>fdisk</code>. The main difference is that besides the partition number and the first and last sector (or size), you can also specify the partition type during the creation. GPT partitions support many more types than MBR. You can check a list of all the supported types by using the <code>L</code> command.</p>
</div>
</div>
<div class="sect4">
<h5 id="_deleting_a_partition">Deleting a Partition</h5>
<div class="paragraph">
<p>To delete a partition, type <code>d</code> and the partition number. Unlike <code>fdisk</code>, the first partition will not be automatically selected if it is the only one on the disk.</p>
</div>
<div class="paragraph">
<p>On GPT disks, partitions can be easily reordered, or &#8220;sorted&#8221;, to avoid gaps in the numbering sequence. To do this, simply use the <code>s</code> command. For example, imagine a disk with the following partition table:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Number  Start (sector)    End (sector)  Size       Code  Name
   1            2048         2099199   1024.0 MiB  8300  Linux filesystem
   2         2099200         2361343   128.0 MiB   8300  Linux filesystem
   3         2361344         2623487   128.0 MiB   8300  Linux filesystem</pre>
</div>
</div>
<div class="paragraph">
<p>If you delete the second partition, the table would become:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Number  Start (sector)    End (sector)  Size       Code  Name
   1            2048         2099199   1024.0 MiB  8300  Linux filesystem
   3         2361344         2623487   128.0 MiB   8300  Linux filesystem</pre>
</div>
</div>
<div class="paragraph">
<p>If you use the <code>s</code> command, it would become:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Number  Start (sector)    End (sector)  Size       Code  Name
   1            2048         2099199   1024.0 MiB  8300  Linux filesystem
   2         2361344         2623487   128.0 MiB   8300  Linux filesystem</pre>
</div>
</div>
<div class="paragraph">
<p>Notice that the third partition became the second one.</p>
</div>
</div>
<div class="sect4">
<h5 id="_gap_what_gap">Gap? What Gap?</h5>
<div class="paragraph">
<p>Unlike MBR disks, when creating a partition on GPT disks the size is not limited by the maximum amount of <em>contiguous</em> unallocated space. You can use every last bit of a free sector, no matter where it is located on the disk.</p>
</div>
</div>
<div class="sect4">
<h5 id="_recovery_options">Recovery Options</h5>
<div class="paragraph">
<p>GPT disks store backup copies of the GPT header and partition table, making it easy to recover disks in case this data has been damaged. <code>gdisk</code> provides features to aid in those recovery tasks, accessed with the <code>r</code> command.</p>
</div>
<div class="paragraph">
<p>You can rebuild a corrupt main GPT header or partition table with <code>b</code> and <code>c</code>, respectively, or use the main header and table to rebuild a backup with <code>d</code> and <code>e</code>. You can also convert a MBR to a GPT with <code>f</code>, and do the opposite with <code>g</code>, among other operations. Type <code>?</code> in the recovery menu to get a list of all the available recovery commands and descriptions about what they do.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_creating_file_systems">Creating File Systems</h3>
<div class="paragraph">
<p>Partitioning the disk is only the first step towards being able to use a disk. After that, you will need to format the partition with a filesystem before using it to store data.</p>
</div>
<div class="paragraph">
<p>A filesystem controls how the data is stored and accessed on the disk. Linux supports many filesystems, some native, like the ext (Extended Filesystem) family, while others come from other operating systems like FAT from MS-DOS, NTFS from Windows NT, HFS and HFS+ from Mac OS, etc.</p>
</div>
<div class="paragraph">
<p>The standard tool used to create a filesystem on Linux is <code>mkfs</code>, which comes in many &#8220;flavors&#8221; according to the filesystem it needs to work with.</p>
</div>
<div class="sect3">
<h4 id="_creating_an_ext2ext3ext4_filesystem">Creating an ext2/ext3/ext4 Filesystem</h4>
<div class="paragraph">
<p>The <em>Extended Filesystem</em> (ext) was the first filesystem for Linux, and through the years was replaced by new versions called ext2, ext3 and ext4, which is currently the default filesystem for many Linux distributions.</p>
</div>
<div class="paragraph">
<p>The utilities <code>mkfs.ext2</code>, <code>mkfs.ext3</code> and <code>mkfs.ext4</code> are used to create ext2, ext3 and ext4 filesystems. In fact, all of these &#8220;utilities&#8221; exist only as symbolic links to another utility called <code>mke2fs</code>. <code>mke2fs</code> alters its defaults according to the name it is called by. As such, they all have the same behavior and command line parameters.</p>
</div>
<div class="paragraph">
<p>The most simple form of usage is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># <strong>mkfs.ext2 TARGET</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Where <code>TARGET</code> is the name of the partition where the filesystem should be created. For example, to create an ext3 filesystem on <code>/dev/sdb1</code> the command would be:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># <strong>mkfs.ext3 /dev/sdb1</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Instead of using the command corresponding to the filesystem you wish to create, you can pass the <code>-t</code> parameter to <code>mke2fs</code> followed by the filesystem name. For example, the following commands are equivalent, and will create an ext4 filesystem on <code>/dev/sdb1</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre># <strong>mkfs.ext4 /dev/sdb1</strong>
# <strong>mke2fs -t ext4 /dev/sdb1</strong></pre>
</div>
</div>
<div class="sect4">
<h5 id="_command_line_parameters">Command Line Parameters</h5>
<div class="paragraph">
<p><code>mke2fs</code> supports a wide range of command line parameters and options. Here are some of the most significant ones. All of them also apply to <code>mkfs.ext2</code>, <code>mkfs.ext3</code> and <code>mkfs.ext4</code>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>-b SIZE</code></dt>
<dd>
<p>Sets the size of the data blocks in the device to <code>SIZE</code>, which can be 1024, 2048 or 4096 bytes per block.</p>
</dd>
<dt class="hdlist1"><code>-c</code></dt>
<dd>
<p>Checks the target device for bad blocks before creating the filesystem. You can run a thorough, but much slower check by passing this parameter twice, as in <code>mkfs.ext4 -c -c TARGET</code>.</p>
</dd>
<dt class="hdlist1"><code>-d DIRECTORY</code></dt>
<dd>
<p>Copies the contents of the specified directory to the root of the new filesystem. Useful if you need to &#8220;pre-populate&#8221; the disk with a predefined set of files.</p>
</dd>
<dt class="hdlist1"><code>-F</code></dt>
<dd>
<p><em>Danger, Will Robinson!</em> This option will <em>force</em> mke2fs to create a filesystem, even if the other options passed to it or the target are dangerous or make no sense at all. If specified twice (as in <code>-F -F</code>) it can even be used to create a filesystem on a device which is mounted or in use, which is a very, <em>very</em> bad thing to do.</p>
</dd>
<dt class="hdlist1"><code>-L VOLUME_LABEL</code></dt>
<dd>
<p>Will set the volume label to the one specified in <code>VOLUME_LABEL</code>. This label must be at most 16 characters long.</p>
</dd>
<dt class="hdlist1"><code>-n</code></dt>
<dd>
<p>This is a truly useful option that simulates the creation of the filesystem, and displays what would be done if executed without the <code>n</code> option. Think of it as a &#8220;trial&#8221; mode. Good to check things out before actually committing any changes to disk.</p>
</dd>
<dt class="hdlist1"><code>-q</code></dt>
<dd>
<p>Quiet mode. <code>mke2fs</code> will run normally, but will not produce any output to the terminal. Useful when running <code>mke2fs</code> from a script.</p>
</dd>
<dt class="hdlist1"><code>-U ID</code></dt>
<dd>
<p>This will set the UUID (<em>Universally Unique Identifier</em>) of a partition to the value specified as ID. UUIDs are 128 bit numbers in hexadecimal notation that serve to uniquely identify a partition to the operating system. This number is specified as a 32-digit string in the format 8-4-4-4-12, meaning 8 digits, hyphen, 4 digits, hyphen, 4 digits, hyphen, 4 digits, hyphen, 12 digits, like <code>D249E380-7719-45A1-813C-35186883987E</code>. Instead of an ID you can also specify parameters like <code>clear</code> to clear the filesystem UUID, <code>random</code>, to use a randomly generated UUID, or <code>time</code> to create a time-based UUID.</p>
</dd>
<dt class="hdlist1"><code>-V</code></dt>
<dd>
<p>Verbose mode, prints much more information during operation than usual. Useful for debugging purposes.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_creating_an_xfs_filesystem">Creating an XFS Filesystem</h4>
<div class="paragraph">
<p>XFS is a high-performance filesystem originally developed by Silicon Graphics in 1993 for its IRIX operating system. Due to its performance and reliability features, it is commonly used for servers and other environments that require high (or guaranteed) filesystem bandwidth.</p>
</div>
<div class="paragraph">
<p>Tools for managing XFS filesystems are part of the <code>xfsprogs</code> package. This package may need to be installed manually, as it is not included by default in some Linux distributions. Others, like Red Hat Enterprise Linux 7, use XFS as the default filesystem.</p>
</div>
<div class="paragraph">
<p>XFS filesystems are divided into at least 2 parts, a <em>log section</em> where a log of all filesystem operations (commonly called a <em>Journal</em>) are maintained, and the <em>data section</em>. The log section may be located inside the data section (the default behavior), or even on a separate disk altogether, for better performance and reliability.</p>
</div>
<div class="paragraph">
<p>The most basic command to create an XFS filesystem is <code>mkfs.xfs TARGET</code>, where <code>TARGET</code> is the partition you want the filesystem to be created in. For example: <code>mkfs.xfs /dev/sda1</code>.</p>
</div>
<div class="paragraph">
<p>As in <code>mke2fs</code>, <code>mkfs.xfs</code> supports a number of command line options. Here are some of the most common ones.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>-b size=VALUE</code></dt>
<dd>
<p>Sets the block size on the filesystem, in bytes, to the one specified in <code>VALUE</code>. The default value is 4096 bytes (4 KiB), the minimum is 512, and the maximum is 65536 (64 KiB).</p>
</dd>
<dt class="hdlist1"><code>-m crc=VALUE</code></dt>
<dd>
<p>Parameters starting with <code>-m</code> are metadata options. This one enables (if <code>VALUE</code> is <code>1</code>) or disables (if <code>VALUE</code> is <code>0</code>) the use of CRC32c checks to verify the integrity of all metadata on the disk. This enables better error detection and recovery from crashes related to hardware issues, so it is enabled by default. The performance impact of this check should be minimal, so normally there is no reason to disable it.</p>
</dd>
<dt class="hdlist1"><code>-m uuid=VALUE</code></dt>
<dd>
<p>Sets the partition UUID to the one specified as VALUE. Remember that UUIDs are 32-character (128 bits) numbers in hexadecimal base, specified in groups of 8, 4, 4, 4 and 12 digits separated by dashes, like <code>1E83E3A3-3AE9-4AAC-BF7E-29DFFECD36C0</code>.</p>
</dd>
<dt class="hdlist1"><code>-f</code></dt>
<dd>
<p>Force the creation of a filesystem on the target device even if a filesystem is detected on it.</p>
</dd>
<dt class="hdlist1"><code>-l logdev=DEVICE</code></dt>
<dd>
<p>This will put the log section of the filesystem on the specified device, instead of inside the data section.</p>
</dd>
<dt class="hdlist1"><code>-l size=VALUE</code></dt>
<dd>
<p>This will set the size of the log section to the one specified in <code>VALUE</code>. The size can be specified in bytes, and suffixes like <code>m</code> or <code>g</code> can be used. <code>-l size=10m</code>, for example, will limit the log section to 10 Megabytes.</p>
</dd>
<dt class="hdlist1"><code>-q</code></dt>
<dd>
<p>Quiet mode. In this mode, <code>mkfs.xfs</code> will not print the parameters of the file system being created.</p>
</dd>
<dt class="hdlist1"><code>-L LABEL</code></dt>
<dd>
<p>Sets the filesystem label, which can be at most 12 characters long.</p>
</dd>
<dt class="hdlist1"><code>-N</code></dt>
<dd>
<p>Similar to the <code>-n</code> parameter of <code>mke2fs</code>, will make <code>mkfs.xfs</code> print all the parameters for the creation of the file system, without actually creating it.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_creating_a_fat_or_vfat_filesystem">Creating a FAT or VFAT Filesystem</h4>
<div class="paragraph">
<p>The FAT filesystem originated from MS-DOS, and through the years has received many revisions culminating on the FAT32 format released in 1996 with Windows 95 OSR2.</p>
</div>
<div class="paragraph">
<p>VFAT is an extension of the FAT16 format with support for long (up to 255 characters) file names. Both filesystems are handled by the same utility, <code>mkfs.fat</code>. <code>mkfs.vfat</code> is an alias to it.</p>
</div>
<div class="paragraph">
<p>The FAT filesystem has important drawbacks which restrict its use on large disks. FAT16, for example, supports volumes of at most 4 GB and a maximum file size of 2 GB. FAT32 ups the volume size to up to 2 PB, and the maximum file size to 4 GB. Because of this, FAT filesystems are today more commonly used on small flash drives or memory cards (up to 2 GB in size), or legacy devices and OSs that do not support more advanced filesystems.</p>
</div>
<div class="paragraph">
<p>The most basic command for the creation of a FAT filesystem is <code>mkfs.fat TARGET</code>, where <code>TARGET</code> is the partition you want the filesystem to be created in. For example: <code>mkfs.fat /dev/sdc1</code>.</p>
</div>
<div class="paragraph">
<p>Like other utilities, <code>mkfs.fat</code> supports a number of command line options. Below are the most important ones. A full list and description of every option can be read in the manual for the utility, with the command <code>man mkfs.fat</code>.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>-c</code></dt>
<dd>
<p>Checks the target device for bad blocks before creating the filesystem.</p>
</dd>
<dt class="hdlist1"><code>-C FILENAME BLOCK_COUNT</code></dt>
<dd>
<p>Will create the file specified in <code>FILENAME</code> and then create a FAT filesystem inside it, effectively creating an empty &#8220;disk image&#8221;, that can be later written to a device using a utility such as <code>dd</code> or mounted as a loopback device. When using this option, the number of blocks in the filesystem (<code>BLOCK_COUNT</code>) must be specified after the device name.</p>
</dd>
<dt class="hdlist1"><code>-F SIZE</code></dt>
<dd>
<p>Selects the size of the FAT (<em>File Allocation Table</em>), between 12, 16 or 32, i.e., between FAT12, FAT16 or FAT32. If not specified, <code>mkfs.fat</code> will select the appropriate option based on the filesystem size.</p>
</dd>
<dt class="hdlist1"><code>-n NAME</code></dt>
<dd>
<p>Sets the volume label, or name, for the filesystem. This can be up to 11 characters long, and the default is no name.</p>
</dd>
<dt class="hdlist1"><code>-v</code></dt>
<dd>
<p>Verbose mode. Prints much more information than usual, useful for debugging.</p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p><code>mkfs.fat</code> <em>cannot</em> create a &#8220;bootable&#8221; filesystem. According to the manual page, &#8220;this isn&#8217;t as easy as you might think&#8221; and will not be implemented.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_creating_an_exfat_filesystem">Creating an exFAT Filesystem</h4>
<div class="paragraph">
<p>exFAT is a filesystem created by Microsoft in 2006 that addresses one of the most important limitations of FAT32: file and disk size. On exFAT, the maximum file size is 16 exabytes (from 4 GB on FAT32), and the maximum disk size is 128 petabytes.</p>
</div>
<div class="paragraph">
<p>As it is well supported by all three major operating systems (Windows, Linux and mac OS), it is a good choice where interoperability is needed, like on large capacity flash drives, memory cards and external disks. In fact, it is the default filesystem, as defined by the <em>SD Association</em>, for SDXC memory cards larger than 32 GB.</p>
</div>
<div class="paragraph">
<p>The default utility for creating exFAT filesystems is <code>mkfs.exfat</code>, which is a link to <code>mkexfatfs</code>. The most basic command is <code>mkfs.exfat TARGET</code>, where <code>TARGET</code> is the partition you want the filesystem to be created in. For example: <code>mkfs.exfat /dev/sdb2</code>.</p>
</div>
<div class="paragraph">
<p>Contrary to the other utilities discussed in this lesson, <code>mkfs.exfat</code> has very few command line options. They are:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>-i VOL_ID</code></dt>
<dd>
<p>Sets the Volume ID to the value specified in <code>VOL_ID</code>. This is a 32-Bit hexadecimal number. If not defined, an ID based on the current time is set.</p>
</dd>
<dt class="hdlist1"><code>-n NAME</code></dt>
<dd>
<p>Sets the volume label, or name. This can have up to 15 characters, and the default is no name.</p>
</dd>
<dt class="hdlist1"><code>-p SECTOR</code></dt>
<dd>
<p>Specifies the first sector of the first partition on the disk. This is an optional value, and the default is zero.</p>
</dd>
<dt class="hdlist1"><code>-s SECTORS</code></dt>
<dd>
<p>Defines the number of physical sectors per cluster of allocation. This must be a power of two, like 1, 2, 4, 8, and so on.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_getting_to_know_the_btrfs_filesystem">Getting to Know the Btrfs Filesystem</h4>
<div class="paragraph">
<p>Btrfs (officially the <em>B-Tree Filesystem</em>, pronounced as &#8220;Butter FS&#8221;, &#8220;Better FS&#8221; or even &#8220;Butterfuss&#8221;, your pick) is a filesystem that has been in development since 2007 specifically for Linux by the Oracle Corporation and other companies, including Fujitsu, Red Hat, Intel and SUSE, among others.</p>
</div>
<div class="paragraph">
<p>There are many features that make Btrfs attractive on modern systems where massive amounts of storage are common. Among these are multiple device support (including striping, mirroring and striping+mirroring, as in a RAID setup), transparent compression, SSD optimizations, incremental backups, snapshots, online defragmentation, offline checks, support for subvolumes (with quotas), deduplication and much more.</p>
</div>
<div class="paragraph">
<p>As it is a <em>copy-on-write</em> filesystem it is very resilient to crashes. And on top of that, Btrfs is simple to use, and well supported by many Linux distributions. And some of them, like SUSE, use it as the default filesystem.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>On a traditional filesystem, when you want to overwrite part of a file the new data is put directly over the old data that it is replacing. On a <em>copy-on-write</em> filesystem the new data is written to free space on disk, then the file&#8217;s original metadata is updated to refer to the new data and only then the old data is freed up, as it is no longer needed. This reduces the chances of data loss in case of a crash, as the old data is only discarded after the filesystem is absolutely sure that it is no longer needed and the new data is in place.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_creating_a_btrfs_filesystem">Creating a Btrfs Filesystem</h5>
<div class="paragraph">
<p>The utility <code>mkfs.btrfs</code> is used to create a Btrfs filesystem. Using the command without any options creates a Btrfs filesystem on a given device, like so:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># <strong>mkfs.btrfs /dev/sdb1</strong></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph">
<p>If you do not have the <code>mkfs.btrfs</code> utility on your system, look for <code>btrfs-progs</code> in your distribution&#8217;s package manager.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can use the <code>-L</code> to set a label (or name) for your filesystem. Btrfs labels can have up to 256 characters, except for newlines:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># <strong>mkfs.btrfs /dev/sdb1 -L "New Disk"</strong></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph">
<p>Enclose the label in quotes (like above) if it contains spaces.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Note this peculiar thing about Btrfs: you can pass <em>multiple</em> devices to the <code>mkfs.btrfs</code> command. Passing more than one device will span the filesystem over all the devices which is similar to a RAID or LVM setup. To specify how metadata will be distributed in the disk array, use the <code>-m</code> parameter. Valid parameters are <code>raid0</code>, <code>raid1</code>, <code>raid5</code>, <code>raid6</code>, <code>raid10</code>, <code>single</code> and <code>dup</code>.</p>
</div>
<div class="paragraph">
<p>For example, to create a filesystem spanning <code>/dev/sdb1</code> and <code>/dev/sdc1</code>, concatenating the two partitions into one big partition, use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># <strong>mkfs.btrfs -d single -m single /dev/sdb /dev/sdc</strong></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph">
<p>Filesystems spanning multiple partitions such as above might look advantageous at first but are not a good idea from a data safety standpoint, as a failure on a single disk of the array means certain data loss. The risk gets bigger the more disks you use, as you also have more possible points of failure.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_managing_subvolumes">Managing Subvolumes</h5>
<div class="paragraph">
<p>Subvolumes are like filesystems inside filesystems. Think of them as a directory which can be mounted as (and treated like) a separate filesystem. Subvolumes make organization and system administration easier, as each one of them can have separate quotas or snapshot rules.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Subvolumes are not partitions. A partition allocates a fixed space on a drive. This can lead to problems further down the line, like one partition running out of space when another one has plenty of space left. Not so with subvolumes, as they &#8220;share&#8221; the free space from their root filesystem, and grow as needed.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Suppose you have a Btrfs filesystem mounted on <code>/mnt/disk</code>, and you wish to create a subvolume inside it to store your backups. Let&#8217;s call it <code>BKP</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># <strong>btrfs subvolume create /mnt/disk/BKP</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Next we list the contents of the <code>/mnt/disk</code> filesystem. You will see that we have a new directory, named after our subvolume.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>ls -lh /mnt/disk/</strong>
total 0
drwxr-xr-x 1 root   root     0 jul 13 17:35 BKP
drwxrwxr-x 1 carol carol 988 jul 13 17:30 Images</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Yes, subvolumes can <em>also</em> be accessed like any other directory.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>We can check that the subvolume is active, with the command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># <strong>btrfs subvolume show /mnt/disk/BKP/</strong>
	Name: 			BKP
	UUID: 			e90a1afe-69fa-da4f-9764-3384f66fa32e
	Parent UUID: 		-
	Received UUID: 		-
	Creation time: 		2019-07-13 17:35:40 -0300
	Subvolume ID: 		260
	Generation: 		23
	Gen at creation: 	22
	Parent ID: 		5
	Top level ID: 		5
	Flags: 			-
	Snapshot(s):</pre>
</div>
</div>
<div class="paragraph">
<p>You can mount the subvolume on <code>/mnt/BKP</code> by passing the <code>-t btrfs -o subvol=NAME</code> parameter to the <code>mount</code> command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># <strong>mount -t btrfs -o subvol=BKP /dev/sdb1 /mnt/bkp</strong></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>-t</code> parameter specifies the filesystem type to be mounted.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_working_with_snapshots">Working with Snapshots</h5>
<div class="paragraph">
<p>Snapshots are just like subvolumes, but pre-populated with the contents from the volume from which the snapshot was taken.</p>
</div>
<div class="paragraph">
<p>When created, a snapshot and the original volume have exactly the same content. But from that point in time, they will diverge. Changes made to the original volume (like files added, renamed or deleted) will not be reflected on the snapshot, and vice-versa.</p>
</div>
<div class="paragraph">
<p>Keep in mind that a snapshot <em>does not</em> duplicate the files, and initially takes almost no disk space. It simply duplicates the filesystem tree, while pointing to the original data.</p>
</div>
<div class="paragraph">
<p>The command to create a snapshot is the same used to create a subvolume, just add the <code>snapshot</code> parameter after <code>btrfs subvolume</code>. The command below will create a snapshot of the Btrfs filesysten mounted in <code>/mnt/disk</code> in <code>/mnt/disk/snap</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># <strong>btrfs subvolume snapshot /mnt/disk /mnt/disk/snap</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Now, imagine you have the following contents in <code>/mnt/disk</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>ls -lh</strong>
total 2,8M
-rw-rw-r-- 1 carol carol 109K jul 10 16:22 Galaxy_Note_10.png
-rw-rw-r-- 1 carol carol 484K jul  5 15:01 geminoid2.jpg
-rw-rw-r-- 1 carol carol 429K jul  5 14:52 geminoid.jpg
-rw-rw-r-- 1 carol carol 467K jul  2 11:48 LG-G8S-ThinQ-Mirror-White.jpg
-rw-rw-r-- 1 carol carol 654K jul  2 11:39 LG-G8S-ThinQ-Range.jpg
-rw-rw-r-- 1 carol carol  94K jul  2 15:43 Mimoji_Comparativo.jpg
-rw-rw-r-- 1 carol carol 112K jul 10 16:20 Note10Plus.jpg
drwx------ 1 carol carol  366 jul 13 17:56 snap
-rw-rw-r-- 1 carol carol 118K jul 11 16:36 Twitter_Down_20190711.jpg
-rw-rw-r-- 1 carol carol 324K jul  2 15:22 Xiaomi_Mimoji.png</pre>
</div>
</div>
<div class="paragraph">
<p>Notice the snap directory, containing the snapshot. Now let us remove some files, and check the directory contents:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>rm LG-G8S-ThinQ-</strong>*
$ <strong>ls -lh</strong>
total 1,7M
-rw-rw-r-- 1 carol carol 109K jul 10 16:22 Galaxy_Note_10.png
-rw-rw-r-- 1 carol carol 484K jul  5 15:01 geminoid2.jpg
-rw-rw-r-- 1 carol carol 429K jul  5 14:52 geminoid.jpg
-rw-rw-r-- 1 carol carol  94K jul  2 15:43 Mimoji_Comparativo.jpg
-rw-rw-r-- 1 carol carol 112K jul 10 16:20 Note10Plus.jpg
drwx------ 1 carol carol  366 jul 13 17:56 snap
-rw-rw-r-- 1 carol carol 118K jul 11 16:36 Twitter_Down_20190711.jpg
-rw-rw-r-- 1 carol carol 324K jul  2 15:22 Xiaomi_Mimoji.png</pre>
</div>
</div>
<div class="paragraph">
<p>However, if you check inside the snap directory, the files you deleted are still there and can be restored if needed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>ls -lh snap/</strong>
total 2,8M
-rw-rw-r-- 1 carol carol 109K jul 10 16:22 Galaxy_Note_10.png
-rw-rw-r-- 1 carol carol 484K jul  5 15:01 geminoid2.jpg
-rw-rw-r-- 1 carol carol 429K jul  5 14:52 geminoid.jpg
<strong>-rw-rw-r-- 1 carol carol 467K jul  2 11:48 LG-G8S-ThinQ-Mirror-White.jpg</strong>
<strong>-rw-rw-r-- 1 carol carol 654K jul  2 11:39 LG-G8S-ThinQ-Range.jpg</strong>
-rw-rw-r-- 1 carol carol  94K jul  2 15:43 Mimoji_Comparativo.jpg
-rw-rw-r-- 1 carol carol 112K jul 10 16:20 Note10Plus.jpg
-rw-rw-r-- 1 carol carol 118K jul 11 16:36 Twitter_Down_20190711.jpg
-rw-rw-r-- 1 carol carol 324K jul  2 15:22 Xiaomi_Mimoji.png</pre>
</div>
</div>
<div class="paragraph">
<p>It is also possible to create read-only snapshots. They work exactly like writable snapshots, with the difference that the contents of the snapshot cannot be changed, they are &#8220;frozen&#8221; in time. Just add the <code>-r</code> parameter when creating the snapshot:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># <strong>btrfs subvolume snapshot -r /mnt/disk /mnt/disk/snap</strong></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_a_few_words_on_compression">A Few Words on Compression</h5>
<div class="paragraph">
<p>Btrfs supports transparent file compression, with three different algorithms available to the user. This is done automatically on a per-file basis, as long as the filesystem is mounted with the <code>-o compress</code> option. The algorithms are smart enough to detect incompressible files and will not try to compress them, saving system resources. So on a single directory you may have compressed and uncompressed files together. The default compression algorithm is ZLIB, but LZO (faster, worse compression ratio) or ZSTD (faster than ZLIB, comparable compression) are available, with multiple compression levels (see the cooresponding objective on mount options).</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_managing_partitions_with_gnu_parted">Managing Partitions with GNU Parted</h3>
<div class="paragraph">
<p><em>GNU Parted</em> is a very powerful partition editor (hence the name) that can be used to create, delete, move, resize, rescue and copy partitions. It can work with both GPT and MBR disks, and cover almost all of your disk management needs.</p>
</div>
<div class="paragraph">
<p>There are many graphical front-ends that make working with <code>parted</code> much easier, like <em>GParted</em> for GNOME-based desktop environments and the <em>KDE Partition Manager</em> for KDE Desktops. However, you should learn how to use <code>parted</code> on the command line, since in a server setting you can never count on a graphical desktop environment being available.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph">
<p>Unlike <code>fdisk</code> and <code>gdisk</code>, parted makes changes to the disk <em>immediately</em> after the command is issued, without waiting for another command to write the changes to disk. When practicing, it is wise to do so on an empty or spare disk or flash drive, so there is no risk of data loss should you make a mistake.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The simplest way to start using parted is by typing <code>parted DEVICE</code>, where <code>DEVICE</code> is the device you want to manage  (<code>parted /dev/sdb</code>). The program starts an interactive command line interface like <code>fdisk</code> and <code>gdisk</code> with a <code>(parted)</code> prompt for you to enter commands.</p>
</div>
<div class="listingblock">
<div class="content">
<pre># <strong>parted /dev/sdb</strong>
GNU Parted 3.2
Using /dev/sdb
Welcome to GNU Parted! Type 'help' to view a list of commands.

(parted)</pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph">
<p>Be careful! If you do not specify a device, <code>parted</code> will automatically select the primary disk (usually <code>/dev/sda</code>) to work with.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_selecting_disks">Selecting Disks</h4>
<div class="paragraph">
<p>To switch to a different disk than the one specified on the command line, you can use the <code>select</code> command, followed by the device name:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>(parted) <strong>select /dev/sdb</strong>
Using /dev/sdb</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_getting_information">Getting Information</h4>
<div class="paragraph">
<p>The <code>print</code> command can be used to get more information about a specific partition or even all of the block devices (disks) connected to your system.</p>
</div>
<div class="paragraph">
<p>To get information about the currently selected partition, just type <code>print</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>(parted) <strong>print</strong>
Model: ATA CT120BX500SSD1 (scsi)
Disk /dev/sda: 120GB
Sector size (logical/physical): 512B/512B
Partition Table: msdos
Disk Flags:

Number  Start   End    Size    Type     File system     Flags
 1      2097kB  116GB  116GB   primary  ext4
 2      116GB   120GB  4295MB  primary  linux-swap(v1)</pre>
</div>
</div>
<div class="paragraph">
<p>You can get a list of all block devices connected to your system using <code>print devices</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>(parted) <strong>print devices</strong>
/dev/sdb (1999MB)
/dev/sda (120GB)
/dev/sdc (320GB)
/dev/mapper/cryptswap (4294MB)</pre>
</div>
</div>
<div class="paragraph">
<p>To get information about all connected devices at once, you can use <code>print all</code>. If you wish to know how much free space there is in each one of them, you can use <code>print free</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>(parted) <strong>print free</strong>
Model: ATA CT120BX500SSD1 (scsi)
Disk /dev/sda: 120GB
Sector size (logical/physical): 512B/512B
Partition Table: msdos
Disk Flags:

Number  Start   End     Size    Type     File system     Flags
        32.3kB  2097kB  2065kB           Free Space
 1      2097kB  116GB   116GB   primary  ext4
        116GB   116GB   512B             Free Space
 2      116GB   120GB   4295MB  primary  linux-swap(v1)
        120GB   120GB   2098kB           Free Space</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_creating_a_partition_table_on_an_empty_disk">Creating a Partition Table on an Empty Disk</h4>
<div class="paragraph">
<p>To create a partition table on an empty disk, use the <code>mklabel</code> command, followed by the partition table type that you want to use.</p>
</div>
<div class="paragraph">
<p>There are many supported partition table types, but the main types you should know of are <code>msdos</code> which is used here to refer to an MBR partition table, and <code>gpt</code> to refer to a GPT partition table. To create an MBR partition table, type:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>(parted) <strong>mklabel msdos</strong></pre>
</div>
</div>
<div class="paragraph">
<p>And to create a GPT partition table, the command is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>(parted) <strong>mklabel gpt</strong></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_creating_a_partition_3">Creating a Partition</h4>
<div class="paragraph">
<p>To create a partition the command <code>mkpart</code> is used, using the syntax <code>mkpart PARTTYPE FSTYPE START END</code>, where:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>PARTTYPE</code></dt>
<dd>
<p>Is the partition type, which can be <code>primary</code>, <code>logical</code> or <code>extended</code> in case an MBR partition table is used.</p>
</dd>
<dt class="hdlist1"><code>FSTYPE</code></dt>
<dd>
<p>Specifies which filesystem will be used on this partition. Note that <code>parted</code> will <em>not</em> create the filesystem. It just sets a flag on the partition which tells the OS what kind of data to expect from it.</p>
</dd>
<dt class="hdlist1"><code>START</code></dt>
<dd>
<p>Specifies the exact point on the device where the partition begins. You can use different units to specify this point. <code>2s</code> can be used to refer to the second sector of the disk, while <code>1m</code> refers to the beginning of the first megabyte of the disk. Other common units are <code>B</code> (bytes) and <code>%</code> (percentage of the disk).</p>
</dd>
<dt class="hdlist1"><code>END</code></dt>
<dd>
<p>Specifies the end of the partition. Note that this is <em>not</em> the size of the partition, this is <em>the point on the disk where it ends</em>. For example, if you specify <code>100m</code> the partition will end 100 MB after the start of the disk. You can use the same units as in the <code>START</code> parameter.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>So, the command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>(parted) <strong>mkpart primary ext4 1m 100m</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Creates a primary partition of type <code>ext4</code>, starting at the first megabyte of the disk, and ending after the 100th megabyte.</p>
</div>
</div>
<div class="sect3">
<h4 id="_removing_a_partition">Removing a Partition</h4>
<div class="paragraph">
<p>To remove a partition, use the command <code>rm</code> followed by the partition number, which you can display using the <code>print</code> command. So, <code>rm 2</code> would remove the second partition on the currently selected disk.</p>
</div>
</div>
<div class="sect3">
<h4 id="_recovering_partitions">Recovering Partitions</h4>
<div class="paragraph">
<p><code>parted</code> can recover a deleted partition. Consider you have the following partition structure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Number  Start   End     Size    File system  Name     Flags
 1      1049kB  99.6MB  98.6MB  ext4         primary
 2      99.6MB  200MB   100MB   ext4         primary
 3      200MB   300MB   99.6MB  ext4         primary</pre>
</div>
</div>
<div class="paragraph">
<p>By accident, you removed partition 2 using <code>rm 2</code>. To recover it, you can use the <code>rescue</code> command, with the syntax <code>rescue START END</code>, where <code>START</code> is the approximate location where the partition started, and <code>END</code> the approximate location where it ended.</p>
</div>
<div class="paragraph">
<p><code>parted</code> will scan the disk in search of partitions, and offer to restore any that are found. In the example above the partition <code>2</code> started at 99,6 MB and ended at 200 MB. So you can use the following command to recover the partition:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>(parted) <strong>rescue 90m 210m</strong>
Information: A ext4 primary partition was found at 99.6MB -> 200MB.
Do you want to add it to the partition table?

Yes/No/Cancel? <strong>y</strong></pre>
</div>
</div>
<div class="paragraph">
<p>This will recover the partition and its contents. Note that <code>rescue</code> can only recover partitions that have a filesystem installed on them. Empty partitions are not detected.</p>
</div>
</div>
<div class="sect3">
<h4 id="_resizing_ext234_partitions">Resizing ext2/3/4 Partitions</h4>
<div class="paragraph">
<p><code>parted</code> can be used to resize partitions to make them bigger or smaller. However, there are some caveats:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>During resizing the partition must be unused and unmounted.</p>
</li>
<li>
<p>You need enough free space <em>after</em> the partition to grow it to the size you want.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The command is <code>resizepart</code>, followed by the partition number and where it should end. For example, if you have the following partition table:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Number  Start   End     Size    File system  Name     Flags
 1      1049kB  99.6MB  98.6MB  ext4         primary
 2      99.6MB  200MB   100MB   ext4
 3      200MB   300MB   99.6MB  ext4         primary</pre>
</div>
</div>
<div class="paragraph">
<p>Trying to grow partition <code>1</code> using <code>resizepart</code> would trigger an error message, because with the new size partition <code>1</code> would overlap with partition <code>2</code>. However partition <code>3</code> can be resized as there is free space after it, which can be verified with the command <code>print free</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>(parted) <strong>print free</strong>
Model: Kingston DataTraveler 2.0 (scsi)
Disk /dev/sdb: 1999MB
Sector size (logical/physical): 512B/512B
Partition Table: gpt
Disk Flags:

 Number  Start   End     Size    File system  Name     Flags
        17.4kB  1049kB  1031kB  Free Space
 1      1049kB  99.6MB  98.6MB  ext4         primary
 2      99.6MB  200MB   100MB   ext4
 3      200MB   300MB   99.6MB  ext4         primary
        300MB   1999MB  1699MB  Free Space</pre>
</div>
</div>
<div class="paragraph">
<p>So you can use the following command to resize partition 3 to 350 MB:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>(parted) <strong>resizepart 3 350m</strong>

(parted) print
Model: Kingston DataTraveler 2.0 (scsi)
Disk /dev/sdb: 1999MB
Sector size (logical/physical): 512B/512B
Partition Table: gpt
Disk Flags:

Number  Start   End     Size    File system  Name     Flags
 1      1049kB  99.6MB  98.6MB  ext4         primary
 2      99.6MB  200MB   100MB   ext4
 3      200MB   350MB   150MB   ext4         primary</pre>
</div>
</div>
<div class="paragraph">
<p>Remember that the new end point is specified counting from the start of the disk. So, because partition <code>3</code> ended at 300 MB, now it needs to end at 350 MB.</p>
</div>
<div class="paragraph">
<p>But resizing the partition is only one part of the task. You also need to resize the filesystem that resides in it. For ext2/3/4 filesystems this is done with the <code>resize2fs</code> command. In the case of the example above, partition 3 still shows the &#8220;old&#8221; size when mounted:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>df -h /dev/sdb3</strong>
Filesystem      Size  Used Avail Use% Mounted on
/dev/sdb3        88M  1.6M   80M   2% /media/carol/part3</pre>
</div>
</div>
<div class="paragraph">
<p>To adjust the size the command <code>resize2fs DEVICE SIZE</code> can be used, where <code>DEVICE</code> corresponds to the partition you want to resize, and <code>SIZE</code> is the new size. If you omit the size parameter, it will use all of the available space of the partition. Before resizing, it is advised to unmount the partition.</p>
</div>
<div class="paragraph">
<p>In the example above:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>sudo resize2fs /dev/sdb3</strong>
resize2fs 1.44.6 (5-Mar-2019)
Resizing the filesystem on /dev/sdb3 to 146212 (1k) blocks.
The filesystem on /dev/sdb3 is now 146212 (1k) blocks long.

$ <strong>df -h /dev/sdb3</strong>
Filesystem      Size  Used Avail Use% Mounted on
/dev/sdb3       135M  1.6M  123M   2% /media/carol/part3</pre>
</div>
</div>
<div class="paragraph">
<p>To <em>shrink</em> a partition, the process needs to be done in the reverse order. <em>First</em> you resize the filesystem to the new, smaller size, then you resize the partition itself using <code>parted</code>.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph">
<p>Pay attention when shrinking partitions. If you get the order of things wrong, you will lose data!</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In our example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># <strong>resize2fs /dev/sdb3 88m</strong>
resize2fs 1.44.6 (5-Mar-2019)
Resizing the filesystem on /dev/sdb3 to 90112 (1k) blocks.
The filesystem on /dev/sdb3 is now 90112 (1k) blocks long.

# <strong>parted /dev/sdb3</strong>
(parted) resizepart 3 300m
Warning: Shrinking a partition can cause data loss, are you sure
you want to continue?

Yes/No? <strong>y</strong>

(parted) <strong>print</strong>
Model: Kingston DataTraveler 2.0 (scsi)
Disk /dev/sdb: 1999MB
Sector size (logical/physical): 512B/512B
Partition Table: gpt
Disk Flags:

Number  Start   End     Size    File system  Name     Flags
 1      1049kB  99.6MB  98.6MB  ext4         primary
 2      99.6MB  200MB   100MB   ext4
 3      200MB   300MB   99.7MB  ext4         primary</pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph">
<p>Instead of specifying a new size, you can use the <code>-M</code> parameter of <code>resize2fs</code> to adjust the size of the filesystem so it is just big enough for the files on it.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_creating_swap_partitions">Creating Swap Partitions</h3>
<div class="paragraph">
<p>On Linux, the system can swap memory pages from RAM to disk as needed, storing them on a separate space usually implemented as a separate partition on a disk, called the <em>swap partition</em> or simply <em>swap</em>. This partition needs to be of a specific type, and set-up with a proper utility (<code>mkswap</code>) before it can be used.</p>
</div>
<div class="paragraph">
<p>To create the swap partition using <code>fdisk</code> or <code>gdisk</code>, just proceed as if you were creating a regular partition, as explained before. The only difference is that you will need to change the partition type to <em>Linux swap</em>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>On <code>fdisk</code> use the <code>t</code> command. Select the partition you want to use and change its type to <code>82</code>. Write changes to disk and quit with <code>w</code>.</p>
</li>
<li>
<p>On <code>gdisk</code> the command to change the partition type is also <code>t</code>, but the code is <code>8200</code>. Write changes to disk and quit with <code>w</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you are using <code>parted</code>, the partition should be identified as a swap partition during creation, just use <code>linux-swap</code> as the filesystem type. For example, the command to create a 500 MB swap partition, starting at 300 MB on disk is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>(parted) <strong>mkpart primary linux-swap 301m 800m</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Once the partition is created and properly identified, just use <code>mkswap</code> followed by the device representing the partition you want to use, like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># <strong>mkswap /dev/sda2</strong></pre>
</div>
</div>
<div class="paragraph">
<p>To enable swap on this partition, use <code>swapon</code> followed by the device name:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># <strong>swapon /dev/sda2</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Similarly, <code>swapoff</code>, followed by the device name, will disable swap on that device.</p>
</div>
<div class="paragraph">
<p>Linux also supports the use of swap <em>files</em> instead of partitions. Just create an empty file of the size you want using <code>dd</code> and then use <code>mkswap</code> and <code>swapon</code> with this file as the target.</p>
</div>
<div class="paragraph">
<p>The following commands will create a 1 GB file called <code>myswap</code> in the current directory, filled with zeroes, and than set-up and enable it as a swap file.</p>
</div>
<div class="paragraph">
<p>Create the swap file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>dd if=/dev/zero of=myswap bs=1M count=1024</strong>
1024+0 records in
1024+0 records out
1073741824 bytes (1.1 GB, 1.0 GiB) copied, 7.49254 s, 143 MB/s</pre>
</div>
</div>
<div class="paragraph">
<p><code>if=</code> is the input file, the source of the data that will be written to the file. In this case it is the <code>/dev/zero</code> device, which provides as many <code>NULL</code> characters as requested. <code>of=</code> is the output file, the file that will be created. <code>bs=</code> is the size of the data blocks, here specified in Megabytes, and <code>count=</code> is the amount of blocks to be written to the output. 1024 blocks of 1 MB each equals 1 GB.</p>
</div>
<div class="listingblock">
<div class="content">
<pre># <strong>mkswap myswap</strong>
Setting up swapspace version 1, size = 1024 MiB (1073737728 bytes)
no label, UUID=49c53bc4-c4b1-4a8b-a613-8f42cb275b2b

# <strong>swapon myswap</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Using the commands above, this swap file will be used only during the current system session. If the machine is rebooted, the file will still be available, but will not be automatically loaded. You can automate that by adding the new swap file to <code>/etc/fstab</code>, which we will discuss in a later lesson.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph">
<p>Both <code>mkswap</code> and <code>swapon</code> will complain if your swap file has insecure permissions. The recommended file permission flag is <code>0600</code>. Owner and group should be <code>root.</code></p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec.104.1_01-GE">Guided Exercises</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Which partitioning scheme should be used to partition a 3 TB hard disk into three 1 GB partitions? Why?</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>On <code>gdisk</code>, how can we find out how much space is available on the disk?</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>What would be the command to create an ext3 filesystem, checking for bad blocks before, with the label <code>MyDisk</code> and a random UUID, on the device <code>/dev/sdc1</code>?</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Using <code>parted</code>, what is the command to create a 300 MB ext4 partition, starting at 500 MB on the disk?</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Imagine you have 2 partitions, one on <code>/dev/sda1</code> and the other on <code>/dev/sda2</code>, both 20 GB in size. How can you use them on a single Btrfs filesystem, in such a way that the contents of one partition will be automatically mirrored on the other, like on a RAID1 setup? How big will the filesystem be?</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec.104.1_01-EE">Explorational Exercises</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Consider a 2 GB disk with an MBR partition table and the following layout:</p>
<div class="listingblock">
<div class="content">
<pre>Disk /dev/sdb: 1.9 GiB, 1998631936 bytes, 3903578 sectors
Disk model: DataTraveler 2.0
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disklabel type: dos
Disk identifier: 0x31a83a48

Device     Boot   Start     End Sectors  Size Id Type
/dev/sdb1          2048 1050623 1048576  512M 83 Linux
/dev/sdb3       2099200 3147775 1048576  512M 83 Linux</pre>
</div>
</div>
<div class="paragraph">
<p>Can you create a 600 MB partition on it? Why?</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>On a disk at <code>/dev/sdc</code>, we have a first partition of 1 GB, containing about 256 MB of files. Using <code>parted</code>, how can you shrink it so it has just enough space for the files?</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Imagine you have a disk at <code>/dev/sdb</code>, and you want to create a 1 GB swap partition at the start of it. So, using <code>parted</code>, you create the partition with <code>mkpart primary linux-swap 0 1024M</code>. Then, you enable swap on this partition with <code>swapon /dev/sdb1</code>, but get the following error message:</p>
<div class="paragraph">
<p><code>swapon: /dev/sdb1: read swap header failed</code></p>
</div>
<div class="paragraph">
<p>What went wrong?</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>During the course of this lesson, you were trying out some commands in <code>parted</code> but, by mistake, deleted the 3rd partition on your hard disk. You know that it came after a 250 MB UEFI partition and a 4 GB swap partition, and was 10 GB in size. Which command can you use to recover it?</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Imagine you have a 4 GB unused partition on <code>/dev/sda3</code>. Using <code>fdisk</code>, what would be the sequence of operations to turn it into an active swap partition?</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec.104.1_01-SU">Summary</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this lesson, you learned:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>How to create an MBR partition table on a disk with <code>fdisk</code>, and how to use it to create and delete partitions.</p>
</li>
<li>
<p>How to create an MBR partition table on a disk with <code>gdisk</code>, and how to use it to create and delete partitions.</p>
</li>
<li>
<p>How to create ext2, ext3, ext4, XFS, VFAT and exFAT partitions.</p>
</li>
<li>
<p>How to use <code>parted</code> to create, delete and recover partitions on both MBR and GPT disks.</p>
</li>
<li>
<p>How to use resize ext2, ext3, ext4 and Brts partitions.</p>
</li>
<li>
<p>How to create, set-up and activate swap partitions and swap files.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following commands were discussed in this lesson:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>fdisk</code></p>
</li>
<li>
<p><code>gdisk</code></p>
</li>
<li>
<p><code>mkfs.ext2</code>, <code>mkfs.ext3</code>, <code>mkfs.ext4</code>, <code>mkfs.xfs</code>, <code>mkfs.vfat</code> and <code>mkfs.exfat</code></p>
</li>
<li>
<p><code>parted</code></p>
</li>
<li>
<p><code>btrfs</code></p>
</li>
<li>
<p><code>mkswap</code></p>
</li>
<li>
<p><code>swapon</code> and <code>swapoff</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec.104.1_01-AGE">Answers to Guided Exercises</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Which partitioning scheme should be used to partition a 3 TB hard disk into three 1 GB partitions? Why?</p>
<div class="paragraph">
<p>GPT, as MBR supports at most 2 TB hard disks.</p>
</div>
</li>
<li>
<p>On <code>gdisk</code>, how can we find out how much space is available on the disk?</p>
<div class="paragraph">
<p>Use <code>p</code> (print). The total free space will be shown as the last line of information before the partition table itself.</p>
</div>
</li>
<li>
<p>What would be the command to create an ext3 filesystem, checking for bad blocks before, with the label <code>MyDisk</code> and a random UUID, on the device <code>/dev/sdc1</code>?</p>
<div class="paragraph">
<p>The command would be <code>mkfs.ext3 -c -L MyDisk -U random /dev/sdc1</code>. Alternatively, <code>mk2efs -t ext3</code> can also be used instead of <code>mkfs.ext3</code></p>
</div>
</li>
<li>
<p>Using <code>parted</code>, what is the command to create a 300 MB ext4 partition, starting at 500 MB on the disk?</p>
<div class="paragraph">
<p>Use <code>mkpart primary ext4 500m 800m</code>. Remember that you will have to create the filesystem using <code>mkfs.ext4</code>, as parted does not do this.</p>
</div>
</li>
<li>
<p>Imagine you have 2 partitions, one on <code>/dev/sda1</code> and the other on <code>/dev/sdb1</code>, both 20 GB in size. How can you use them on a single Btrfs filesystem, in such a way that the contents of one partition will be automatically mirrored on the other, like on a RAID1 setup? How big will the filesystem be?</p>
<div class="paragraph">
<p>Use <code>mkfs.btrfs /dev/sda1 /dev/sdb1 -m raid1</code>. The resulting filesystem will be 20 GB in size, as one partition acts simply as a mirror of the other.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec.104.1_01-AEE">Answers to Explorational Exercises</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>Consider a 2 GB disk with an MBR partition table and the following layout:</p>
<div class="listingblock">
<div class="content">
<pre>Disk /dev/sdb: 1.9 GiB, 1998631936 bytes, 3903578 sectors
Disk model: DataTraveler 2.0
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disklabel type: dos
Disk identifier: 0x31a83a48

Device     Boot   Start     End Sectors  Size Id Type
/dev/sdb1          2048 1050623 1048576  512M 83 Linux
/dev/sdb3       2099200 3147775 1048576  512M 83 Linux</pre>
</div>
</div>
<div class="paragraph">
<p>Can you create a 600 MB partition on it? Why?</p>
</div>
<div class="paragraph">
<p>You cannot, because there is not enough contiguous space. The first clue that something is &#8220;off&#8221; is the list of devices: you have <code>/dev/sdb1</code> and <code>/dev/sdb3</code>, but no <code>/dev/sdb2</code>. So, something is missing.</p>
</div>
<div class="paragraph">
<p>Then, you need to look where a partition ends and the other one begins. Partition one ends at sector <code>1050623</code>, and partition 2 starts at <code>2099200</code>. That&#8217;s a &#8220;gap&#8221; of 1048577 sectors. At 512 bytes per sector, that&#8217;s 536.871.424 bytes. If you divide it by 1024 you get 524.288 Kilobytes. Divide by 1024 again and you get&#8230;&#8203; 512 MB. This is the size of the &#8220;gap&#8221;.</p>
</div>
<div class="paragraph">
<p>If the disk it 2 GB, then we wave at most another 512 MB after partition 3. Even if we have in total around 1 GB unallocated, the biggest contiguous block is 512 MB. So, there is no space for a 600 MB partition.</p>
</div>
</li>
<li>
<p>On a disk at <code>/dev/sdc</code>, we have a first partition of 1 GB, containing an ext4 filesystem with 241 MB of files. Using <code>parted</code>, how can you shrink it so it has just enough space for the files?</p>
<div class="paragraph">
<p>This is a multi-part operation. First you have to shrink the filesystem using <code>resize2fs</code>. Instead of specifying the new size directly, you can use the <code>-M</code> parameter so it is just &#8220;big enough&#8221;. So: <code>resize2fs -M /dev/sdc1</code>.</p>
</div>
<div class="paragraph">
<p>Then, you resize the partition itself with parted using <code>resizepart</code>. Since it is the first partition, we can assume that it starts at zero and ends at 241 MB. So the command is <code>resizepart 1 241M</code>.</p>
</div>
</li>
<li>
<p>Imagine you have a disk at <code>/dev/sdb</code>, and you want to create a 1 GB partition at the start of it. So, using <code>parted</code>, you create the partition with <code>mkpart primary linux-swap 0 1024M</code>. Then, you enable swap on this partition with <code>swapon /dev/sdb1</code>, but get the following error message:</p>
<div class="paragraph">
<p><code>swapon: /dev/sdb1: read swap header failed</code></p>
</div>
<div class="paragraph">
<p>What went wrong?</p>
</div>
<div class="paragraph">
<p>You created a partition of the correct type (<code>linux-swap</code>), but remember that <code>mkpart</code> <em>does not create a filesystem</em>. You forgot to set-up the partition as a swap space first with <code>mkswap</code> before using it.</p>
</div>
</li>
<li>
<p>During the course of this lesson, you were trying out some commands in <code>parted</code> but, by mistake, deleted the 3rd partition on your hard disk. You know that it came after a 250 MB EFI partition and a 4 GB swap partition, and was 10 GB in size. Which <code>parted</code> command can you use to recover it?</p>
<div class="paragraph">
<p>Don&#8217;t panic, you have all the information you need to recover the partition, just use <code>rescue</code> and do the math. You had 250 MB + 4.096 MB (4*1024) before it, so the start point should be around 4346 MB. Plus 10.240 MB (10*1024) in size, it should end at 14.586 MB. So, <code>rescue 4346m 14586m</code> should to the trick. You might need to give some &#8220;slack&#8221; to rescue, starting a little early and ending a little late, depending on the geometry of your disk.</p>
</div>
</li>
<li>
<p>Imagine you have a 4 GB unused partition on <code>/dev/sda3</code>. Using <code>fdisk</code>, what would be the sequence of operations to turn it into an active swap partition?</p>
<div class="paragraph">
<p>First, change the partition type to &#8220;Linux Swap&#8221; (82), write your changes to disk and quit. Then, use <code>mkswap</code> to set up the partition as a swap area. Then, use <code>swapon</code> to enable it.</p>
</div>
</li>
</ol>
</div>
</div>
</div>

        
      </section>
    </div>

    <aside class="lesson__license smallprint">
  <div class="container">
    
    <p>© 2020 Linux Professional Insitute Inc. All rights reserved. Visit the Learning Materials website: https://learning.lpi.org<br />
       This work is licensed under the Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License.</p>
  </div>
</aside>


    
    
    <aside class="lesson__teaser teaser">
      <div class="container teaser__container">
        <h2 class="label">Next Lesson</h2>
        <p class="headline teaser__headline">104.2 Maintain the integrity of filesystems (104.2 Lesson 1)</p>

        <div class="button-group">
            <a href="../../104.2/104.2_01/index.html" class="button -primary">Read next lesson</a>
        </div>
      </div>
    </aside>
    
  </div>
</div>

<div class="lesson-progress">
  <div class="lesson-progress__current"></div>
</div>

      </main>
    </td></tr></tbody>
    <tfoot><tr><td class="print__cell">
      <div class="print__space -footer"></div>
    </td></tr></tfoot>
  </table>

  <table class="print-footer">
  <tr class="print-footer__body">
    <td class="print-footer__cell -image">
      <img src="index.html" alt="" class="print-footer__image">
    </td>
    <td class="print-footer__cell -center">
      <p>© 2020 Linux Professional Insitute Inc. All rights reserved. Visit the Learning Materials website: https://learning.lpi.org<br />
         This work is licensed under the Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License.</p>
    </td>
    <td class="print-footer__cell -image">
      <img src="index.html" alt="" class="print-footer__license">
    </td>
  </tr>
</table>

<footer class="footer">
  <div class="container footer__container columns">
    <div class="column">
      <h2>LPI is a non-profit organization.</h2>
      <p>Linux Professional Institute (LPI) is the global certification standard and career support organization for open source professionals. With more than 200,000 certification holders, it&#39;s the world’s first and largest vendor-neutral Linux and open source certification body. LPI has certified professionals in over 180 countries, delivers exams in multiple languages, and has hundreds of training partners.</p>
      <p>Our purpose is to enable economic and creative opportunities for everybody by making open source knowledge and skills certification universally accessible.</p>
    </div>

    <div class="column">
      <ul class="footer__social social">
        <li class="social__item -linkedin">
          <a class="social__link" href="https://www.linkedin.com/company/35136" target="_blank" rel="noreferrer">
            <svg version="1.1"  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 viewBox="0 0 42.3 36" enable-background="new 0 0 42.3 36" xml:space="preserve">
<g>
	<g>
		<g>
			<path fill="#010202" d="M33.3,0H2.7C1.2,0,0,1.2,0,2.6v30.8C0,34.8,1.2,36,2.7,36h30.7c1.5,0,2.7-1.2,2.7-2.6V2.6
				C36,1.2,34.8,0,33.3,0z M10.7,30.7H5.3V13.5h5.3V30.7z M8,11.1c-1.7,0-3.1-1.4-3.1-3.1C4.9,6.3,6.3,5,8,5c1.7,0,3.1,1.4,3.1,3.1
				C11.1,9.8,9.7,11.1,8,11.1z M30.7,30.7h-5.3v-8.4c0-2,0-4.6-2.8-4.6c-2.8,0-3.2,2.2-3.2,4.4v8.5H14V13.5h5.1v2.3h0.1
				c0.7-1.4,2.5-2.8,5.1-2.8c5.4,0,6.4,3.6,6.4,8.2V30.7z"/>
		</g>
	</g>
	<g>
		<polygon fill="#010202" points="37.5,28.5 38.2,28.5 38.2,30.7 38.6,30.7 38.6,28.5 39.3,28.5 39.3,28.1 37.5,28.1 		"/>
		<polygon fill="#010202" points="41.7,28.1 41,30 40.3,28.1 39.7,28.1 39.7,30.7 40.1,30.7 40.1,28.8 40.9,30.7 41.1,30.7
			41.9,28.8 41.9,30.7 42.3,30.7 42.3,28.1 		"/>
	</g>
</g>
</svg>

            <span class="social__link__text">LinkedIn</span>
          </a>
        </li>
        <li class="social__item -facebook">
          <a class="social__link" href="https://www.facebook.com/LPIConnect" target="_blank" rel="noreferrer">
            <svg version="1.1"  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 viewBox="0 0 36 36" enable-background="new 0 0 36 36" xml:space="preserve">
<title>flogo-RGB-HEX-Blk-58</title>
<path d="M34,0H2C0.9,0,0,0.9,0,2v32c0,1.1,0.9,2,2,2h17.3V22.1h-4.7v-5.4h4.7v-4c0-4.6,2.8-7.2,7-7.2c0,0,0,0,0,0c0,0,0,0,0,0
	c0.4,0,0.9,0,1.3,0c0.3,0,0.5,0,0.8,0c0.7,0,1.4,0.1,2.1,0.2v4.9v0h-2.9c-0.3,0-0.5,0-0.8,0c-1.6,0.2-1.9,1.2-1.9,2.6v3.5h5.4
	l-0.7,5.4h0l0,0h-4.7V36H34c1.1,0,2-0.9,2-2V2C36,0.9,35.1,0,34,0z"/>
</svg>

            <span class="social__link__text">Facebook</span>
          </a>
        </li>
        <li class="social__item -twitter">
          <a class="social__link" href="https://twitter.com/lpiconnect" target="_blank" rel="noreferrer">
            <svg version="1.1" id="Logo_FIXED" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 viewBox="0 0 36 36" enable-background="new 0 0 36 36" xml:space="preserve">
<path d="M11.3,32.6c13.6,0,21-11.3,21-21c0-0.3,0-0.6,0-1c1.4-1,2.7-2.3,3.7-3.8c-1.3,0.6-2.8,1-4.2,1.2c1.5-0.9,2.7-2.4,3.2-4.1
	c-1.4,0.9-3,1.5-4.7,1.8c-2.8-3-7.5-3.1-10.5-0.3c-1.9,1.8-2.7,4.5-2.1,7.1C11.8,12.1,6.3,9.3,2.5,4.7c-2,3.4-1,7.7,2.3,9.9
	c-1.2,0-2.3-0.4-3.4-0.9c0,0,0,0.1,0,0.1c0,3.5,2.5,6.5,5.9,7.2c-1.1,0.3-2.2,0.3-3.3,0.1c1,3,3.7,5.1,6.9,5.1
	c-2.6,2.1-5.8,3.2-9.2,3.2c-0.6,0-1.2,0-1.8-0.1C3.4,31.5,7.3,32.6,11.3,32.6"/>
</svg>

            <span class="social__link__text">Twitter</span>
          </a>
        </li>
      </ul>
    </div>
  </div>

  <div class="container footer__secondary">
    <ul class="footer__links">
      <li><a href="https://www.lpi.org/about-lpi/contact-us" class="footer__link" target="_blank" rel="noreferrer">Contact Us</a></li>
      <li><a href="https://www.lpi.org/privacy-and-cookie-policy" class="footer__link" target="_blank" rel="noreferrer">Privacy and Cookie Policy</a></li>
    </ul>

    <p><strong>Spot a mistake or want to help improve this page? Please <a href="https://www.lpi.org/about-lpi/contact-us" target="_blank" rel="noreferrer">let us know</a>.</strong></p>
    <p>© Copyright 1999-2020 The Linux Professional Institute Inc. All rights reserved.</p>
  </div>
</footer>


  
  
  

  <script src="https://unpkg.com/swiper/swiper-bundle.min.js" type="application/javascript"></script>
  <script src="../../../../../../js/bundle.js"></script>
</body>
</html>
