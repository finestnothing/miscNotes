

<!DOCTYPE html>
<html lang="en-us">
<head>


  
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-WMC4KTP');</script>
  



  <meta charset="utf-8"/>
  <title>103.7 Lesson 2</title>

  <link rel="stylesheet" href="../../../../../../scss/styles.min.css">

  
  <link rel="apple-touch-icon" sizes="152x152" href="https://learning.lpi.org/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="https://learning.lpi.org/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="https://learning.lpi.org/favicon-16x16.png">
  <link rel="manifest" href="https://learning.lpi.org/site.webmanifest">
  <link rel="mask-icon" href="https://learning.lpi.org/safari-pinned-tab.svg" color="#fbc000">
  <meta name="msapplication-TileColor" content="#ffc40d">
  <meta name="theme-color" content="#ffffff">

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body class="page">



  
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WMC4KTP"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  



  

<header class="header">
  <span class="header__nav -clone"></span>

  <a href="https://learning.lpi.org/" class="header__logo-link">
    <img class="header__logo" src="../../../../../../lpi-learning-logo.svg" alt="Linux Professional Institute Learning Logo.">
  </a>

  <nav class="header__nav nav">
    <a href="index.html#content" class="nav__skip">Skip to main content</a>

    <button class="nav__button" aria-hidden="true">
      <span></span>
      <span></span>
      <span></span>
    </button>

    <div class="nav__menus">
      <ul class="nav__menu">
        
          <li class="nav__item
              
              
              ">


            
              <a href="https://learning.lpi.org/en/" class="nav__link">Home</a>
            


            
          </li>
        
          <li class="nav__item
              -has-submenu
              -is-active
              ">


            
              <button class="nav__link" type="button">Learning Materials</button>
            


            
              <ul class="nav__menu -submenu">
                
                  <li class="nav__item
                      ">
                    <a href="https://learning.lpi.org/en/learning-materials/all-materials/" class="nav__link
                      ">All Resources</a>
                  </li>
                
                  <li class="nav__item
                      ">
                    <a href="https://learning.lpi.org/en/learning-materials/learning-materials/" class="nav__link
                      ">LPI Learning Materials</a>
                  </li>
                
                  <li class="nav__item
                      ">
                    <a href="https://learning.lpi.org/en/learning-materials/become-contributor/" class="nav__link
                      ">Become a Contributor</a>
                  </li>
                
              </ul>
            
          </li>
        
          <li class="nav__item
              -has-submenu
              
              ">


            
              <button class="nav__link" type="button">Publishing Partners</button>
            


            
              <ul class="nav__menu -submenu">
                
                  <li class="nav__item
                      ">
                    <a href="https://learning.lpi.org/en/lpi-publishing-partner/lpp-partners/" class="nav__link
                      ">Publishing Partners</a>
                  </li>
                
                  <li class="nav__item
                      ">
                    <a href="https://learning.lpi.org/en/lpi-publishing-partner/become-lpp/" class="nav__link
                      ">Become a Publishing Partner</a>
                  </li>
                
              </ul>
            
          </li>
        
          <li class="nav__item
              -has-submenu
              
              ">


            
              <button class="nav__link" type="button">About</button>
            


            
              <ul class="nav__menu -submenu">
                
                  <li class="nav__item
                      ">
                    <a href="https://learning.lpi.org/en/about/about/" class="nav__link
                      ">About</a>
                  </li>
                
                  <li class="nav__item
                      ">
                    <a href="https://learning.lpi.org/en/about/faq/" class="nav__link
                      ">FAQ</a>
                  </li>
                
                  <li class="nav__item
                      ">
                    <a href="https://learning.lpi.org/en/about/lm-contributors/" class="nav__link
                      ">Contributors</a>
                  </li>
                
                  <li class="nav__item
                      ">
                    <a href="https://learning.lpi.org/en/about/roadmap/" class="nav__link
                      ">Roadmap</a>
                  </li>
                
                  <li class="nav__item
                      ">
                    <a href="https://learning.lpi.org/en/about/contact/" class="nav__link
                      ">Contact</a>
                  </li>
                
              </ul>
            
          </li>
        
      </ul>

      <ul class="nav__menu -secondary">
        <li class="nav__item -lang-select">
        
<select name="language-picker" id="lang-select" class="lang-select" title='Language' aria-label='Language'>
  
    <option value="es"
      >Español</option>
  
    <option value="de"
      >Deutsch</option>
  
    <option value="en"
      selected>English</option>
  
    <option value="it"
      >Italiano</option>
  
    <option value="pt"
      >Português</option>
  
</select>


        </li>
        <li class="nav__item -external">
        <a href="https://lpi.org/" class="nav__link" target="_blank" rel="noreferrer noopener">LPI.org</a>
        </li>
      </ul>
    </div>
  </nav>
</header>


  <table class="print-header">
    <tr class="print-header__body">
      <td class="print-header__cell">103.7 Lesson 2</td>
      <td class="print-header__cell -pagenumber"></td>
    </tr>
  </table>

  <table class="print">
    <thead><tr><td class="print__cell">
      <div class="print__space -header"></div>
    </td></tr></thead>
    <tbody><tr><td class="print__cell">
      <main id="content">




<div class="lesson page-content">
  <div class="lesson__hierarchy page-content__hierarchy">
    <nav class="hierarchy">
  

  <div class="hierarchy__container">
     
      <dl class="hierarchy__section">
        <dt class="hierarchy__heading">Topic 101: System Architecture
          <button class="hierarchy__toggle-button" aria-hidden="true">
            <span class="hierarchy__toggle-button__icon"></span>
          </button>
        </dt>

        
        <dd class="hierarchy__item">
          <a href="../../../101/101.1/index.html" class="hierarchy__link">101.1 Determine and configure hardware settings</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../101/101.1/101.1_01/index.html" class="hierarchy__link">101.1 Lesson 1</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../../101/101.2/index.html" class="hierarchy__link">101.2 Boot the system</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../101/101.2/101.2_01/index.html" class="hierarchy__link">101.2 Lesson 1</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../../101/101.3/index.html" class="hierarchy__link">101.3 Change runlevels / boot targets and shutdown or reboot system</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../101/101.3/101.3_01/index.html" class="hierarchy__link">101.3 Lesson 1</a>
            </li>
            
          </ul>
        </dd>
        
      </dl>
      
      <dl class="hierarchy__section">
        <dt class="hierarchy__heading">Topic 102: Linux Installation and Package Management
          <button class="hierarchy__toggle-button" aria-hidden="true">
            <span class="hierarchy__toggle-button__icon"></span>
          </button>
        </dt>

        
        <dd class="hierarchy__item">
          <a href="../../../102/102.1/index.html" class="hierarchy__link">102.1 Design hard disk layout</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../102/102.1/102.1_01/index.html" class="hierarchy__link">102.1 Lesson 1</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../../102/102.2/index.html" class="hierarchy__link">102.2 Install a boot manager</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../102/102.2/102.2_01/index.html" class="hierarchy__link">102.2 Lesson 1</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../../102/102.3/index.html" class="hierarchy__link">102.3 Manage shared libraries</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../102/102.3/102.3_01/index.html" class="hierarchy__link">102.3 Lesson 1</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../../102/102.4/index.html" class="hierarchy__link">102.4 Use Debian package management</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../102/102.4/102.4_01/index.html" class="hierarchy__link">102.4 Lesson 1</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../../102/102.5/index.html" class="hierarchy__link">102.5 Use RPM and YUM package management</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../102/102.5/102.5_01/index.html" class="hierarchy__link">102.5 Lesson 1</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../../102/102.6/index.html" class="hierarchy__link">102.6 Linux as a virtualization guest</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../102/102.6/102.6_01/index.html" class="hierarchy__link">102.6 Lesson 1</a>
            </li>
            
          </ul>
        </dd>
        
      </dl>
      
      <dl class="hierarchy__section -is-active">
        <dt class="hierarchy__heading">Topic 103: GNU and Unix Commands
          <button class="hierarchy__toggle-button" aria-hidden="true">
            <span class="hierarchy__toggle-button__icon"></span>
          </button>
        </dt>

        
        <dd class="hierarchy__item">
          <a href="../../103.1/index.html" class="hierarchy__link">103.1 Work on the command line</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../103.1/103.1_01/index.html" class="hierarchy__link">103.1 Lesson 1</a>
            </li>
            
            <li class="hierarchy__item">
              <a href="../../103.1/103.1_02/index.html" class="hierarchy__link">103.1 Lesson 2</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../103.2/index.html" class="hierarchy__link">103.2 Process text streams using filters</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../103.2/103.2_01/index.html" class="hierarchy__link">103.2 Lesson 1</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../103.3/index.html" class="hierarchy__link">103.3 Perform basic file management</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../103.3/103.3_01/index.html" class="hierarchy__link">103.3 Lesson 1</a>
            </li>
            
            <li class="hierarchy__item">
              <a href="../../103.3/103.3_02/index.html" class="hierarchy__link">103.3 Lesson 2</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../103.4/index.html" class="hierarchy__link">103.4 Use streams, pipes and redirects</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../103.4/103.4_01/index.html" class="hierarchy__link">103.4 Lesson 1</a>
            </li>
            
            <li class="hierarchy__item">
              <a href="../../103.4/103.4_02/index.html" class="hierarchy__link">103.4 Lesson 2</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../103.5/index.html" class="hierarchy__link">103.5 Create, monitor and kill processes</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../103.5/103.5_01/index.html" class="hierarchy__link">103.5 Lesson 1</a>
            </li>
            
            <li class="hierarchy__item">
              <a href="../../103.5/103.5_02/index.html" class="hierarchy__link">103.5 Lesson 2</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../103.6/index.html" class="hierarchy__link">103.6 Modify process execution priorities</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../103.6/103.6_01/index.html" class="hierarchy__link">103.6 Lesson 1</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../index.html" class="hierarchy__link">103.7 Search text files using regular expressions</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../103.7_01/index.html" class="hierarchy__link">103.7 Lesson 1</a>
            </li>
            
            <li class="hierarchy__item">
              <a href="index.html" class="hierarchy__link">103.7 Lesson 2</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../103.8/index.html" class="hierarchy__link">103.8 Basic file editing</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../103.8/103.8_01/index.html" class="hierarchy__link">103.8 Lesson 1</a>
            </li>
            
          </ul>
        </dd>
        
      </dl>
      
      <dl class="hierarchy__section">
        <dt class="hierarchy__heading">Topic 104: Devices, Linux Filesystems, Filesystem Hierarchy Standard
          <button class="hierarchy__toggle-button" aria-hidden="true">
            <span class="hierarchy__toggle-button__icon"></span>
          </button>
        </dt>

        
        <dd class="hierarchy__item">
          <a href="../../../104/104.1/index.html" class="hierarchy__link">104.1 Create partitions and filesystems</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../104/104.1/104.1_01/index.html" class="hierarchy__link">104.1 Lesson 1</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../../104/104.2/index.html" class="hierarchy__link">104.2 Maintain the integrity of filesystems</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../104/104.2/104.2_01/index.html" class="hierarchy__link">104.2 Lesson 1</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../../104/104.3/index.html" class="hierarchy__link">104.3 Control mounting and unmounting of filesystems</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../104/104.3/104.3_01/index.html" class="hierarchy__link">104.3 Lesson 1</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../../104/104.5/index.html" class="hierarchy__link">104.5 Manage file permissions and ownership</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../104/104.5/104.5_01/index.html" class="hierarchy__link">104.5 Lesson 1</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../../104/104.6/index.html" class="hierarchy__link">104.6 Create and change hard and symbolic links</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../104/104.6/104.6_01/index.html" class="hierarchy__link">104.6 Lesson 1</a>
            </li>
            
          </ul>
        </dd>
        
        <dd class="hierarchy__item">
          <a href="../../../104/104.7/index.html" class="hierarchy__link">104.7 Find system files and place files in the correct location</a>

          <ul class="hierarchy__section -sub">
            
            <li class="hierarchy__item">
              <a href="../../../104/104.7/104.7_01/index.html" class="hierarchy__link">104.7 Lesson 1</a>
            </li>
            
          </ul>
        </dd>
        
      </dl>
      
  </div>
</nav>

  </div>



  <div class="lesson__container page-content__container">
    <div class="container">
      <nav class="lesson__breadcrumb breadcrumb">
        <ol class="breadcrumb__list">
          
          <li class="breadcrumb__item">
            <a href="../../index.html" class="breadcrumb__link">Topic 103: GNU and Unix Commands</a>
          </li>
          
          
          <li class="breadcrumb__item">
            <a href="../index.html" class="breadcrumb__link">103.7 Search text files using regular expressions</a>
          </li>
          
          <li class="breadcrumb__item">
            <a href="index.html" class="breadcrumb__link">103.7 Lesson 2</a>
          </li>
        </ol>
      </nav>

      
      <section class="lesson__content">
        
          <h1>103.7 Lesson 2</h1>
          <div id="preamble">
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch fronttable">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Certificate:</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">LPIC-1</p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Version:</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.0</p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Topic:</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">103 GNU and Unix Commands</p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Objective:</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">103.7 Search text files using regular expressions</p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Lesson:</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">2 of 2</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="sec.103.7_02-IN">Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Streaming data through a chain of piped commands allows for the application of compound filters based on regular expressions.  Regular expressions are an important technique used not only in system administration, but also in <em>data mining</em> and related areas. Two commands are specially suited to manipulate files and text data using regular expressions: <code>grep</code> and <code>sed</code>. <code>grep</code> is a pattern finder and <code>sed</code> is a stream editor. They are useful by themselves, but it is when working together with other processes that they stand out.</p>
</div>
<div class="sect2">
<h3 id="_the_pattern_finder_grep">The Pattern Finder: grep</h3>
<div class="paragraph">
<p>One of the most common uses of <code>grep</code> is to facilitate the inspection of long files, using the regular expression as a filter applied to each line. It can be used to show only the lines starting with a certain term. For example, <code>grep</code> can be used to investigate a configuration file for kernel modules, listing only option lines:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>grep '^options' /etc/modprobe.d/alsa-base.conf</strong>
options snd-pcsp index=-2
options snd-usb-audio index=-2
options bt87x index=-2
options cx88_alsa index=-2
options snd-atiixp-modem index=-2
options snd-intel8x0m index=-2
options snd-via82xx-modem index=-2</pre>
</div>
</div>
<div class="paragraph">
<p>The pipe <code>|</code> character can be employed to redirect the output of a command directly to <code>grep</code>'s input. The following example uses a bracket expression to select lines from <code>fdisk -l</code> output, starting with <code>Disk /dev/sda</code> or <code>Disk /dev/sdb</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># <strong>fdisk -l | grep '^Disk /dev/sd[ab]'</strong>
Disk /dev/sda: 320.1 GB, 320072933376 bytes, 625142448 sectors
Disk /dev/sdb: 7998 MB, 7998537728 bytes, 15622144 sectors</pre>
</div>
</div>
<div class="paragraph">
<p>The mere selection of lines with matches may not be appropriate for a particular task, requiring adjustments to <code>grep</code>'s behavior through its options. For example, option <code>-c</code> or <code>--count</code> tells <code>grep</code> to show how many lines had matches:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># <strong>fdisk -l | grep '^Disk /dev/sd[ab]' -c</strong>
2</pre>
</div>
</div>
<div class="paragraph">
<p>The option can be placed before or after the regular expression. Other important <code>grep</code> options are:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>-c</code> or <code>--count</code></dt>
<dd>
<p>Instead of displaying the search results, only display the total count for how many times a match occurs in any given file.</p>
</dd>
<dt class="hdlist1"><code>-i</code> or <code>--ignore-case</code></dt>
<dd>
<p>Turn the search case-insensitive.</p>
</dd>
<dt class="hdlist1"><code>-f FILE</code> or <code>--file=FILE</code></dt>
<dd>
<p>Indicate a file containing the regular expression to use.</p>
</dd>
<dt class="hdlist1"><code>-n</code> or <code>--line-number</code></dt>
<dd>
<p>Show the number of the line.</p>
</dd>
<dt class="hdlist1"><code>-v</code> or <code>--invert-match</code></dt>
<dd>
<p>Select every line, except those containing matches.</p>
</dd>
<dt class="hdlist1"><code>-H</code> or <code>--with-filename</code></dt>
<dd>
<p>Print also the name of the file containing the line.</p>
</dd>
<dt class="hdlist1"><code>-z</code> or <code>--null-data</code></dt>
<dd>
<p>Rather than have <code>grep</code> treat input and output data streams as separate lines (using the <em>newline</em> by default) instead take the input or output as a sequence of lines.  When combining output from the <code>find</code> command using its <code>-print0</code> option with the <code>grep</code> command, the <code>-z</code> or <code>--null-data</code> option should be used to process the stream in the same manner.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Although activated by default when multiple file paths are given as input, the option <code>-H</code> is not activated for single files. That may be critical in special situations, like when <code>grep</code> is called directly by <code>find</code>, for instance:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>find /usr/share/doc -type f -exec grep -i '3d modeling' "{}" \; | cut -c -100</strong>
artistic aspects of 3D modeling. Thus this might be the application you are
This major approach of 3D modeling has not been supported
oce is a C++ 3D modeling library. It can be used to develop CAD/CAM softwares, for instance [FreeCad</pre>
</div>
</div>
<div class="paragraph">
<p>In this example, <code>find</code> lists every file under <code>/usr/share/doc</code> then passes each one to <code>grep</code>, which in turn performs a case-insensitive search for <code>3d modeling</code> inside the file. The pipe to <code>cut</code> is there just to limit output length to 100 columns. Note, however, that there is no way of knowing from which file the lines came from. This issue is solved by adding <code>-H</code> to <code>grep</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>find /usr/share/doc -type f -exec grep -i -H '3d modeling' "{}" \; | cut -c -100</strong>
/usr/share/doc/openscad/README.md:artistic aspects of 3D modeling. Thus this might be the applicatio
/usr/share/doc/opencsg/doc/publications.html:This major approach of 3D modeling has not been support</pre>
</div>
</div>
<div class="paragraph">
<p>Now it is possible to identify the files where each match was found. To make the listing even more informative, leading and trailing lines can be added to lines with matches:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>find /usr/share/doc -type f -exec grep -i -H -1 '3d modeling' "{}" \; | cut -c -100</strong>
/usr/share/doc/openscad/README.md-application Blender), OpenSCAD focuses on the CAD aspects rather t
/usr/share/doc/openscad/README.md:artistic aspects of 3D modeling. Thus this might be the applicatio
/usr/share/doc/openscad/README.md-looking for when you are planning to create 3D models of machine p
/usr/share/doc/opencsg/doc/publications.html-3D graphics library for Constructive Solid Geometry (CS
/usr/share/doc/opencsg/doc/publications.html:This major approach of 3D modeling has not been support
/usr/share/doc/opencsg/doc/publications.html-by real-time computer graphics until recently.</pre>
</div>
</div>
<div class="paragraph">
<p>The option <code>-1</code> instructs <code>grep</code> to include one line before and one line after when it finds a line with a match. These extra lines are called <em>context lines</em> and are identified in the output by a minus sign after the file name. The same result can be obtained with <code>-C 1</code> or <code>--context=1</code> and other context line quantities may be indicated.</p>
</div>
<div class="paragraph">
<p>There are two complementary programs to grep: <code>egrep</code> and <code>fgrep</code>. The program <code>egrep</code> is equivalent to the command <code>grep -E</code>, which incorporates extra features other than the basic regular expressions. For example, with <code>egrep</code> it is possible to use extended regular expression features, like branching:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>find /usr/share/doc -type f -exec egrep -i -H -1 '3d (modeling|printing)' "{}" \; | cut -c -100</strong>
/usr/share/doc/openscad/README.md-application Blender), OpenSCAD focuses on the CAD aspects rather t
/usr/share/doc/openscad/README.md:artistic aspects of 3D modeling. Thus this might be the applicatio
/usr/share/doc/openscad/README.md-looking for when you are planning to create 3D models of machine p
/usr/share/doc/openscad/RELEASE_NOTES.md-* Support for using 3D-Mouse / Joystick / Gamepad input dev
/usr/share/doc/openscad/RELEASE_NOTES.md:* 3D Printing support: Purchase from a print service partne
/usr/share/doc/openscad/RELEASE_NOTES.md-* New export file formats: SVG, 3MF, AMF
/usr/share/doc/opencsg/doc/publications.html-3D graphics library for Constructive Solid Geometry (CS
/usr/share/doc/opencsg/doc/publications.html:This major approach of 3D modeling has not been support
/usr/share/doc/opencsg/doc/publications.html-by real-time computer graphics until recently.</pre>
</div>
</div>
<div class="paragraph">
<p>In this example either <code>3D modeling</code> or <code>3D printing</code> will match the expression, case-insensitive.  To display only the parts of a text stream that match the expression used by <code>egrep</code>, use the <code>-o</code> option.</p>
</div>
<div class="paragraph">
<p>The program <code>fgrep</code> is equivalent to <code>grep -F</code>, that is, it does not parse regular expressions. It is useful in simple searches where the goal is to match a literal expression. Therefore, special characters like the dollar sign and the dot will be taken literally and not by their meanings in a regular expression.</p>
</div>
</div>
<div class="sect2">
<h3 id="_the_stream_editor_sed">The Stream Editor: sed</h3>
<div class="paragraph">
<p>The purpose of the <code>sed</code> program is to modify text-based data in a non-interactive way. It means that all the editing is made by predefined instructions, not by arbitrarily typing directly into a text displayed on the screen. In modern terms, <code>sed</code> can be understood as a template parser: given a text as input, it places custom content at predefined positions or when it finds a match for a regular expression.</p>
</div>
<div class="paragraph">
<p>Sed, as the name implies, is well suited for text streamed through pipelines. Its basic syntax is <code>sed -f SCRIPT</code> when editing instructions are stored in the file <code>SCRIPT</code> or <code>sed -e COMMANDS</code> to execute <code>COMMANDS</code> directly from the command line. If neither <code>-f</code> or <code>-e</code> are present, <code>sed</code> uses the first non-option parameter as the script file. It is also possible to use a file as the input just by giving its path as an argument to <code>sed</code>.</p>
</div>
<div class="paragraph">
<p><code>sed</code> instructions are composed of a single character, possibly preceded by an address or followed by one or more options, and are applied to each line at a time. Addresses can be a single line number, a regular expression, or a range of lines. For example, the first line of a text stream can be deleted with <code>1d</code>, where <code>1</code> specifies the line where the delete command <code>d</code> will be applied. To clarify <code>sed</code> 's usage, take the output of the command <code>factor `seq 12`</code>, which returns the prime factors for numbers 1 to 12:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>factor `seq 12`</strong>
1:
2: 2
3: 3
4: 2 2
5: 5
6: 2 3
7: 7
8: 2 2 2
9: 3 3
10: 2 5
11: 11
12: 2 2 3</pre>
</div>
</div>
<div class="paragraph">
<p>Deleting the first line with <code>sed</code> is accomplished by <code>1d</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>factor `seq 12` | sed 1d</strong>
2: 2
3: 3
4: 2 2
5: 5
6: 2 3
7: 7
8: 2 2 2
9: 3 3
10: 2 5
11: 11
12: 2 2 3</pre>
</div>
</div>
<div class="paragraph">
<p>A range of lines can be specified with a separating comma:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>factor `seq 12` | sed 1,7d</strong>
8: 2 2 2
9: 3 3
10: 2 5
11: 11
12: 2 2 3</pre>
</div>
</div>
<div class="paragraph">
<p>More than one instruction can be used in the same execution, separated by semicolons. In this case, however, it is important to enclose them with parenthesis so the semicolon is not interpreted by the shell:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>factor `seq 12` | sed "1,7d;11d"</strong>
8: 2 2 2
9: 3 3
10: 2 5
12: 2 2 3</pre>
</div>
</div>
<div class="paragraph">
<p>In this example, two deletion instructions were executed, first on lines ranging from 1 to 7 and then on line 11. An address can also be a regular expression, so only lines with a match will be affected by the instruction:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>factor `seq 12` | sed "1d;/:.*2.*/d"</strong>
3: 3
5: 5
7: 7
9: 3 3
11: 11</pre>
</div>
</div>
<div class="paragraph">
<p>The regular expression <code>:2.*</code> matches with any occurrence of the number 2 anywhere after a colon, causing the deletion of lines corresponding to numbers with 2 as a factor. With <code>sed</code>, anything placed between slashes (<code>/</code>) is considered a regular expression and by default all basic RE is supported. For example, <code>sed -e "/^#/d" /etc/services</code> shows the contents of the file <code>/etc/services</code> without the lines beginning with <code>#</code> (comment lines).</p>
</div>
<div class="paragraph">
<p>The delete instruction <code>d</code> is only one of the many editing instructions provided by <code>sed</code>. Instead of deleting a line, <code>sed</code> can replace it with a given text:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>factor `seq 12` | sed "1d;/:.*2.*/c REMOVED"</strong>
REMOVED
3: 3
REMOVED
5: 5
REMOVED
7: 7
REMOVED
9: 3 3
REMOVED
11: 11
REMOVED</pre>
</div>
</div>
<div class="paragraph">
<p>The instruction <code>c REMOVED</code> simply replaces a line with the text <code>REMOVED</code>. In the example&#8217;s case, every line with a substring matching the regular expression <code>:.*2.*</code> is affected by instruction <code>c REMOVED</code>. Instruction <code>a TEXT</code> copies text indicated by <code>TEXT</code> to a new line after the line with a match. The instruction <code>r FILE</code> does the same, but copies the contents of the file indicated by <code>FILE</code>. Instruction <code>w</code> does the opposite of <code>r</code>, that is, the line will be appended to the indicated file.</p>
</div>
<div class="paragraph">
<p>By far the most used <code>sed</code> instruction is <code>s/FIND/REPLACE/</code>, which is used to replace a match to the regular expression <code>FIND</code> with text indicated by <code>REPLACE</code>. For example, the instruction <code>s/hda/sda/</code> replaces a substring matching the literal RE <code>hda</code> with <code>sda</code>. Only the first match found in the line will be replaced, unless the flag <code>g</code> is placed after the instruction, as in <code>s/hda/sda/g</code>.</p>
</div>
<div class="paragraph">
<p>A more realistic case study will help to illustrate <code>sed</code>'s features. Suppose a medical clinic wants to send text messages to its customers, reminding them of their scheduled appointments for the next day. A typical implementation scenario relies on a professional instant message service, which provides an API to access the system responsible for delivering the messages. These messages usually originate from the same system that runs the application controlling customer&#8217;s appointments, triggered by a specific time of the day or some other event. In this hypothetical situation, the application could generate a file called <code>appointments.csv</code> containing tabulated data with all the appointments for the next day, then used by <code>sed</code> to render the text messages from a template file called <code>template.txt</code>. CSV files are a standard way of export data from database queries, so sample appointments could be given as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>cat appointments.csv</strong>
"NAME","TIME","PHONE"
"Carol","11am","55557777"
"Dave","2pm","33334444"</pre>
</div>
</div>
<div class="paragraph">
<p>The first line holds the labels for each column, which will be used to match the tags inside the sample template file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>cat template.txt</strong>
Hey &lt;NAME&gt;, don't forget your appointment tomorrow at &lt;TIME&gt;.</pre>
</div>
</div>
<div class="paragraph">
<p>The less than <code>&lt;</code> and greater than <code>&gt;</code> signs were put around labels just to help identify them as tags. The following Bash script parses all enqueued appointments using <code>template.txt</code> as the message template:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>#! /bin/bash

TEMPLATE=`cat template.txt`
TAGS=(`sed -ne '1s/^"//;1s/","/\n/g;1s/"$//p' appointments.csv`)
mapfile -t -s 1 ROWS &lt; appointments.csv
for (( r = 0; r &lt; ${#ROWS[*]}; r++ ))
do
  MSG=$TEMPLATE
  VALS=(`sed -e 's/^"//;s/","/\n/g;s/"$//' &lt;&lt;&lt;${ROWS[$r]}`)
  for (( c = 0; c &lt; ${#TAGS[*]}; c++ ))
  do
    MSG=`sed -e "s/&lt;${TAGS[$c]}&gt;/${VALS[$c]}/g" &lt;&lt;&lt;"$MSG"`
  done
  echo curl --data message=\"$MSG\" --data phone=\"${VALS[2]}\" https://mysmsprovider/api
done</pre>
</div>
</div>
<div class="paragraph">
<p>An actual production script would also handle authentication, error checking and logging, but the example has basic functionality to start with. The first instructions executed by <code>sed</code> are applied only to the first line&#8201;&#8212;&#8201;the address <code>1</code> in <code>1s/^"//;1s/","/\n/g;1s/"$//p</code>&#8201;&#8212;&#8201;to remove the leading and trailing quotes&#8201;&#8212;&#8201;<code>1s/^"//</code> and <code>1s/"$//</code>&#8201;&#8212;&#8201;and to replace field separators with a newline character: <code>1s/","/\n/g</code>. Only the first line is needed for loading column names, so non-matching lines will be suppressed by option <code>-n</code>, requiring flag <code>p</code> to be placed after the last <code>sed</code> command to print the matching line. The tags are then stored in the <code>TAGS</code> variable as a Bash array. Another Bash array variable is created by the command <code>mapfile</code> to store the lines containing the appointments in the array variable <code>ROWS</code>.</p>
</div>
<div class="paragraph">
<p>A <code>for</code> loop is employed to process each appointment line found in <code>ROWS</code>. Then, quotes and separators in the appointment&#8201;&#8212;&#8201;the appointment is in variable <code>${ROWS[$r]}</code> used as a <em>here string</em>&#8201;&#8212;&#8201;are replaced by <code>sed</code>, similarly to the commands used to load the tags. The separated values for the appointment are then stored in the array variable <code>VALS</code>, where array subscripts 0, 1 and 2 correspond to values for <code>NAME</code>, <code>TIME</code> and <code>PHONE</code>.</p>
</div>
<div class="paragraph">
<p>Finally, a nested <code>for</code> loop walks through the <code>TAGS</code> array and replaces each tag found in the template with its corresponding value in <code>VALS</code>. The <code>MSG</code> variable holds a copy of the rendered template, updated by the substitution command <code>s/&lt;${TAGS[$c]}&gt;/${VALS[$c]}/g</code> on every loop pass through <code>TAGS</code>.</p>
</div>
<div class="paragraph">
<p>This results in a rendered message like: <code>"Hey Carol, don&#8217;t forget your appointment tomorrow at 11am."</code> The rendered message can then be sent as a parameter through a HTTP request with <code>curl</code>, as a mail message or any other similar method.</p>
</div>
</div>
<div class="sect2">
<h3 id="_combining_grep_and_sed">Combining grep and sed</h3>
<div class="paragraph">
<p>Commands <code>grep</code> and <code>sed</code> can be used together when more complex text mining procedures are required. As a system administrator, you may want to inspect all the login attempts to a server, for example. The file <code>/var/log/wtmp</code> records all logins and logouts, whilst the file <code>/var/log/btmp</code> records the failed login attempts. They are written in a binary format, which can be read by the commands <code>last</code> and <code>lastb</code>, respectively.</p>
</div>
<div class="paragraph">
<p>The output of <code>lastb</code> shows not only the username used in the bad login attempt, but its IP address as well:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># <strong>lastb -d -a -n 10 --time-format notime</strong>
user     ssh:notty       (00:00)     81.161.63.251
nrostagn ssh:notty       (00:00)     vmd60532.contaboserver.net
pi       ssh:notty       (00:00)     132.red-88-20-39.staticip.rima-tde.net
pi       ssh:notty       (00:00)     132.red-88-20-39.staticip.rima-tde.net
pi       ssh:notty       (00:00)     46.6.11.56
pi       ssh:notty       (00:00)     46.6.11.56
nps      ssh:notty       (00:00)     vmd60532.contaboserver.net
narmadan ssh:notty       (00:00)     vmd60532.contaboserver.net
nominati ssh:notty       (00:00)     vmd60532.contaboserver.net
nominati ssh:notty       (00:00)     vmd60532.contaboserver.net</pre>
</div>
</div>
<div class="paragraph">
<p>Option <code>-d</code> translates the IP number to the corresponding hostname. The hostname may provide clues about the ISP or hosting service used to perform these bad login attempts. Option <code>-a</code> puts the hostname in the last column, which facilitates the filtering yet to be applied. Option <code>--time-format notime</code> suppresses the time when the login attempt occurred. Command <code>lastb</code> can take some time to finish if there were too many bad login attempts, so the output was limited to ten entries with the option <code>-n 10</code>.</p>
</div>
<div class="paragraph">
<p>Not all remote IPs have a hostname associated to it, so reverse DNS does not apply to them and they can be dismissed. Although you could write a regular expression to match the expected format for a hostname at the end of the line, it is probably simpler to write a regular expression to match with either a letter from the alphabet or with a single digit at the end of the line. The following example shows how the command <code>grep</code> takes the listing at its standard input and removes the lines without hostnames:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># <strong>lastb -d -a --time-format notime | grep -v '[0-9]$' | head -n 10</strong>
nvidia   ssh:notty       (00:00)     vmd60532.contaboserver.net
n_tonson ssh:notty       (00:00)     vmd60532.contaboserver.net
nrostagn ssh:notty       (00:00)     vmd60532.contaboserver.net
pi       ssh:notty       (00:00)     132.red-88-20-39.staticip.rima-tde.net
pi       ssh:notty       (00:00)     132.red-88-20-39.staticip.rima-tde.net
nps      ssh:notty       (00:00)     vmd60532.contaboserver.net
narmadan ssh:notty       (00:00)     vmd60532.contaboserver.net
nominati ssh:notty       (00:00)     vmd60532.contaboserver.net
nominati ssh:notty       (00:00)     vmd60532.contaboserver.net
nominati ssh:notty       (00:00)     vmd60532.contaboserver.net</pre>
</div>
</div>
<div class="paragraph">
<p>Command <code>grep</code> option <code>-v</code> shows only the lines that don&#8217;t match with the given regular expression. A regular expression matching any line ending with a number (i.e. <code>[0-9]$</code>) will capture only the entries without a hostname. Therefore, <code>grep -v '[0-9]$'</code> will show only the lines ending with a hostname.</p>
</div>
<div class="paragraph">
<p>The output can be filtered even further, by keeping only the domain name and removing the other parts from each line. Command <code>sed</code> can do it with a substitution command to replace the whole line with a back-reference to the domain name in it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># <strong>lastb -d -a --time-format notime | grep -v '[0-9]$' | sed -e 's/.* \(.*\)$/\1/' | head -n 10</strong>
vmd60532.contaboserver.net
vmd60532.contaboserver.net
vmd60532.contaboserver.net
132.red-88-20-39.staticip.rima-tde.net
132.red-88-20-39.staticip.rima-tde.net
vmd60532.contaboserver.net
vmd60532.contaboserver.net
vmd60532.contaboserver.net
vmd60532.contaboserver.net
vmd60532.contaboserver.net</pre>
</div>
</div>
<div class="paragraph">
<p>The escaped parenthesis in <code>.* \(.*\)$</code> tells <code>sed</code> to remember that part of the line, that is, the part between the last space character and the end of the line. In the example, this part is referenced with <code>\1</code> and used the replace the entire line.</p>
</div>
<div class="paragraph">
<p>It&#8217;s clear that most remote hosts try to login more than once, thus the same domain name repeats itself. To suppress the repeated entries, first they need to be sorted (with command <code>sort</code>) then passed to the command <code>uniq</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># <strong>lastb -d -a --time-format notime | grep -v '[0-9]$' | sed -e 's/.* \(.*\)$/\1/' | sort | uniq | head -n 10</strong>
116-25-254-113-on-nets.com
132.red-88-20-39.staticip.rima-tde.net
145-40-33-205.power-speed.at
tor.laquadrature.net
tor.momx.site
ua-83-226-233-154.bbcust.telenor.se
vmd38161.contaboserver.net
vmd60532.contaboserver.net
vmi488063.contaboserver.net
vmi515749.contaboserver.net</pre>
</div>
</div>
<div class="paragraph">
<p>This shows how different commands can be combined to produce the desired outcome. The hostname list can then be used to write blocking firewall rules or to take other measures to enforce the security of the server.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec.103.7_02-GE">Guided Exercises</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Command <code>last</code> shows a listing of last logged in users, including their origin IPs. How would the <code>egrep</code> command be used to filter <code>last</code> output, showing only occurrences of an IPv4 address, discarding any additional information in the corresponding line?</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>What option should be given to <code>grep</code> in order to correctly filter the output generated by command <code>find</code> executed with option <code>-print0</code>?</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Command <code>uptime -s</code> shows the last date when the system was powered on, as in <code>2019-08-05 20:13:22</code>. What will be the result of command <code>uptime -s | sed -e 's/(.*) (.*)/\1/'</code>?</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>What option should be given to <code>grep</code> so it counts matching lines instead of displaying them?</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec.103.7_02-EE">Explorational Exercises</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The basic structure of an HTML file starts with elements <code>html</code>, <code>head</code> and <code>body</code>, for example:</p>
<div class="listingblock">
<div class="content">
<pre>&lt;html&gt;
&lt;head&gt;
  &lt;title&gt;News Site&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;h1&gt;Headline&lt;/h1&gt;
  &lt;p&gt;Information of interest.&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Describe how addresses could be used in <code>sed</code> to display only the <code>body</code> element and its contents.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>What <code>sed</code> expression will remove all tags from an HTML document, keeping only the rendered text?</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Files with extension <code>.ovpn</code> are very popular to configure VPN clients as they contain not only the settings, but also the contents of keys and certificates for the client. These keys and certificates are originally in separate files, so they need to be copied into the <code>.ovpn</code> file. Given the following excerpt of a <code>.ovpn</code> template:</p>
<div class="listingblock">
<div class="content">
<pre>client
dev tun
remote 192.168.1.155 1194
&lt;ca&gt;
ca.crt
&lt;/ca&gt;
&lt;cert&gt;
client.crt
&lt;/cert&gt;
&lt;key&gt;
client.key
&lt;/key&gt;
&lt;tls-auth&gt;
ta.key
&lt;/tls-auth&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Assuming files <code>ca.crt</code>, <code>client.srt</code>, <code>client.key</code> and <code>ta.key</code> are in the current directory, how would the template configuration be modified by <code>sed</code> to replace each filename by its content?</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec.103.7_02-SU">Summary</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This lesson covers the two most important Linux commands related to regular expressions: <code>grep</code> and <code>sed</code>. Scripts and compound commands rely on <code>grep</code> and <code>sed</code> to perform a wide range of text filtering and parsing tasks. The lesson goes through the following steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>How to use <code>grep</code> and its variations such as <code>egrep</code> and <code>fgrep</code>.</p>
</li>
<li>
<p>How to use <code>sed</code> and its internal instructions to manipulate text.</p>
</li>
<li>
<p>Examples of regular expression applications using <code>grep</code> and <code>sed</code>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec.103.7_02-AGE">Answers to Guided Exercises</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Command <code>last</code> shows a listing of last logged in users, including their origin IPs. How would the <code>egrep</code> command be used to filter <code>last</code> output, showing only occurrences of an IPv4 address, discarding any additional information in the corresponding line?</p>
<div class="paragraph">
<p><code>last -i | egrep -o '[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}'</code></p>
</div>
</li>
<li>
<p>What option should be given to <code>grep</code> in order to correctly filter the output generated by command <code>find</code> executed with option <code>-print0</code>?</p>
<div class="paragraph">
<p>The option <code>-z</code> or <code>--null-data</code>, as in <code>find . -print0 | grep -z expression</code>.</p>
</div>
</li>
<li>
<p>Command <code>uptime -s</code> shows the last date when the system was powered on, as in <em>2019-08-05 20:13:22</em>. What will be the result of command <code>uptime -s | sed -e 's/(.*) (.*)/\1/'</code>?</p>
<div class="paragraph">
<p>An error will occur. By default, parenthesis should be escaped to use backreferences in <code>sed</code>.</p>
</div>
</li>
<li>
<p>What option should be given to <code>grep</code> so it counts matching lines instead of displaying them?</p>
<div class="paragraph">
<p>Option <code>-c</code>.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec.103.7_02-AEE">Answers to Explorational Exercises</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The basic structure of an HTML file starts with elements <code>html</code>, <code>head</code> and <code>body</code>, for example:</p>
<div class="listingblock">
<div class="content">
<pre>&lt;html&gt;
&lt;head&gt;
  &lt;title&gt;News Site&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;h1&gt;Headline&lt;/h1&gt;
  &lt;p&gt;Information of interest.&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Describe how addresses could be used in <code>sed</code> to display only the <code>body</code> element and its contents.</p>
</div>
<div class="paragraph">
<p>To only show <code>body</code>, the addresses should be <code>/&lt;body&gt;/,/&lt;\/body&gt;/</code>, as in <code>sed -n -e '/&lt;body&gt;/,/&lt;\/body&gt;/p'</code>. Option <code>-n</code> is given to <code>sed</code> so it doesn&#8217;t print lines by default, hence the command <code>p</code> at the end of <code>sed</code> expression to print matching lines.</p>
</div>
</li>
<li>
<p>What <code>sed</code> expression will remove all tags from an HTML document, keeping only the rendered text?</p>
<div class="paragraph">
<p>The <code>sed</code> expression <code>s/&lt;[^&gt;]*&gt;//g</code> will replace any content enclosed in <code>&lt;&gt;</code> by an empty string.</p>
</div>
</li>
<li>
<p>Files with extension <code>.ovpn</code> are very popular to configure VPN clients as they contain not only the settings, but also the contents of keys and certificates for the client. These keys and certificates are originally in separate files, so they need to be copied into the <code>.ovpn</code> file. Given the following excerpt of a <code>.ovpn</code> template:</p>
<div class="listingblock">
<div class="content">
<pre>client
dev tun
remote 192.168.1.155 1194
&lt;ca&gt;
ca.crt
&lt;/ca&gt;
&lt;cert&gt;
client.crt
&lt;/cert&gt;
&lt;key&gt;
client.key
&lt;/key&gt;
&lt;tls-auth&gt;
ta.key
&lt;/tls-auth&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Assuming files <code>ca.crt</code>, <code>client.srt</code>, <code>client.key</code> and <code>ta.key</code> are in the current directory, how would the template configuration be modified by <code>sed</code> to replace each filename by its content?</p>
</div>
<div class="paragraph">
<p>The command</p>
</div>
<div class="listingblock">
<div class="content">
<pre>sed -r -e 's/(^[^.]*)\.(crt|key)$/cat \1.\2/e' &lt; client.template &gt; client.ovpn</pre>
</div>
</div>
<div class="paragraph">
<p>replaces any line terminating in <code>.crt</code> or <code>.key</code> with the content of a file whose name equals the line. Option <code>-r</code> tells <code>sed</code> to use extended regular expressions, whilst <code>e</code> at the end of the expression tells <code>sed</code> to replace matches with the output of command <code>cat \1.\2</code>. The backreferences <code>\1</code> and <code>\2</code> correspond to the filename and extension found in the match.</p>
</div>
</li>
</ol>
</div>
</div>
</div>

        
      </section>
    </div>

    <aside class="lesson__license smallprint">
  <div class="container">
    
    <p>© 2020 Linux Professional Insitute Inc. All rights reserved. Visit the Learning Materials website: https://learning.lpi.org<br />
       This work is licensed under the Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License.</p>
  </div>
</aside>


    
    
    <aside class="lesson__teaser teaser">
      <div class="container teaser__container">
        <h2 class="label">Next Lesson</h2>
        <p class="headline teaser__headline">103.8 Basic file editing (103.8 Lesson 1)</p>

        <div class="button-group">
            <a href="../../103.8/103.8_01/index.html" class="button -primary">Read next lesson</a>
        </div>
      </div>
    </aside>
    
  </div>
</div>

<div class="lesson-progress">
  <div class="lesson-progress__current"></div>
</div>

      </main>
    </td></tr></tbody>
    <tfoot><tr><td class="print__cell">
      <div class="print__space -footer"></div>
    </td></tr></tfoot>
  </table>

  <table class="print-footer">
  <tr class="print-footer__body">
    <td class="print-footer__cell -image">
      <img src="index.html" alt="" class="print-footer__image">
    </td>
    <td class="print-footer__cell -center">
      <p>© 2020 Linux Professional Insitute Inc. All rights reserved. Visit the Learning Materials website: https://learning.lpi.org<br />
         This work is licensed under the Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License.</p>
    </td>
    <td class="print-footer__cell -image">
      <img src="index.html" alt="" class="print-footer__license">
    </td>
  </tr>
</table>

<footer class="footer">
  <div class="container footer__container columns">
    <div class="column">
      <h2>LPI is a non-profit organization.</h2>
      <p>Linux Professional Institute (LPI) is the global certification standard and career support organization for open source professionals. With more than 200,000 certification holders, it&#39;s the world’s first and largest vendor-neutral Linux and open source certification body. LPI has certified professionals in over 180 countries, delivers exams in multiple languages, and has hundreds of training partners.</p>
      <p>Our purpose is to enable economic and creative opportunities for everybody by making open source knowledge and skills certification universally accessible.</p>
    </div>

    <div class="column">
      <ul class="footer__social social">
        <li class="social__item -linkedin">
          <a class="social__link" href="https://www.linkedin.com/company/35136" target="_blank" rel="noreferrer">
            <svg version="1.1"  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 viewBox="0 0 42.3 36" enable-background="new 0 0 42.3 36" xml:space="preserve">
<g>
	<g>
		<g>
			<path fill="#010202" d="M33.3,0H2.7C1.2,0,0,1.2,0,2.6v30.8C0,34.8,1.2,36,2.7,36h30.7c1.5,0,2.7-1.2,2.7-2.6V2.6
				C36,1.2,34.8,0,33.3,0z M10.7,30.7H5.3V13.5h5.3V30.7z M8,11.1c-1.7,0-3.1-1.4-3.1-3.1C4.9,6.3,6.3,5,8,5c1.7,0,3.1,1.4,3.1,3.1
				C11.1,9.8,9.7,11.1,8,11.1z M30.7,30.7h-5.3v-8.4c0-2,0-4.6-2.8-4.6c-2.8,0-3.2,2.2-3.2,4.4v8.5H14V13.5h5.1v2.3h0.1
				c0.7-1.4,2.5-2.8,5.1-2.8c5.4,0,6.4,3.6,6.4,8.2V30.7z"/>
		</g>
	</g>
	<g>
		<polygon fill="#010202" points="37.5,28.5 38.2,28.5 38.2,30.7 38.6,30.7 38.6,28.5 39.3,28.5 39.3,28.1 37.5,28.1 		"/>
		<polygon fill="#010202" points="41.7,28.1 41,30 40.3,28.1 39.7,28.1 39.7,30.7 40.1,30.7 40.1,28.8 40.9,30.7 41.1,30.7
			41.9,28.8 41.9,30.7 42.3,30.7 42.3,28.1 		"/>
	</g>
</g>
</svg>

            <span class="social__link__text">LinkedIn</span>
          </a>
        </li>
        <li class="social__item -facebook">
          <a class="social__link" href="https://www.facebook.com/LPIConnect" target="_blank" rel="noreferrer">
            <svg version="1.1"  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 viewBox="0 0 36 36" enable-background="new 0 0 36 36" xml:space="preserve">
<title>flogo-RGB-HEX-Blk-58</title>
<path d="M34,0H2C0.9,0,0,0.9,0,2v32c0,1.1,0.9,2,2,2h17.3V22.1h-4.7v-5.4h4.7v-4c0-4.6,2.8-7.2,7-7.2c0,0,0,0,0,0c0,0,0,0,0,0
	c0.4,0,0.9,0,1.3,0c0.3,0,0.5,0,0.8,0c0.7,0,1.4,0.1,2.1,0.2v4.9v0h-2.9c-0.3,0-0.5,0-0.8,0c-1.6,0.2-1.9,1.2-1.9,2.6v3.5h5.4
	l-0.7,5.4h0l0,0h-4.7V36H34c1.1,0,2-0.9,2-2V2C36,0.9,35.1,0,34,0z"/>
</svg>

            <span class="social__link__text">Facebook</span>
          </a>
        </li>
        <li class="social__item -twitter">
          <a class="social__link" href="https://twitter.com/lpiconnect" target="_blank" rel="noreferrer">
            <svg version="1.1" id="Logo_FIXED" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 viewBox="0 0 36 36" enable-background="new 0 0 36 36" xml:space="preserve">
<path d="M11.3,32.6c13.6,0,21-11.3,21-21c0-0.3,0-0.6,0-1c1.4-1,2.7-2.3,3.7-3.8c-1.3,0.6-2.8,1-4.2,1.2c1.5-0.9,2.7-2.4,3.2-4.1
	c-1.4,0.9-3,1.5-4.7,1.8c-2.8-3-7.5-3.1-10.5-0.3c-1.9,1.8-2.7,4.5-2.1,7.1C11.8,12.1,6.3,9.3,2.5,4.7c-2,3.4-1,7.7,2.3,9.9
	c-1.2,0-2.3-0.4-3.4-0.9c0,0,0,0.1,0,0.1c0,3.5,2.5,6.5,5.9,7.2c-1.1,0.3-2.2,0.3-3.3,0.1c1,3,3.7,5.1,6.9,5.1
	c-2.6,2.1-5.8,3.2-9.2,3.2c-0.6,0-1.2,0-1.8-0.1C3.4,31.5,7.3,32.6,11.3,32.6"/>
</svg>

            <span class="social__link__text">Twitter</span>
          </a>
        </li>
      </ul>
    </div>
  </div>

  <div class="container footer__secondary">
    <ul class="footer__links">
      <li><a href="https://www.lpi.org/about-lpi/contact-us" class="footer__link" target="_blank" rel="noreferrer">Contact Us</a></li>
      <li><a href="https://www.lpi.org/privacy-and-cookie-policy" class="footer__link" target="_blank" rel="noreferrer">Privacy and Cookie Policy</a></li>
    </ul>

    <p><strong>Spot a mistake or want to help improve this page? Please <a href="https://www.lpi.org/about-lpi/contact-us" target="_blank" rel="noreferrer">let us know</a>.</strong></p>
    <p>© Copyright 1999-2020 The Linux Professional Institute Inc. All rights reserved.</p>
  </div>
</footer>


  
  
  

  <script src="https://unpkg.com/swiper/swiper-bundle.min.js" type="application/javascript"></script>
  <script src="../../../../../../js/bundle.js"></script>
</body>
</html>
